{"version":3,"file":"DashboardListPage.bcd8038d2439cf0b8d0d.js","mappings":"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","sources":["webpack://grafana/./public/app/features/search/components/DashboardActions.tsx","webpack://grafana/./public/app/features/search/components/ManageDashboardsNew.tsx","webpack://grafana/./public/app/features/search/components/DashboardListPage.tsx","webpack://grafana/./public/app/features/search/loaders.ts"],"sourcesContent":["import React, { FC } from 'react';\n\nimport { Menu, Dropdown, Button, Icon } from '@grafana/ui';\n\nexport interface Props {\n  folderId?: number;\n  canCreateFolders?: boolean;\n  canCreateDashboards?: boolean;\n}\n\nexport const DashboardActions: FC<Props> = ({ folderId, canCreateFolders = false, canCreateDashboards = false }) => {\n  const actionUrl = (type: string) => {\n    let url = `dashboard/${type}`;\n\n    if (folderId) {\n      url += `?folderId=${folderId}`;\n    }\n\n    return url;\n  };\n\n  const MenuActions = () => {\n    return (\n      <Menu>\n        {canCreateDashboards && <Menu.Item url={actionUrl('new')} label=\"New Dashboard\" />}\n        {!folderId && canCreateFolders && <Menu.Item url=\"dashboards/folder/new\" label=\"New Folder\" />}\n        {canCreateDashboards && <Menu.Item url={actionUrl('import')} label=\"Import\" />}\n      </Menu>\n    );\n  };\n\n  return (\n    <div>\n      <Dropdown overlay={MenuActions} placement=\"bottom-start\">\n        <Button variant=\"primary\">\n          New\n          <Icon name=\"angle-down\" />\n        </Button>\n      </Dropdown>\n    </div>\n  );\n};\n","import { css, cx } from '@emotion/css';\nimport React from 'react';\nimport { useLocalStorage } from 'react-use';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { Input, useStyles2, Spinner } from '@grafana/ui';\nimport { contextSrv } from 'app/core/services/context_srv';\nimport { FolderDTO, AccessControlAction } from 'app/types';\n\nimport { SEARCH_PANELS_LOCAL_STORAGE_KEY } from '../constants';\nimport { useKeyNavigationListener } from '../hooks/useSearchKeyboardSelection';\nimport { useSearchQuery } from '../hooks/useSearchQuery';\nimport { SearchView } from '../page/components/SearchView';\n\nimport { DashboardActions } from './DashboardActions';\n\nexport interface Props {\n  folder?: FolderDTO;\n}\n\nexport const ManageDashboardsNew = React.memo(({ folder }: Props) => {\n  const styles = useStyles2(getStyles);\n  // since we don't use \"query\" from use search... it is not actually loaded from the URL!\n  const { query, onQueryChange } = useSearchQuery({});\n  const { onKeyDown, keyboardEvents } = useKeyNavigationListener();\n\n  // TODO: we need to refactor DashboardActions to use folder.uid instead\n  const folderId = folder?.id;\n  // const folderUid = folder?.uid;\n  const canSave = folder?.canSave;\n  const { isEditor } = contextSrv;\n  const hasEditPermissionInFolders = folder ? canSave : contextSrv.hasEditPermissionInFolders;\n  const canCreateFolders = contextSrv.hasAccess(AccessControlAction.FoldersCreate, isEditor);\n  const canCreateDashboardsFallback = hasEditPermissionInFolders || !!canSave;\n  const canCreateDashboards = folder?.id\n    ? contextSrv.hasAccessInMetadata(AccessControlAction.DashboardsCreate, folder, canCreateDashboardsFallback)\n    : contextSrv.hasAccess(AccessControlAction.DashboardsCreate, canCreateDashboardsFallback);\n  const viewActions = (folder === undefined && canCreateFolders) || canCreateDashboards;\n\n  let [includePanels, setIncludePanels] = useLocalStorage<boolean>(SEARCH_PANELS_LOCAL_STORAGE_KEY, true);\n  if (!config.featureToggles.panelTitleSearch) {\n    includePanels = false;\n  }\n\n  const onSearchQueryChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    onQueryChange(e.currentTarget.value);\n  };\n\n  return (\n    <>\n      <div className={cx(styles.actionBar, 'page-action-bar')}>\n        <div className={cx(styles.inputWrapper, 'gf-form gf-form--grow m-r-2')}>\n          <Input\n            value={query.query ?? ''}\n            onChange={onSearchQueryChange}\n            onKeyDown={onKeyDown}\n            autoFocus\n            spellCheck={false}\n            placeholder={includePanels ? 'Search for dashboards and panels' : 'Search for dashboards'}\n            className={styles.searchInput}\n            suffix={false ? <Spinner /> : null}\n          />\n        </div>\n        {viewActions && (\n          <DashboardActions\n            folderId={folderId}\n            canCreateFolders={canCreateFolders}\n            canCreateDashboards={canCreateDashboards}\n          />\n        )}\n      </div>\n\n      <SearchView\n        showManage={isEditor || hasEditPermissionInFolders || canSave}\n        folderDTO={folder}\n        hidePseudoFolders={true}\n        includePanels={includePanels!}\n        setIncludePanels={setIncludePanels}\n        keyboardEvents={keyboardEvents}\n      />\n    </>\n  );\n});\n\nManageDashboardsNew.displayName = 'ManageDashboardsNew';\n\nexport default ManageDashboardsNew;\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  actionBar: css`\n    ${theme.breakpoints.down('sm')} {\n      flex-wrap: wrap;\n    }\n  `,\n  inputWrapper: css`\n    ${theme.breakpoints.down('sm')} {\n      margin-right: 0 !important;\n    }\n  `,\n  searchInput: css`\n    margin-bottom: 6px;\n    min-height: ${theme.spacing(4)};\n  `,\n  unsupported: css`\n    padding: 10px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n    font-size: 18px;\n  `,\n  noResults: css`\n    padding: ${theme.v1.spacing.md};\n    background: ${theme.v1.colors.bg2};\n    font-style: italic;\n    margin-top: ${theme.v1.spacing.md};\n  `,\n});\n","import { css } from '@emotion/css';\nimport React, { FC, memo } from 'react';\nimport { useAsync } from 'react-use';\n\nimport { locationUtil, NavModelItem } from '@grafana/data';\nimport { locationService } from '@grafana/runtime';\nimport { Page } from 'app/core/components/Page/Page';\nimport { FolderDTO } from 'app/types';\n\nimport { GrafanaRouteComponentProps } from '../../../core/navigation/types';\nimport { loadFolderPage } from '../loaders';\n\nimport ManageDashboardsNew from './ManageDashboardsNew';\n\nexport interface DashboardListPageRouteParams {\n  uid?: string;\n  slug?: string;\n}\n\ninterface Props extends GrafanaRouteComponentProps<DashboardListPageRouteParams> {}\n\nexport const DashboardListPage: FC<Props> = memo(({ match, location }) => {\n  const { loading, value } = useAsync<() => Promise<{ folder?: FolderDTO; pageNav?: NavModelItem }>>(() => {\n    const uid = match.params.uid;\n    const url = location.pathname;\n    if (!uid || !url.startsWith('/dashboards')) {\n      return Promise.resolve({});\n    }\n\n    return loadFolderPage(uid!).then(({ folder, folderNav }) => {\n      const path = locationUtil.stripBaseFromUrl(folder.url);\n\n      if (path !== location.pathname) {\n        locationService.replace(path);\n      }\n\n      return { folder, pageNav: folderNav };\n    });\n  }, [match.params.uid]);\n\n  return (\n    <Page navId=\"dashboards/browse\" pageNav={value?.pageNav}>\n      <Page.Contents\n        isLoading={loading}\n        className={css`\n          display: flex;\n          flex-direction: column;\n          overflow: hidden;\n        `}\n      >\n        <ManageDashboardsNew folder={value?.folder} />\n      </Page.Contents>\n    </Page>\n  );\n});\n\nDashboardListPage.displayName = 'DashboardListPage';\n\nexport default DashboardListPage;\n","import { backendSrv } from 'app/core/services/backend_srv';\n\nimport { buildNavModel } from '../folders/state/navModel';\n\nexport const loadFolderPage = (uid: string) => {\n  return backendSrv.getFolderByUid(uid, { withAccessControl: true }).then((folder) => {\n    const navModel = buildNavModel(folder);\n    navModel.children![0].active = true;\n\n    return { folder, folderNav: navModel };\n  });\n};\n"],"names":["DashboardActions","folderId","canCreateFolders","canCreateDashboards","actionUrl","type","url","Dropdown","overlay","Menu","label","placement","Button","variant","Icon","name","ManageDashboardsNew","React","folder","styles","useStyles2","getStyles","query","onQueryChange","useSearchQuery","onKeyDown","keyboardEvents","useKeyNavigationListener","id","canSave","isEditor","contextSrv","hasEditPermissionInFolders","AccessControlAction","canCreateDashboardsFallback","viewActions","undefined","includePanels","setIncludePanels","useLocalStorage","SEARCH_PANELS_LOCAL_STORAGE_KEY","config","className","cx","actionBar","inputWrapper","Input","I","value","onChange","e","currentTarget","autoFocus","spellCheck","placeholder","searchInput","suffix","SearchView","showManage","folderDTO","hidePseudoFolders","displayName","theme","css","breakpoints","down","spacing","unsupported","noResults","v1","md","colors","bg2","DashboardListPage","memo","match","location","loading","useAsync","uid","params","pathname","startsWith","backendSrv","withAccessControl","then","navModel","buildNavModel","children","active","folderNav","loadFolderPage","path","locationUtil","locationService","pageNav","Promise","resolve","Page","navId","isLoading"],"sourceRoot":""}