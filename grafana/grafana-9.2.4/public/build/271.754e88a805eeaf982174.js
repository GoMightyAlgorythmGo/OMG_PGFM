"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[271],{63773:(t,e,a)=>{a.d(e,{O:()=>o});var i=a(49198),s=a(87982),n=a(98712);const r={http:80,https:443,ftp:21};class o{constructor(){this.absUrl=this.wrapInDeprecationWarning(this.absUrl),this.hash=this.wrapInDeprecationWarning(this.hash),this.host=this.wrapInDeprecationWarning(this.host),this.path=this.wrapInDeprecationWarning(this.path),this.port=this.wrapInDeprecationWarning(this.port,"window.location"),this.protocol=this.wrapInDeprecationWarning(this.protocol,"window.location"),this.replace=this.wrapInDeprecationWarning(this.replace),this.search=this.wrapInDeprecationWarning(this.search),this.state=this.wrapInDeprecationWarning(this.state),this.url=this.wrapInDeprecationWarning(this.url)}wrapInDeprecationWarning(t,e){let a=this;return function(){return(0,i.d)("$location",t.name,e||"locationService"),t.apply(a,arguments)}}absUrl(){return`${window.location.origin}${this.url()}`}hash(t){if((0,n.GQ)("AngularLocationWrapper",!1,"Angular compat layer: hash"),t)throw new Error("AngularLocationWrapper method not implemented.");return n.E1.getLocation().hash.slice(1)}host(){return new URL(window.location.href).hostname}path(t){(0,n.GQ)("AngularLocationWrapper",!1,"Angular compat layer: path");const e=n.E1.getLocation();if(null!=t){let a=String(t);a=a.startsWith("/")?a:`/${a}`;const i=new URL(`${window.location.origin}${a}`);return n.E1.push({pathname:i.pathname,search:i.search.length>0?i.search:e.search,hash:i.hash.length>0?i.hash:e.hash}),this}return null===t?(n.E1.push("/"),this):e.pathname}port(){const t=new URL(window.location.href);return parseInt(t.port,10)||r[t.protocol]||null}protocol(){return new URL(window.location.href).protocol.slice(0,-1)}replace(){throw new Error("AngularLocationWrapper method not implemented.")}search(t,e){if((0,n.GQ)("AngularLocationWrapper",!1,"Angular compat layer: search"),!t)return n.E1.getSearchObject();if(t&&arguments.length>1)return n.E1.partial({[t]:e}),this;if(t){let e;e="object"==typeof t?Object.assign({},t):(0,n.Ox)(t);for(const t of Object.keys(e))null!==e[t]&&void 0!==e[t]||delete e[t];const a=s.Cj.renderUrl(n.E1.getLocation().pathname,e);n.E1.push(a)}return this}state(t){throw(0,n.GQ)("AngularLocationWrapper",!1,"Angular compat layer: state"),new Error("AngularLocationWrapper method not implemented.")}url(t){if((0,n.GQ)("AngularLocationWrapper",!1,"Angular compat layer: url"),void 0!==t)return t.startsWith("#")?n.E1.push(Object.assign({},n.E1.getLocation(),{hash:t})):t.startsWith("?")?n.E1.push(Object.assign({},n.E1.getLocation(),{search:t})):0===t.trim().length?n.E1.push("/"):n.E1.push(t),n.E1;const e=n.E1.getLocation();return`${e.pathname}${e.search}${e.hash}`}}},20469:(t,e,a)=>{a.d(e,{ZP:()=>o,hF:()=>n,rb:()=>r});var i=a(93964),s=a.n(i);const n=s().module("grafana.core",["ngRoute"]),r=[n,s().module("grafana.controllers",[]),s().module("grafana.directives",[]),s().module("grafana.factories",[]),s().module("grafana.services",[]),s().module("grafana.filters",[]),s().module("grafana.routes",[])],o=n},15866:(t,e,a)=>{a.d(e,{k:()=>p});var i=a(82897),s=a(5937),n=a(81351),r=a(19383),o=a(91082),h=a(60301);function l(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}class p extends o.q{constructor(t,e){super(t,e),l(this,"contextSrv",void 0),l(this,"datasourceSrv",void 0),l(this,"timeSrv",void 0),l(this,"templateSrv",void 0),l(this,"interval",void 0),l(this,"intervalMs",void 0),l(this,"resolution",void 0),l(this,"timeInfo",void 0),l(this,"skipDataOnInit",!1),l(this,"dataList",[]),l(this,"querySubscription",void 0),l(this,"useDataFrames",!1),l(this,"panelData",void 0),l(this,"panelDataObserver",{next:t=>{if(this.panelData=t,t.state===s.Gu.Error&&(this.loading=!1,this.processDataError(t.error)),t.state===s.Gu.Loading)return this.loading=!0,void this.angularDirtyCheck();if(t.request){const{timeInfo:e}=t.request;e&&(this.timeInfo=e)}if(t.timeRange&&(this.range=t.timeRange),this.useDataFrames)this.handleDataFrames(t.series);else{const e=t.series.map((t=>(0,n.Zr)(t)));this.handleQueryResult({data:e})}this.angularDirtyCheck()}}),this.contextSrv=e.get("contextSrv"),this.datasourceSrv=e.get("datasourceSrv"),this.timeSrv=e.get("timeSrv"),this.templateSrv=e.get("templateSrv"),this.panel.datasource=this.panel.datasource||null,this.events.on(r.Kh.refresh,this.onMetricsPanelRefresh.bind(this)),this.events.on(r.Kh.panelTeardown,this.onPanelTearDown.bind(this)),this.events.on(r.Kh.componentDidMount,this.onMetricsPanelMounted.bind(this))}onMetricsPanelMounted(){const t=this.panel.getQueryRunner();this.querySubscription=t.getData({withTransforms:!0,withFieldConfig:!0}).subscribe(this.panelDataObserver)}onPanelTearDown(){this.querySubscription&&(this.querySubscription.unsubscribe(),this.querySubscription=null)}onMetricsPanelRefresh(){if(!this.otherPanelInFullscreenMode()){if(this.panel.snapshotData){this.updateTimeRange();let t=this.panel.snapshotData;return(0,i.isArray)(t)||(t=t.data),this.panelData={state:s.Gu.Done,series:t,timeRange:this.range},this.$timeout((()=>{this.events.emit(r.Kh.dataSnapshotLoad,t)}))}return delete this.error,this.loading=!0,this.datasourceSrv.get(this.panel.datasource,this.panel.scopedVars).then(this.issueQueries.bind(this)).catch((t=>{this.processDataError(t)}))}}processDataError(t){t.cancelled?console.log("Panel request cancelled",t):(this.error=t.message||"Request Error",t.data&&(t.data.message?this.error=t.data.message:t.data.error&&(this.error=t.data.error)),this.angularDirtyCheck())}angularDirtyCheck(){this.$scope.$root.$$phase||this.$scope.$digest()}updateTimeRange(t){this.datasource=t||this.datasource,this.range=this.timeSrv.timeRange();const e=(0,h.W1)(this.panel,this.range);this.timeInfo=e.timeInfo,this.range=e.timeRange}issueQueries(t){this.updateTimeRange(t),this.datasource=t;const e=this.panel;return e.getQueryRunner().run({datasource:e.datasource,queries:e.targets,panelId:e.id,dashboardId:this.dashboard.id,timezone:this.dashboard.getTimezone(),timeInfo:this.timeInfo,timeRange:this.range,maxDataPoints:e.maxDataPoints||this.width,minInterval:e.interval,scopedVars:e.scopedVars,cacheTimeout:e.cacheTimeout,transformations:e.transformations})}handleDataFrames(t){this.loading=!1,this.dashboard&&this.dashboard.snapshot&&(this.panel.snapshotData=t.map((t=>(0,n.og)(t))));try{this.events.emit(r.Kh.dataFramesReceived,t)}catch(t){this.processDataError(t)}}handleQueryResult(t){this.loading=!1,this.dashboard.snapshot&&(this.panel.snapshotData=t.data),t&&t.data||(console.log("Data source query result invalid, missing data field:",t),t={data:[]});try{this.events.emit(r.Kh.dataReceived,t.data)}catch(t){this.processDataError(t)}}}},91082:(t,e,a)=>{a.d(e,{q:()=>p});var i=a(82897),s=a(97437),n=a(19383),r=a(63773),o=a(78837),h=a(98163);function l(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}class p{constructor(t,e){var a,i;l(this,"panel",void 0),l(this,"error",void 0),l(this,"pluginName",""),l(this,"pluginId",""),l(this,"editorTabs",void 0),l(this,"$scope",void 0),l(this,"$injector",void 0),l(this,"$timeout",void 0),l(this,"editModeInitiated",!1),l(this,"containerHeight",void 0),l(this,"events",void 0),l(this,"loading",!1),l(this,"timing",void 0),l(this,"$location",void 0),l(this,"onPluginTypeChange",(t=>{})),this.panel=null!==(a=this.panel)&&void 0!==a?a:t.$parent.panel,this.dashboard=null!==(i=this.dashboard)&&void 0!==i?i:t.$parent.dashboard,this.$injector=e,this.$scope=t,this.$timeout=e.get("$timeout"),this.editorTabs=[],this.$location=new r.O,this.events=new s.F,this.timing={};const h=o.ZP.panels[this.panel.type];h&&(this.pluginId=h.id,this.pluginName=h.name),t.$on(n.Kh.componentDidMount.name,(()=>this.panelDidMount()))}panelDidMount(){this.events.emit(n.Kh.componentDidMount),this.events.emit(n.Kh.initialized),this.dashboard.panelInitialized(this.panel)}renderingCompleted(){h.rv.renderingCompleted()}refresh(){this.panel.refresh()}publishAppEvent(t,e){this.$scope.$root.appEvent(t,e)}initEditMode(){this.editModeInitiated||(this.editModeInitiated=!0,this.events.emit(n.Kh.editModeInitialized))}addEditorTab(t,e,a,s){const n={title:t,directiveFn:e,icon:s};(0,i.isString)(e)&&(n.directiveFn=()=>({templateUrl:e})),a?this.editorTabs.splice(a,0,n):this.editorTabs.push(n)}getExtendedMenu(){const t=[];return this.events.emit(n.Kh.initPanelActions,t),t}async getAdditionalMenuItems(){return[]}otherPanelInFullscreenMode(){return this.dashboard.otherPanelInFullscreen(this.panel)}render(t){this.events.emit(n.Kh.render,t)}}},76261:(t,e,a)=>{a.d(e,{$:()=>c});var i=a(82897),s=a(81351),n=a(32025),r=a(95464),o=a(91115),h=a(97400),l=a(11798),p=a(78837),d=a(9166);class c{constructor(t){this.panel=t}getSeriesList(t){const e=[],{dataList:a,range:i}=t;if(!a||!a.length)return e;for(let t=0;t<a.length;t++){let h=a[t],{timeField:p}=(0,s.sV)(h);if(p){h=(0,l.w)({frame:h,refFieldName:p.name}),p=(0,s.sV)(h).timeField;for(let s=0;s<h.fields.length;s++){const l=h.fields[s];if(l.type!==n.fS.number)continue;const d=(0,r.C)(l,h,a),c=[];for(let t=0;t<h.length;t++)c.push([l.values.get(t),(0,o.CQ)(p.values.get(t)).valueOf()]);e.push(this.toTimeSeries(l,d,t,s,c,e.length,i))}}}if("histogram"===this.panel.xaxis.mode&&!this.panel.stack&&e.length>1){const t=e[0];t.alias=t.aliasEscaped="Count";for(let a=1;a<e.length;a++)t.datapoints=t.datapoints.concat(e[a].datapoints);return[t]}return e}toTimeSeries(t,e,a,i,s,n,r){const o=n%h.O9.length,l=this.panel.aliasColors[e]||h.O9[o],c=new d.Z({datapoints:s||[],alias:e,color:p.ZP.theme.visualization.getColorByName(l),unit:t.config?t.config.unit:void 0,dataFrameIndex:a,fieldIndex:i});if(s&&s.length>0&&r){const t=s[s.length-1][1],e=r.from;if(t-e.valueOf()<-1e4){s[0][1]-e.valueOf()<-1e4&&(c.isOutsideRange=!0)}}return c}setPanelDefaultsForNewXAxisMode(){switch(this.panel.xaxis.mode){case"time":this.panel.bars=!1,this.panel.lines=!0,this.panel.points=!1,this.panel.legend.show=!0,this.panel.tooltip.shared=!0,this.panel.xaxis.values=[];break;case"series":this.panel.bars=!0,this.panel.lines=!1,this.panel.points=!1,this.panel.stack=!1,this.panel.legend.show=!1,this.panel.tooltip.shared=!1,this.panel.xaxis.values=["total"];break;case"histogram":this.panel.bars=!0,this.panel.lines=!1,this.panel.points=!1,this.panel.stack=!1,this.panel.legend.show=!1,this.panel.tooltip.shared=!1}}validateXAxisSeriesValue(){if("series"!==this.panel.xaxis.mode);else{if(0===this.panel.xaxis.values.length)return void(this.panel.xaxis.values=["total"]);const t=this.getXAxisValueOptions({});(0,i.find)(t,{value:this.panel.xaxis.values[0]})||(this.panel.xaxis.values=["total"])}}getXAxisValueOptions(t){return"series"===this.panel.xaxis.mode?[{text:"Avg",value:"avg"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Total",value:"total"},{text:"Count",value:"count"}]:[]}pluckDeep(t,e){const a=e.split(".");let i=t;for(let t=0;t<a.length;++t){if(!i[a[t]])return;i=i[a[t]]}return i}}}}]);
//# sourceMappingURL=271.754e88a805eeaf982174.js.map