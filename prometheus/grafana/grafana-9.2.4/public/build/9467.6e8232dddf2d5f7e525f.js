/*! For license information please see 9467.6e8232dddf2d5f7e525f.js.LICENSE.txt */
(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[9467],{22849:(e,t,a)=>{"use strict";a.d(t,{P:()=>s});var l=a(68404),n=a(68522),r=a(61884),o=a(2986),i=a(45916);const s=e=>{const t=u(e),a=c(t,e);return(0,i.jsx)(n.EditorField,{label:"Group by function","data-testid":"cloud-monitoring-aggregation",children:(0,i.jsx)(r.Ph,{width:"auto",onChange:t=>{let{value:a}=t;return e.onChange(a)},value:a,options:[{label:"Template Variables",options:e.templateVariableOptions},{label:"Aggregations",expanded:!0,options:t}],placeholder:"Select Reducer",inputId:`${e.refId}-group-by-function`,menuPlacement:"top"})})},u=e=>{let{metricDescriptor:t}=e;const a=null==t?void 0:t.valueType,n=null==t?void 0:t.metricKind;return(0,l.useMemo)((()=>a&&n?(0,o.A_)(a,n).map((e=>Object.assign({},e,{label:e.text}))):[]),[a,n])},c=(e,t)=>(0,l.useMemo)((()=>[...e,...t.templateVariableOptions].find((e=>e.value===t.crossSeriesReducer))),[e,t.crossSeriesReducer,t.templateVariableOptions])},21335:(e,t,a)=>{"use strict";a.d(t,{B:()=>s});var l=a(82897),n=a(68404),r=a(68522),o=a(1652),i=a(45916);const s=e=>{let{refId:t,value:a="",onChange:s}=e;const[u,c]=(0,n.useState)(null!=a?a:""),d=(0,l.debounce)(s,1e3);return s=e=>{c(e.target.value),d(e.target.value)},(0,i.jsx)(r.EditorField,{label:"Alias by",children:(0,i.jsx)(o.I,{id:`${t}-alias-by`,value:u,onChange:s})})}},95514:(e,t,a)=>{"use strict";a.d(t,{v:()=>c});var l=a(68404),n=a(68522),r=a(22002),o=a(2986),i=a(78707),s=a(50166),u=a(45916);const c=e=>{let{refId:t,templateVariableOptions:a,onChange:c,query:d,customMetaData:p,datasource:h}=e;const m=(0,l.useMemo)((()=>(0,o.kU)(p,h)),[p,h]);return(0,u.jsxs)(n.EditorFieldGroup,{children:[(0,u.jsx)(n.EditorField,{label:"Alignment function",tooltip:"The process of alignment consists of collecting all data points received in a fixed length of time, applying a function to combine those data points, and assigning a timestamp to the result.",children:(0,u.jsx)(i.X,{inputId:`${t}-alignment-function`,templateVariableOptions:a,query:d,onChange:c})}),(0,u.jsx)(n.EditorField,{label:"Alignment period",tooltip:m,children:(0,u.jsx)(s.$,{inputId:`${t}-alignment-period`,templateVariableOptions:a,current:d.alignmentPeriod,onChange:e=>c(Object.assign({},d,{alignmentPeriod:e})),aligmentPeriods:r.dD})})]})}},78707:(e,t,a)=>{"use strict";a.d(t,{X:()=>i});var l=a(68404),n=a(61884),r=a(2986),o=a(45916);const i=e=>{let{inputId:t,query:a,templateVariableOptions:i,onChange:s}=e;const{valueType:u,metricKind:c,perSeriesAligner:d,preprocessor:p}=a,{perSeriesAligner:h,alignOptions:m}=(0,l.useMemo)((()=>(0,r.ID)(u,c,d,p)),[u,c,d,p]);return(0,o.jsx)(n.Ph,{onChange:e=>{let{value:t}=e;return s(Object.assign({},a,{perSeriesAligner:t}))},value:[...m,...i].find((e=>e.value===h)),options:[{label:"Template Variables",options:i},{label:"Alignment options",expanded:!0,options:m}],placeholder:"Select Alignment",inputId:t,menuPlacement:"top"})}},30870:(e,t,a)=>{"use strict";a.d(t,{X:()=>c});var l=a(68404),n=a(68522),r=a(61884),o=a(22002),i=a(2986),s=a(22849),u=a(45916);const c=e=>{var t,a;let{refId:c,labels:d=[],query:p,onChange:h,variableOptionGroup:m,metricDescriptor:v}=e;const E=(0,l.useMemo)((()=>[m,...(0,i.gY)([...d,...o.$e])]),[d,m]);return(0,u.jsxs)(n.EditorFieldGroup,{children:[(0,u.jsx)(n.EditorField,{label:"Group by",tooltip:"You can reduce the amount of data returned for a metric by combining different time series. To combine multiple time series, you can specify a grouping and a function. Grouping is done on the basis of labels. The grouping function is used to combine the time series in the group into a single time series.",children:(0,u.jsx)(r.NU,{inputId:`${c}-group-by`,width:"auto",placeholder:"Choose label",options:E,value:null!==(t=p.groupBys)&&void 0!==t?t:[],onChange:e=>{h(Object.assign({},p,{groupBys:e.map((e=>e.value))}))},menuPlacement:"top"})}),(0,u.jsx)(s.P,{metricDescriptor:v,templateVariableOptions:m.options,crossSeriesReducer:p.crossSeriesReducer,groupBys:null!==(a=p.groupBys)&&void 0!==a?a:[],onChange:e=>h(Object.assign({},p,{crossSeriesReducer:e})),refId:c})]})}},25836:(e,t,a)=>{"use strict";a.d(t,{p:()=>h});var l=a(68404),n=a(46196),r=a(68522),o=a(25049),i=a(61884),s=a(2986),u=a(45916);const c="=",d="AND",p=["=","!=","=~","!=~"].map(n.E),h=e=>{let{labels:t={},filters:a,onChange:h,variableOptionGroup:m}=e;const v=(0,l.useMemo)((()=>(0,s.mi)(a)),[a]),E=(0,l.useMemo)((()=>[m,...(0,s.gY)(Object.keys(t))]),[t,m]),I=e=>{let{key:a="",value:l=""}=e;E.some((e=>e.options?E.some((e=>e.label===a)):e.label===a))||E.push({label:a,value:a});const r=t.hasOwnProperty(a)?[m,...t[a].map(n.E)]:[m];return r.some((e=>e.label===l))||r.push({label:l,value:l}),{options:E,valueOptions:r}};return(0,u.jsx)(r.EditorRow,{children:(0,u.jsx)(r.EditorField,{label:"Filter",tooltip:"To reduce the amount of data charted, apply a filter. A filter has three components: a label, a comparison, and a value. The comparison can be an equality, inequality, or regular expression.",children:(0,u.jsx)(r.EditorList,{items:v,renderItem:(e,t,a)=>{const{key:l="",operator:n=c,value:s="",condition:h=d}=e,{options:m,valueOptions:v}=I(e);return(0,u.jsxs)(o.Lh,{spacing:"xs",width:"auto",children:[(0,u.jsx)(i.Ph,{"aria-label":"Filter label key",formatCreateLabel:e=>`Use label key: ${e}`,allowCustomValue:!0,value:l,options:m,onChange:e=>{let{value:a=""}=e;return t({key:a,operator:n,value:s,condition:h})}}),(0,u.jsx)(i.Ph,{value:n,options:p,onChange:e=>{let{value:a=c}=e;return t({key:l,operator:a,value:s,condition:h})}}),(0,u.jsx)(i.Ph,{"aria-label":"Filter label value",placeholder:"add filter value",formatCreateLabel:e=>`Use label value: ${e}`,allowCustomValue:!0,value:s,options:v,onChange:e=>{let{value:a=""}=e;return t({key:l,operator:n,value:a,condition:h})}}),(0,u.jsx)(r.AccessoryButton,{"aria-label":"Remove",icon:"times",variant:"secondary",onClick:a,type:"button"})]})},onChange:e=>{const t=e.map((e=>{let{key:t,operator:a,value:l,condition:n}=e;return{key:t||"",operator:a||c,value:l||"",condition:n||d}}));h((e=>e.flatMap((e=>{let{key:t,operator:a,value:l,condition:n}=e;return[t,a,l,n]})).slice(0,-1))(t))}})})})}},54834:(e,t,a)=>{"use strict";a.d(t,{a:()=>r});a(68404);var l=a(63639),n=a(45916);function r(e){let{query:t,onChange:a,onRunQuery:r}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(l.K,{name:"Query",className:"slate-query-field",value:t,rows:10,placeholder:"Enter a Cloud Monitoring MQL query (Run with Shift+Enter)",onBlur:r,onChange:e=>a(e.currentTarget.value),onKeyDown:e=>{"Enter"===e.key&&(e.shiftKey||e.ctrlKey)&&(e.preventDefault(),r())}})})}},80425:(e,t,a)=>{"use strict";a.d(t,{a1:()=>g,wi:()=>I});var l,n=a(68404),r=a(68522),o=a(2986),i=a(25576),s=a(25049),u=a(72786),c=a(22002),d=a(30194),p=a(45916);const h=e=>{let{refId:t,onChange:a,graphPeriod:n,variableOptionGroup:o}=e;return(0,p.jsx)(r.EditorRow,{children:(0,p.jsx)(r.EditorField,{label:"Graph period",htmlFor:`${t}-graph-period`,tooltip:(0,p.jsxs)(p.Fragment,{children:["Set ",l||(l=(0,p.jsx)("code",{children:"graph_period"}))," which forces a preferred period between points. Automatically set to the current interval if left blank."]}),children:(0,p.jsxs)(s.Lh,{children:[(0,p.jsx)(u.r,{"data-testid":`${t}-switch-graph-period`,value:"disabled"!==n,onChange:e=>a(e.currentTarget.checked?"":"disabled")}),(0,p.jsx)(d.$d,{inputId:`${t}-graph-period`,templateVariableOptions:o.options,current:n,onChange:a,disabled:"disabled"===n,aligmentPeriods:c.Ry})]})})})};var m=a(54834),v=a(91391);const E={labels:{}},I=e=>({editorMode:i.je.Visual,projectName:e.getDefaultProject(),metricType:"",metricKind:i.lH.GAUGE,valueType:"",crossSeriesReducer:"REDUCE_NONE",alignmentPeriod:"cloud-monitoring-auto",perSeriesAligner:i.CS.ALIGN_MEAN,groupBys:[],filters:[],aliasBy:"",query:"",preprocessor:i.mG.None});function T(e){let{refId:t,query:a,datasource:l,onChange:s,onRunQuery:u,customMetaData:c,variableOptionGroup:d}=e;const[I,T]=(0,n.useState)(E),{projectName:g,metricType:y,groupBys:b,editorMode:f,crossSeriesReducer:N}=a;(0,n.useEffect)((()=>{g&&y&&l.getLabels(y,t,g).then((e=>T((t=>Object.assign({},t,{labels:e})))))}),[l,b,y,g,t,N]);const x=(0,n.useCallback)((e=>{s(Object.assign({},a,e)),u()}),[s,u,a]),A=(0,n.useCallback)((e=>{let{valueType:t,metricKind:l,type:n}=e;const r=l===i.lH.GAUGE||t===i.$h.DISTRIBUTION?i.mG.None:i.mG.Rate,{perSeriesAligner:s}=(0,o.ID)(t,l,I.perSeriesAligner,r);x(Object.assign({},a,{perSeriesAligner:s,metricType:n,valueType:t,metricKind:l,preprocessor:r}))}),[x,a,I]);return(0,p.jsxs)(r.EditorRows,{children:[f===i.je.Visual&&(0,p.jsx)(v.s,{refId:t,labels:I.labels,variableOptionGroup:d,customMetaData:c,onMetricTypeChange:A,onChange:x,datasource:l,query:a}),f===i.je.MQL&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(m.a,{onChange:e=>s(Object.assign({},a,{query:e})),onRunQuery:u,query:a.query}),(0,p.jsx)(h,{onChange:e=>s(Object.assign({},a,{graphPeriod:e})),graphPeriod:a.graphPeriod,refId:t,variableOptionGroup:d})]})]})}const g=n.memo(T)},44285:(e,t,a)=>{"use strict";a.d(t,{C:()=>p});var l=a(27549),n=a(82897),r=a(68404),o=a(68522),i=a(9617),s=a(96535),u=a(61884),c=a(43001),d=a(45916);function p(e){const[t,a]=(0,r.useState)([]),[l,p]=(0,r.useState)(),[m,v]=(0,r.useState)([]),[E,I]=(0,r.useState)([]),[T,g]=(0,r.useState)(""),y=(0,i.l4)(),b=(0,s.D)(y),f=(0,i.wW)(h),{onProjectChange:N,query:x,refId:A,metricType:O,templateVariableOptions:C,projectName:L,datasource:j,onChange:G,children:U}=e,{templateSrv:D}=j,_=(0,r.useCallback)(((e,t)=>e.find((e=>e.type===D.replace(t)))),[D]);(0,r.useEffect)((()=>{(async()=>{if(L){const e=await j.getMetricTypes(L),t=R(e);a(e),I(t)}})()}),[j,L,f,b.optionDescription]),(0,r.useEffect)((()=>{const e=(e=>{const t=_(e,O);if(!t)return[];return e.filter((e=>e.service===t.service)).map((e=>({service:e.service,value:e.type,label:e.displayName,component:function(){return(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:f,children:e.type}),(0,d.jsx)("div",{className:b.optionDescription,children:e.description})]})}})))})(t),a=e.length>0?e[0].service:"",l=_(t,O);p(l),v(e),g(a)}),[t,_,O,f,b.optionDescription]);const S=e=>{let{value:a}=e;const l=_(t,a);p(l),G(Object.assign({},l,{type:a}))},R=e=>{const t=e.map((e=>({value:e.service,label:(0,n.startCase)(e.serviceShortName)})));return t.length>0?(0,n.uniqBy)(t,(e=>e.value)):[]};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(o.EditorRow,{children:(0,d.jsxs)(o.EditorFieldGroup,{children:[(0,d.jsx)(c.I,{refId:A,templateVariableOptions:C,projectName:L,datasource:j,onChange:e=>{N(Object.assign({},x,{projectName:e}))}}),(0,d.jsx)(o.EditorField,{label:"Service",width:"auto",children:(0,d.jsx)(u.Ph,{width:"auto",onChange:e=>{let{value:a}=e;const l=t.filter((e=>e.service===D.replace(a))).map((e=>({service:e.service,value:e.type,label:e.displayName,description:e.description})));l.length>0&&!l.some((e=>e.value===D.replace(O)))?(S(l[0]),g(a),v(l)):(g(a),v(l))},value:[...E,...C].find((e=>e.value===T)),options:[{label:"Template Variables",options:C},...E],placeholder:"Select Services",inputId:`${e.refId}-service`})}),(0,d.jsx)(o.EditorField,{label:"Metric name",width:"auto",children:(0,d.jsx)(u.Ph,{width:"auto",onChange:S,value:[...m,...C].find((e=>e.value===O)),options:[{label:"Template Variables",options:C},...m],placeholder:"Select Metric",inputId:`${e.refId}-select-metric`})})]})}),U(l)]})}const h=e=>l.css`
  label: grafana-select-option-description;
  font-weight: normal;
  font-style: italic;
  color: ${e.colors.text.secondary};
`},50166:(e,t,a)=>{"use strict";a.d(t,{$:()=>o});var l=a(68404),n=a(61884),r=a(45916);function o(e){let{inputId:t,templateVariableOptions:a,onChange:o,current:i,disabled:s,aligmentPeriods:u}=e;const c=(0,l.useMemo)((()=>u.map((e=>Object.assign({},e,{label:e.text})))),[u]),d=(0,l.useMemo)((()=>c.filter((e=>!e.hidden))),[c]);return(0,r.jsx)(n.Ph,{width:"auto",onChange:e=>{let{value:t}=e;return o(t)},value:[...c,...a].find((e=>e.value===i)),options:[{label:"Template Variables",options:a},{label:"Aggregations",expanded:!0,options:d}],placeholder:"Select Period",inputId:t,disabled:s,allowCustomValue:!0,menuPlacement:"top"})}},31642:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var l=a(68404),n=a(68522),r=a(96380),o=a(2986),i=a(25576),s=a(45916);const u={label:"None",value:i.mG.None},c=e=>{var t;let{query:a,metricDescriptor:l,onChange:u}=e;const c=d(l);return(0,s.jsx)(n.EditorField,{label:"Pre-processing",tooltip:"Preprocessing options are displayed when the selected metric has a metric kind of delta or cumulative. The specific options available are determined by the metric's value type. If you select 'Rate', data points are aligned and converted to a rate per time series. If you select 'Delta', data points are aligned by their delta (difference) per time series",children:(0,s.jsx)(r.S,{onChange:e=>{const{valueType:t,metricKind:l,perSeriesAligner:n}=a,{perSeriesAligner:r}=(0,o.ID)(t,l,n,e);u(Object.assign({},a,{preprocessor:e,perSeriesAligner:r}))},value:null!==(t=a.preprocessor)&&void 0!==t?t:i.mG.None,options:c})})},d=e=>{const t=null==e?void 0:e.metricKind,a=null==e?void 0:e.valueType;return(0,l.useMemo)((()=>{if(!t||t===i.lH.GAUGE||a===i.$h.DISTRIBUTION)return[u];const e=[u,{label:"Rate",value:i.mG.Rate,description:"Data points are aligned and converted to a rate per time series"}];return t===i.lH.CUMULATIVE?[...e,{label:"Delta",value:i.mG.Delta,description:"Data points are aligned by their delta (difference) per time series"}]:e}),[t,a])}},43001:(e,t,a)=>{"use strict";a.d(t,{I:()=>i});var l=a(68404),n=a(68522),r=a(61884),o=a(45916);function i(e){let{refId:t,projectName:a,datasource:i,onChange:s,templateVariableOptions:u}=e;const[c,d]=(0,l.useState)([]);(0,l.useEffect)((()=>{i.getProjects().then((e=>d(e)))}),[i]);const p=(0,l.useMemo)((()=>[c,{label:"Template Variables",options:u},...c]),[c,u]);return(0,o.jsx)(n.EditorField,{label:"Project",children:(0,o.jsx)(r.Ph,{width:"auto",allowCustomValue:!0,formatCreateLabel:e=>`Use project: ${e}`,onChange:e=>{let{value:t}=e;return s(t)},options:p,value:{value:a,label:a},placeholder:"Select Project",inputId:`${t}-project`})})}},79467:(e,t,a)=>{"use strict";a.d(t,{W:()=>I});var l,n=a(68404),r=a(46196),o=a(68522),i=a(25576),s=a(80425),u=a(96380),c=a(22002),d=a(45916);const p=[{label:"Builder",value:i.je.Visual},{label:"MQL",value:i.je.MQL}],h=e=>{const{query:t,metricQuery:a,sloQuery:n,onChange:r,onRunQuery:s}=e,{queryType:h}=t,{editorMode:m}=a;return(0,d.jsxs)(o.EditorHeader,{children:[(0,d.jsx)(o.InlineSelect,{label:"Query type",options:c.XI,value:h,onChange:e=>{let{value:a}=e;r(Object.assign({},t,{sloQuery:n,queryType:a})),s()}}),l||(l=(0,d.jsx)(o.FlexItem,{grow:1})),h!==i.xL.SLO&&(0,d.jsx)(u.S,{size:"sm",options:p,value:m||i.je.Visual,onChange:e=>{r(Object.assign({},t,{metricQuery:Object.assign({},a,{editorMode:e})}))}})]})};var m=a(78623),v=a(30194);const E=["hide","refId","datasource","key","queryType","maxLines","metric"];class I extends n.PureComponent{async UNSAFE_componentWillMount(){const{datasource:e,query:t}=this.props;if(!this.props.query.hasOwnProperty("metricQuery")){const e=function(e,t){if(null==e)return{};var a,l,n={},r=Object.keys(e);for(l=0;l<r.length;l++)a=r[l],t.indexOf(a)>=0||(n[a]=e[a]);return n}(this.props.query,E);this.props.query.metricQuery=e}[i.xL.METRICS,i.xL.SLO].includes(this.props.query.queryType)||(this.props.query.queryType=i.xL.METRICS),await e.ensureGCEDefaultProject(),t.metricQuery.projectName||(this.props.query.metricQuery.projectName=e.getDefaultProject())}onQueryChange(e,t){this.props.onChange(Object.assign({},this.props.query,{[e]:t})),this.props.onRunQuery()}render(){var e,t,a;const{datasource:l,query:n,onRunQuery:u,onChange:c}=this.props,p=Object.assign({},(0,s.wi)(l),n.metricQuery),E=Object.assign({},(0,m.w)(l),n.sloQuery),I=n.queryType||i.xL.METRICS,T=null!==(e=this.props.data)&&void 0!==e&&e.series.length?null===(t=this.props.data)||void 0===t?void 0:t.series[0].meta:{},g=null!==(a=null==T?void 0:T.custom)&&void 0!==a?a:{},y={label:"Template Variables",expanded:!1,options:l.getVariables().map(r.E)};return(0,d.jsxs)(o.EditorRows,{children:[(0,d.jsx)(h,{query:n,metricQuery:p,sloQuery:E,onChange:c,onRunQuery:u}),I===i.xL.METRICS&&(0,d.jsx)(v.a1,{refId:n.refId,variableOptionGroup:y,customMetaData:g,onChange:e=>{this.props.onChange(Object.assign({},this.props.query,{metricQuery:e}))},onRunQuery:u,datasource:l,query:p}),I===i.xL.SLO&&(0,d.jsx)(v.D6,{refId:n.refId,variableOptionGroup:y,customMetaData:g,onChange:e=>this.onQueryChange("sloQuery",e),onRunQuery:u,datasource:l,query:E})]})}}},78623:(e,t,a)=>{"use strict";a.d(t,{D:()=>T,w:()=>I});var l=a(68404),n=a(68522),r=a(22002),o=a(2986),i=a(25576),s=a(21335),u=a(61884),c=a(45916);const d=e=>{let{refId:t,current:a,templateVariableOptions:l,onChange:o}=e;const i=r.yy.map((e=>Object.assign({},e,{label:e.text})));a&&!i.find((e=>e.value===a))&&i.push({label:a,text:a,value:a,hidden:!1});const s=i.filter((e=>!e.hidden));return(0,c.jsx)(n.EditorField,{label:"Lookback period",htmlFor:`${t}-lookback-period`,children:(0,c.jsx)(u.Ph,{inputId:`${t}-lookback-period`,width:"auto",allowCustomValue:!0,value:[...i,...l].find((e=>e.value===a)),options:[{label:"Template Variables",options:l},{label:"Predefined periods",expanded:!0,options:s}],onChange:e=>{let{value:t}=e;return o(t)}})})};var p=a(50166),h=a(43001);const m=e=>{let{refId:t,query:a,templateVariableOptions:r,onChange:o,datasource:i}=e;const[s,d]=(0,l.useState)([]),{projectName:p,serviceId:h}=a;return(0,l.useEffect)((()=>{p&&h&&i.getServiceLevelObjectives(p,h).then((e=>{d([{label:"Template Variables",options:r},...e])}))}),[i,p,h,r]),(0,c.jsx)(n.EditorField,{label:"SLO",children:(0,c.jsx)(u.Ph,{inputId:`${t}-slo`,width:"auto",allowCustomValue:!0,value:(null==a?void 0:a.sloId)&&{value:null==a?void 0:a.sloId,label:(null==a?void 0:a.sloName)||(null==a?void 0:a.sloId)},placeholder:"Select SLO",options:s,onChange:async e=>{let{value:t="",label:l=""}=e;const n=(await i.getServiceLevelObjectives(p,h)).find((e=>{let{value:a}=e;return a===i.templateSrv.replace(t)}));o(Object.assign({},a,{sloId:t,sloName:l,goal:null==n?void 0:n.goal}))}})})},v=e=>{let{refId:t,query:a,templateVariableOptions:l,onChange:o,datasource:i}=e;return(0,c.jsx)(n.EditorField,{label:"Selector",htmlFor:`${t}-slo-selector`,children:(0,c.jsx)(u.Ph,{inputId:`${t}-slo-selector`,width:"auto",allowCustomValue:!0,value:[...r.IR,...l].find((e=>{var t;return null!==(t=e.value===(null==a?void 0:a.selectorName))&&void 0!==t?t:""})),options:[{label:"Template Variables",options:l},...r.IR],onChange:e=>{let{value:t}=e;return o(Object.assign({},a,{selectorName:null!=t?t:""}))}})})},E=e=>{let{refId:t,query:a,templateVariableOptions:r,onChange:o,datasource:i}=e;const[s,d]=(0,l.useState)([]),{projectName:p}=a;return(0,l.useEffect)((()=>{p&&i.getSLOServices(p).then((e=>{d([{label:"Template Variables",options:r},...e])}))}),[i,p,r]),(0,c.jsx)(n.EditorField,{label:"Service",children:(0,c.jsx)(u.Ph,{inputId:`${t}-slo-service`,width:"auto",allowCustomValue:!0,value:(null==a?void 0:a.serviceId)&&{value:null==a?void 0:a.serviceId,label:(null==a?void 0:a.serviceName)||(null==a?void 0:a.serviceId)},placeholder:"Select service",options:s,onChange:e=>{let{value:t="",label:l=""}=e;return o(Object.assign({},a,{serviceId:t,serviceName:l,sloId:""}))}})})},I=e=>({projectName:e.getDefaultProject(),alignmentPeriod:"cloud-monitoring-auto",perSeriesAligner:i.CS.ALIGN_MEAN,aliasBy:"",selectorName:"select_slo_health",serviceId:"",serviceName:"",sloId:"",sloName:"",lookbackPeriod:""});function T(e){let{refId:t,query:a,datasource:i,onChange:u,variableOptionGroup:I,customMetaData:T}=e;const g=(0,l.useMemo)((()=>(0,o.kU)(T,i)),[T,i]);return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(n.EditorRow,{children:[(0,c.jsx)(h.I,{refId:t,templateVariableOptions:I.options,projectName:a.projectName,datasource:i,onChange:e=>u(Object.assign({},a,{projectName:e}))}),(0,c.jsx)(E,{refId:t,datasource:i,templateVariableOptions:I.options,query:a,onChange:u}),(0,c.jsx)(m,{refId:t,datasource:i,templateVariableOptions:I.options,query:a,onChange:u}),(0,c.jsx)(v,{refId:t,datasource:i,templateVariableOptions:I.options,query:a,onChange:u}),a.selectorName===r.Fh&&(0,c.jsx)(d,{refId:t,onChange:e=>u(Object.assign({},a,{lookbackPeriod:e})),current:a.lookbackPeriod,templateVariableOptions:I.options}),(0,c.jsx)(n.EditorFieldGroup,{children:(0,c.jsx)(n.EditorField,{label:"Alignment period",tooltip:g,children:(0,c.jsx)(p.$,{inputId:`${t}-alignment-period`,templateVariableOptions:I.options,current:a.alignmentPeriod,onChange:e=>u(Object.assign({},a,{alignmentPeriod:e})),aligmentPeriods:r.dD})})}),(0,c.jsx)(s.B,{refId:t,value:a.aliasBy,onChange:e=>u(Object.assign({},a,{aliasBy:e}))})]})})}},91391:(e,t,a)=>{"use strict";a.d(t,{s:()=>h});var l=a(68404),n=a(68522),r=a(21335),o=a(95514),i=a(30870),s=a(25836),u=a(44285),c=a(31642),d=a(45916);function p(e){let{refId:t,query:a,labels:l,datasource:p,onChange:h,onMetricTypeChange:m,customMetaData:v,variableOptionGroup:E}=e;return(0,d.jsx)(u.C,{refId:t,projectName:a.projectName,metricType:a.metricType,templateVariableOptions:E.options,datasource:p,onChange:m,onProjectChange:h,query:a,children:e=>(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.p,{labels:l,filters:a.filters,onChange:e=>h(Object.assign({},a,{filters:e})),variableOptionGroup:E}),(0,d.jsxs)(n.EditorRow,{children:[(0,d.jsx)(c.A,{metricDescriptor:e,query:a,onChange:h}),(0,d.jsx)(i.X,{refId:t,labels:Object.keys(l),query:a,onChange:h,variableOptionGroup:E,metricDescriptor:e}),(0,d.jsx)(o.v,{refId:t,datasource:p,templateVariableOptions:E.options,query:a,customMetaData:v,onChange:h}),(0,d.jsx)(r.B,{refId:t,value:a.aliasBy,onChange:e=>{h(Object.assign({},a,{aliasBy:e}))}})]})]})})}const h=l.memo(p)},30194:(e,t,a)=>{"use strict";a.d(t,{zI:()=>r,a1:()=>o.a1,$d:()=>d.$,D6:()=>i.D,Th:()=>c});a(43001),a(44285),a(30870),a(95514),a(25836),a(68404);var l,n=a(45916);const r=()=>l||(l=(0,n.jsx)("div",{className:"gf-form grafana-info-box alert-info",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("h5",{children:"Annotation Query Format"}),(0,n.jsxs)("p",{children:["An annotation is an event that is overlaid on top of graphs. Annotation rendering is expensive so it is important to limit the number of rows returned."," "]}),(0,n.jsx)("p",{children:"The Title and Text fields support templating and can use data returned from the query. For example, the Title field could have the following text:"}),(0,n.jsxs)("code",{children:["{{metric.type}}"," has value: ","{{metric.value}}"]}),(0,n.jsxs)("p",{children:["Example Result: ",(0,n.jsx)("code",{children:"monitoring.googleapis.com/uptime_check/http_status has this value: 502"})]}),(0,n.jsx)("label",{children:"Patterns:"}),(0,n.jsxs)("p",{children:[(0,n.jsx)("code",{children:"{{metric.value}}"})," = value of the metric/point"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("code",{children:"{{metric.type}}"})," = metric type e.g. compute.googleapis.com/instance/cpu/usage_time"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("code",{children:"{{metric.name}}"})," = name part of metric e.g. instance/cpu/usage_time"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("code",{children:"{{metric.service}}"})," = service part of metric e.g. compute"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("code",{children:"{{metric.label.label_name}}"})," = Metric label metadata e.g. metric.label.instance_name"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("code",{children:"{{resource.label.label_name}}"})," = Resource label metadata e.g. resource.label.zone"]})]})}));a(78707),a(21335),a(22849);var o=a(80425),i=a(78623),s=(a(54834),a(27549),a(24643)),u=a(61884);a(22002);const c=e=>{let{label:t,onChange:a,value:l,options:r,allowCustomValue:o=!1}=e;return(0,n.jsx)(s._,{label:t,labelWidth:20,children:(0,n.jsx)(u.Ph,{width:25,allowCustomValue:o,value:l,onChange:e=>{let{value:t}=e;return a(t)},options:r})})};a(91391);var d=a(50166);a(31642)},22002:(e,t,a)=>{"use strict";a.d(t,{$e:()=>c,Eu:()=>r,Fh:()=>d,IR:()=>p,Ry:()=>s,XI:()=>h,dD:()=>i,lx:()=>o,yy:()=>u});var l=a(28153),n=a(25576);l.GoogleAuthType.JWT,l.GoogleAuthType.GCE;const r=[{text:"none",value:"ALIGN_NONE",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY,n.$h.DISTRIBUTION,n.$h.STRING,n.$h.VALUE_TYPE_UNSPECIFIED,n.$h.BOOL],metricKinds:[n.lH.GAUGE]},{text:"delta",value:"ALIGN_DELTA",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY,n.$h.DISTRIBUTION],metricKinds:[n.lH.CUMULATIVE,n.lH.DELTA]},{text:"rate",value:"ALIGN_RATE",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY],metricKinds:[n.lH.CUMULATIVE,n.lH.DELTA]},{text:"interpolate",value:"ALIGN_INTERPOLATE",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY],metricKinds:[n.lH.GAUGE]},{text:"next older",value:"ALIGN_NEXT_OLDER",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY,n.$h.DISTRIBUTION,n.$h.STRING,n.$h.VALUE_TYPE_UNSPECIFIED,n.$h.BOOL],metricKinds:[n.lH.GAUGE]},{text:"min",value:"ALIGN_MIN",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY],metricKinds:[n.lH.GAUGE,n.lH.DELTA]},{text:"max",value:"ALIGN_MAX",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY],metricKinds:[n.lH.GAUGE,n.lH.DELTA]},{text:"mean",value:"ALIGN_MEAN",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY],metricKinds:[n.lH.GAUGE,n.lH.DELTA]},{text:"count",value:"ALIGN_COUNT",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY,n.$h.BOOL],metricKinds:[n.lH.GAUGE,n.lH.DELTA]},{text:"sum",value:"ALIGN_SUM",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY,n.$h.DISTRIBUTION],metricKinds:[n.lH.GAUGE,n.lH.DELTA]},{text:"stddev",value:"ALIGN_STDDEV",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY],metricKinds:[n.lH.GAUGE,n.lH.DELTA]},{text:"count true",value:"ALIGN_COUNT_TRUE",valueTypes:[n.$h.BOOL],metricKinds:[n.lH.GAUGE]},{text:"count false",value:"ALIGN_COUNT_FALSE",valueTypes:[n.$h.BOOL],metricKinds:[n.lH.GAUGE]},{text:"fraction true",value:"ALIGN_FRACTION_TRUE",valueTypes:[n.$h.BOOL],metricKinds:[n.lH.GAUGE]},{text:"percentile 99",value:"ALIGN_PERCENTILE_99",valueTypes:[n.$h.DISTRIBUTION],metricKinds:[n.lH.GAUGE,n.lH.DELTA]},{text:"percentile 95",value:"ALIGN_PERCENTILE_95",valueTypes:[n.$h.DISTRIBUTION],metricKinds:[n.lH.GAUGE,n.lH.DELTA]},{text:"percentile 50",value:"ALIGN_PERCENTILE_50",valueTypes:[n.$h.DISTRIBUTION],metricKinds:[n.lH.GAUGE,n.lH.DELTA]},{text:"percentile 05",value:"ALIGN_PERCENTILE_05",valueTypes:[n.$h.DISTRIBUTION],metricKinds:[n.lH.GAUGE,n.lH.DELTA]},{text:"percent change",value:"ALIGN_PERCENT_CHANGE",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY],metricKinds:[n.lH.GAUGE,n.lH.DELTA]}],o=[{text:"none",value:"REDUCE_NONE",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY,n.$h.DISTRIBUTION,n.$h.BOOL,n.$h.STRING],metricKinds:[n.lH.GAUGE,n.lH.DELTA,n.lH.CUMULATIVE,n.lH.METRIC_KIND_UNSPECIFIED]},{text:"mean",value:"REDUCE_MEAN",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY,n.$h.DISTRIBUTION],metricKinds:[n.lH.GAUGE,n.lH.DELTA,n.lH.CUMULATIVE]},{text:"min",value:"REDUCE_MIN",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY],metricKinds:[n.lH.GAUGE,n.lH.DELTA,n.lH.CUMULATIVE,n.lH.METRIC_KIND_UNSPECIFIED]},{text:"max",value:"REDUCE_MAX",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY],metricKinds:[n.lH.GAUGE,n.lH.DELTA,n.lH.CUMULATIVE,n.lH.METRIC_KIND_UNSPECIFIED]},{text:"sum",value:"REDUCE_SUM",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY,n.$h.DISTRIBUTION],metricKinds:[n.lH.GAUGE,n.lH.DELTA,n.lH.CUMULATIVE,n.lH.METRIC_KIND_UNSPECIFIED]},{text:"std. dev.",value:"REDUCE_STDDEV",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY,n.$h.DISTRIBUTION],metricKinds:[n.lH.GAUGE,n.lH.DELTA,n.lH.CUMULATIVE,n.lH.METRIC_KIND_UNSPECIFIED]},{text:"count",value:"REDUCE_COUNT",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY,n.$h.DISTRIBUTION,n.$h.BOOL,n.$h.STRING],metricKinds:[n.lH.GAUGE,n.lH.DELTA,n.lH.CUMULATIVE]},{text:"count true",value:"REDUCE_COUNT_TRUE",valueTypes:[n.$h.BOOL],metricKinds:[n.lH.GAUGE,n.lH.DELTA]},{text:"count false",value:"REDUCE_COUNT_FALSE",valueTypes:[n.$h.BOOL],metricKinds:[n.lH.GAUGE,n.lH.DELTA]},{text:"99th percentile",value:"REDUCE_PERCENTILE_99",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY,n.$h.DISTRIBUTION],metricKinds:[n.lH.GAUGE,n.lH.DELTA,n.lH.CUMULATIVE]},{text:"95th percentile",value:"REDUCE_PERCENTILE_95",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY,n.$h.DISTRIBUTION],metricKinds:[n.lH.GAUGE,n.lH.DELTA,n.lH.CUMULATIVE]},{text:"50th percentile",value:"REDUCE_PERCENTILE_50",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY,n.$h.DISTRIBUTION],metricKinds:[n.lH.GAUGE,n.lH.DELTA,n.lH.CUMULATIVE]},{text:"5th percentile",value:"REDUCE_PERCENTILE_05",valueTypes:[n.$h.INT64,n.$h.DOUBLE,n.$h.MONEY,n.$h.DISTRIBUTION],metricKinds:[n.lH.GAUGE,n.lH.DELTA,n.lH.CUMULATIVE]}],i=[{text:"grafana auto",value:"grafana-auto"},{text:"stackdriver auto",value:"stackdriver-auto",hidden:!0},{text:"cloud monitoring auto",value:"cloud-monitoring-auto"},{text:"1m",value:"+60s"},{text:"2m",value:"+120s"},{text:"5m",value:"+300s"},{text:"10m",value:"+600s"},{text:"30m",value:"+1800s"},{text:"1h",value:"+3600s"},{text:"3h",value:"+7200s"},{text:"6h",value:"+21600s"},{text:"1d",value:"+86400s"},{text:"3d",value:"+259200s"},{text:"1w",value:"+604800s"}],s=[{text:"auto",value:"auto"},{text:"1m",value:"1m"},{text:"2m",value:"2m"},{text:"5m",value:"5m"},{text:"10m",value:"10m"},{text:"30m",value:"30m"},{text:"1h",value:"1h"},{text:"3h",value:"3h"},{text:"6h",value:"6h"},{text:"1d",value:"1d"},{text:"3d",value:"3d"},{text:"1w",value:"1w"}],u=[{text:"1m",value:"1m"},{text:"2m",value:"2m"},{text:"5m",value:"5m"},{text:"10m",value:"10m"},{text:"30m",value:"30m"},{text:"1h",value:"1h"},{text:"3h",value:"3h"},{text:"6h",value:"6h"},{text:"24h",value:"24h"},{text:"72h",value:"72h"}],c=["metadata.system_labels.cloud_account","metadata.system_labels.name","metadata.system_labels.region","metadata.system_labels.state","metadata.system_labels.instance_group","metadata.system_labels.node_name","metadata.system_labels.service_name","metadata.system_labels.top_level_controller_type","metadata.system_labels.top_level_controller_name","metadata.system_labels.container_image"],d="select_slo_burn_rate",p=[{label:"SLI Value",value:"select_slo_health"},{label:"SLO Compliance",value:"select_slo_compliance"},{label:"SLO Error Budget Remaining",value:"select_slo_budget_fraction"},{label:"SLO Burn Rate",value:d}],h=[{label:"Metrics",value:n.xL.METRICS},{label:"Service Level Objectives (SLO)",value:n.xL.SLO}]},2986:(e,t,a)=>{"use strict";a.d(t,{A_:()=>p,FL:()=>c,ID:()=>m,Qd:()=>h,Qf:()=>u,gY:()=>v,kU:()=>I,mi:()=>E,oU:()=>d,qA:()=>s});var l=a(82897),n=a(23541),r=a(93921),o=a(22002),i=a(25576);const s=e=>(0,l.uniqBy)(e,"service"),u=(e,t)=>e.filter((e=>e.service===t)),c=(e,t,a,l)=>{const n=u(e,l).map((e=>({value:e.type,name:e.displayName}))),r=n.some((e=>e.value===a)),o=n.length?n[0].value:"";return{metricTypes:n,selectedMetricType:r?t:o}},d=(e,t,a)=>(a&&a===i.mG.Rate&&(t=i.lH.GAUGE),e?o.Eu.filter((a=>-1!==a.valueTypes.indexOf(e)&&-1!==a.metricKinds.indexOf(t))):[]),p=(e,t)=>t?o.lx.filter((a=>-1!==a.valueTypes.indexOf(e)&&-1!==a.metricKinds.indexOf(t))):[],h=async(e,t,a)=>{const l=await e.getLabels(t,"handleLabelKeysQuery",a);return[...Object.keys(l),...o.$e]},m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.$h.DOUBLE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.lH.GAUGE,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.CS.ALIGN_MEAN,l=arguments.length>3?arguments[3]:void 0;const n=(0,r.J)(),o=d(e,t,l).map((e=>Object.assign({},e,{label:e.text})));return o.some((e=>e.value===n.replace(a)))||(a=o.length>0?o[0].value:i.CS.ALIGN_MEAN),{alignOptions:o,perSeriesAligner:a}},v=e=>{const t=e.reduce(((e,t)=>{const a=t.split(".").map(l.startCase),n=(2===a.length?a:(0,l.initial)(a)).join(" "),r={value:t,label:t};return e[n]?e[n]=[...e[n],r]:e[n]=[r],e}),{});return Object.entries(t).map((e=>{let[t,a]=e;return{label:t,options:a,expanded:!0}}),[])},E=e=>(0,l.chunk)(e,4).map((e=>{let[t,a,l,n="AND"]=e;return{key:t,operator:a,value:l,condition:n}})),I=(e,t)=>{var a;const{perSeriesAligner:l,alignmentPeriod:r}=e;if(!r||!l)return"";const i=o.Eu.find((e=>e.value===t.templateSrv.replace(l))),s=parseInt(r,10);return`${n.secondsToHms(s)} interval (${null!==(a=null==i?void 0:i.text)&&void 0!==a?a:""})`}},25576:(e,t,a)=>{"use strict";a.d(t,{$h:()=>u,Bp:()=>n,CS:()=>c,je:()=>o,lH:()=>s,mG:()=>i,xL:()=>r});var l=a(28153);l.GoogleAuthType.JWT,l.GoogleAuthType.GCE;let n,r,o,i,s,u,c;!function(e){e.Projects="projects",e.Services="services",e.DefaultProject="defaultProject",e.MetricTypes="metricTypes",e.LabelKeys="labelKeys",e.LabelValues="labelValues",e.ResourceTypes="resourceTypes",e.Aggregations="aggregations",e.Aligners="aligners",e.AlignmentPeriods="alignmentPeriods",e.Selectors="selectors",e.SLOServices="sloServices",e.SLO="slo"}(n||(n={})),function(e){e.METRICS="metrics",e.SLO="slo"}(r||(r={})),function(e){e.Visual="visual",e.MQL="mql"}(o||(o={})),function(e){e.None="none",e.Rate="rate",e.Delta="delta"}(i||(i={})),function(e){e.METRIC_KIND_UNSPECIFIED="METRIC_KIND_UNSPECIFIED",e.GAUGE="GAUGE",e.DELTA="DELTA",e.CUMULATIVE="CUMULATIVE"}(s||(s={})),function(e){e.VALUE_TYPE_UNSPECIFIED="VALUE_TYPE_UNSPECIFIED",e.BOOL="BOOL",e.INT64="INT64",e.DOUBLE="DOUBLE",e.STRING="STRING",e.DISTRIBUTION="DISTRIBUTION",e.MONEY="MONEY"}(u||(u={})),function(e){e.ALIGN_DELTA="ALIGN_DELTA",e.ALIGN_RATE="ALIGN_RATE",e.ALIGN_INTERPOLATE="ALIGN_INTERPOLATE",e.ALIGN_NEXT_OLDER="ALIGN_NEXT_OLDER",e.ALIGN_MIN="ALIGN_MIN",e.ALIGN_MAX="ALIGN_MAX",e.ALIGN_MEAN="ALIGN_MEAN",e.ALIGN_COUNT="ALIGN_COUNT",e.ALIGN_SUM="ALIGN_SUM",e.ALIGN_STDDEV="ALIGN_STDDEV",e.ALIGN_COUNT_TRUE="ALIGN_COUNT_TRUE",e.ALIGN_COUNT_FALSE="ALIGN_COUNT_FALSE",e.ALIGN_FRACTION_TRUE="ALIGN_FRACTION_TRUE",e.ALIGN_PERCENTILE_99="ALIGN_PERCENTILE_99",e.ALIGN_PERCENTILE_95="ALIGN_PERCENTILE_95",e.ALIGN_PERCENTILE_50="ALIGN_PERCENTILE_50",e.ALIGN_PERCENTILE_05="ALIGN_PERCENTILE_05",e.ALIGN_PERCENT_CHANGE="ALIGN_PERCENT_CHANGE",e.ALIGN_NONE="ALIGN_NONE"}(c||(c={}))},15925:(e,t,a)=>{var l=a(29152),n=a(15521),r=a(68404),o=a(82897);var i=function(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}(r),s=function(){return s=Object.assign||function(e){for(var t,a=1,l=arguments.length;a<l;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},s.apply(this,arguments)};function u(e,t){var a="function"==typeof Symbol&&e[Symbol.iterator];if(!a)return e;var l,n,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(l=r.next()).done;)o.push(l.value)}catch(e){n={error:e}}finally{try{l&&!l.done&&(a=r.return)&&a.call(r)}finally{if(n)throw n.error}}return o}var c,d=["private_key","token_uri","client_email","project_id"],p=function(e){var t=e.onChange,a=u(r.useState(),2),l=a[0],o=a[1],s=u(r.useState(null),2),c=s[0],d=s[1],p=n.useTheme2(),m=r.useCallback((function(e){o(null),d(!0)}),[d]),v=r.useCallback((function(e){d(null),o(null)}),[d]),E=r.useCallback((function(e){if(""!==e.trim()){var a=void 0;try{a=JSON.parse(e)}catch(e){o("Invalid JWT token")}var l=h(a);l.isValid?t({privateKey:a.private_key,tokenUri:a.token_uri,clientEmail:a.client_email,projectId:a.project_id}):o(l.error)}}),[o,t]);return i.default.createElement(i.default.Fragment,null,i.default.createElement(n.Field,{label:"JWT token",invalid:Boolean(l),description:c?"Paste JWT token below":"Upload or paste Google JWT token",error:l},i.default.createElement(i.default.Fragment,null,!0!==c&&i.default.createElement("div",{"data-testid":"Configuration drop zone"},i.default.createElement(n.FileDropzone,{options:{multiple:!1,accept:"application/json"},readAs:"readAsText",onLoad:function(e){E(e),d(!1)}},i.default.createElement("p",{style:{margin:0,fontSize:""+p.typography.h4.fontSize,textAlign:"center"}},"Drop the Google JWT file here",i.default.createElement("br",null),i.default.createElement("br",null),i.default.createElement(n.LinkButton,{fill:"outline"},"Click to browse files")))),c&&i.default.createElement(n.TextArea,{"data-testid":"Configuration text area",autoFocus:!0,invalid:Boolean(l),placeholder:"Paste Google JWT token here",onBlur:function(e){return E(e.currentTarget.value)},rows:12}))),!c&&i.default.createElement(n.Field,null,i.default.createElement(n.Button,{"data-testid":"Paste JWT button",type:"button",fill:"outline",style:{color:""+p.colors.primary.text},onClick:m},"Paste JWT Token")),c&&l&&i.default.createElement(n.Field,null,i.default.createElement(n.Button,{type:"button",fill:"outline",style:{color:""+p.colors.primary.text},onClick:v},"Upload JWT Token")))},h=function(e){if(!o.isObject(e))return{isValid:!1,error:"Invalid JWT token"};var t=d.filter((function(t){return!e[t]}));return t.length>0?{isValid:!1,error:"Missing keys: "+t.join(", ")}:{isValid:!0}},m=function(e){var t=e.options,a=e.onReset,l=e.onChange;return i.default.createElement("div",{"data-testid":"JWT form"},i.default.createElement(n.Field,{label:"Project ID"},i.default.createElement(n.Input,{id:"defaultProject",width:60,value:t.defaultProject||"",onChange:l("defaultProject")})),i.default.createElement(n.Field,{label:"Client email"},i.default.createElement(n.Input,{width:60,id:"clientEmail",value:t.clientEmail||"",onChange:l("clientEmail")})),i.default.createElement(n.Field,{label:"Token URI"},i.default.createElement(n.Input,{width:60,id:"tokenUri",value:t.tokenUri||"",onChange:l("tokenUri")})),i.default.createElement(n.Field,{label:"Private key",disabled:!0},i.default.createElement(n.Input,{width:60,id:"privateKey",readOnly:!0,placeholder:"Private key configured",addonAfter:i.default.createElement(n.Tooltip,{content:"Click to clear the uploaded JWT token and upload a new one"},i.default.createElement(n.Button,{"data-testid":"Reset JWT button",icon:"sync",size:"xs",onClick:function(){return a(null)},fill:"outline"},"Reset token"))})))};t.GoogleAuthType=void 0,(c=t.GoogleAuthType||(t.GoogleAuthType={})).JWT="jwt",c.GCE="gce";var v=[{label:"Google JWT File",value:t.GoogleAuthType.JWT,ariaLabel:"JWT button"},{label:"GCE Default Service Account",value:t.GoogleAuthType.GCE,ariaLabel:"GCE button"}];t.ConnectionConfig=function(e){var a=e.options,r=e.onOptionsChange,o=a.jsonData,u=a.secureJsonFields,c=a.secureJsonData;o.authenticationType||(o.authenticationType=t.GoogleAuthType.JWT);var d=o.authenticationType===t.GoogleAuthType.JWT||void 0===o.authenticationType,h=Boolean(u&&u.privateKey&&o.clientEmail&&o.defaultProject&&o.tokenUri);return i.default.createElement(i.default.Fragment,null,i.default.createElement(n.FieldSet,{label:"Authentication"},i.default.createElement(n.Field,{label:"Authentication type"},i.default.createElement(n.RadioButtonGroup,{options:v,value:o.authenticationType||t.GoogleAuthType.JWT,onChange:function(e){r(s(s({},a),{jsonData:s(s({},a.jsonData),{authenticationType:e})}))}}))),d&&i.default.createElement(n.FieldSet,{label:"JWT Key Details"},h?i.default.createElement(m,{options:a.jsonData,onReset:function(e){var t=s({},c),l=e?s(s({},a.jsonData),e):s({},a.jsonData);delete l.clientEmail,delete l.defaultProject,delete l.tokenUri,delete t.privateKey,r(s(s({},a),{secureJsonData:t,jsonData:l}))},onChange:function(t){return l.onUpdateDatasourceJsonDataOption(e,t)}}):i.default.createElement(p,{onChange:function(e){r(s(s({},a),{secureJsonFields:s(s({},u),{privateKey:!0}),secureJsonData:s(s({},c),{privateKey:e.privateKey}),jsonData:s(s({},o),{clientEmail:e.clientEmail,defaultProject:e.projectId,tokenUri:e.tokenUri})}))}})," "),i.default.createElement("div",{className:"grafana-info-box",style:{marginTop:"16px"},"data-testid":"Configuration help box"},i.default.createElement("p",null,"Don’t know how to get a service account key file or create a service account? Read more"," ",i.default.createElement("a",{className:"external-link",target:"_blank",rel:"noopener noreferrer",href:"https://grafana.com/docs/grafana/latest/datasources/google-cloud-monitoring/google-authentication/"},"in the documentation."))),!d&&i.default.createElement(n.Alert,{title:"",severity:"info"},"Verify GCE default service account by clicking Save & Test"))}},28153:(e,t,a)=>{"use strict";e.exports=a(15925)}}]);
//# sourceMappingURL=9467.6e8232dddf2d5f7e525f.js.map