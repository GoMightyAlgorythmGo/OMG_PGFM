"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3549],{44141:(e,t,r)=>{r.r(t),r.d(t,{plugin:()=>he});var s,a,i,l,n,c,o,u,p,h,d,y,g,m,v,j,b,S,T,f,x,Q=r(12822),O=r(27549),L=r(68404),C=r(45916);class M extends L.PureComponent{render(){return(0,C.jsxs)("div",{children:[s||(s=(0,C.jsx)("h2",{children:"Cloud Monitoring alias patterns"})),(0,C.jsxs)("div",{children:[a||(a=(0,C.jsx)("p",{children:"Format the legend keys any way you want by using alias patterns. Format the legend keys any way you want by using alias patterns."})),"Example:",i||(i=(0,C.jsx)("code",{children:"{{metric.name}} - {{metric.label.instance_name}}"})),l||(l=(0,C.jsx)("br",{})),"Result:   ",n||(n=(0,C.jsx)("code",{children:"cpu/usage_time - server1-europe-west-1"})),c||(c=(0,C.jsx)("br",{})),o||(o=(0,C.jsx)("br",{})),u||(u=(0,C.jsx)("label",{children:"Patterns"})),p||(p=(0,C.jsx)("br",{})),(0,C.jsxs)("ul",{className:O.css`
              list-style: none;
            `,children:[h||(h=(0,C.jsxs)("li",{children:[(0,C.jsx)("code",{children:"{{metric.type}}"})," = metric type e.g. compute.googleapis.com/instance/cpu/usage_time"]})),d||(d=(0,C.jsxs)("li",{children:[(0,C.jsx)("code",{children:"{{metric.name}}"})," = name part of metric e.g. instance/cpu/usage_time"]})),y||(y=(0,C.jsxs)("li",{children:[(0,C.jsx)("code",{children:"{{metric.service}}"})," = service part of metric e.g. compute"]})),g||(g=(0,C.jsxs)("li",{children:[(0,C.jsx)("code",{children:"{{metric.label.label_name}}"})," = Metric label metadata e.g. metric.label.instance_name"]})),m||(m=(0,C.jsxs)("li",{children:[(0,C.jsx)("code",{children:"{{resource.label.label_name}}"})," = Resource label metadata e.g. resource.label.zone"]})),v||(v=(0,C.jsxs)("li",{children:[(0,C.jsx)("code",{children:"{{metadata.system_labels.name}}"})," = Meta data system labels e.g. metadata.system_labels.name. For this to work, the needs to be included in the group by"]})),j||(j=(0,C.jsxs)("li",{children:[(0,C.jsx)("code",{children:"{{metadata.user_labels.name}}"})," = Meta data user labels e.g. metadata.user_labels.name. For this to work, the needs to be included in the group by"]})),b||(b=(0,C.jsxs)("li",{children:[(0,C.jsx)("code",{children:"{{bucket}}"})," = bucket boundary for distribution metrics when using a heatmap in Grafana"]})),S||(S=(0,C.jsxs)("li",{children:[(0,C.jsx)("code",{children:"{{project}}"})," = The project name that was specified in the query editor"]})),T||(T=(0,C.jsxs)("li",{children:[(0,C.jsx)("code",{children:"{{service}}"})," = The service id that was specified in the SLO query editor"]})),f||(f=(0,C.jsxs)("li",{children:[(0,C.jsx)("code",{children:"{{slo}}"})," = The SLO id that was specified in the SLO query editor"]})),x||(x=(0,C.jsxs)("li",{children:[(0,C.jsx)("code",{children:"{{selector}}"})," = The Selector function that was specified in the SLO query editor"]}))]})]})]})}}var w=r(28153);class P extends L.PureComponent{render(){return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(w.ConnectionConfig,Object.assign({},this.props))})}}var N,R=r(79467),B=r(93921),E=r(2986),D=r(25576),F=r(30194);const q=["metricDescriptors","labels","metricTypes","services"];function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class V extends L.PureComponent{constructor(e){super(e),A(this,"queryTypes",[{value:D.Bp.Projects,label:"Projects"},{value:D.Bp.Services,label:"Services"},{value:D.Bp.MetricTypes,label:"Metric Types"},{value:D.Bp.LabelKeys,label:"Label Keys"},{value:D.Bp.LabelValues,label:"Label Values"},{value:D.Bp.ResourceTypes,label:"Resource Types"},{value:D.Bp.Aggregations,label:"Aggregations"},{value:D.Bp.Aligners,label:"Aligners"},{value:D.Bp.AlignmentPeriods,label:"Alignment Periods"},{value:D.Bp.Selectors,label:"Selectors"},{value:D.Bp.SLOServices,label:"SLO Services"},{value:D.Bp.SLO,label:"Service Level Objectives (SLO)"}]),A(this,"defaults",{selectedQueryType:this.queryTypes[0].value,metricDescriptors:[],selectedService:"",selectedMetricType:"",labels:[],labelKey:"",metricTypes:[],services:[],sloServices:[],selectedSLOService:"",projects:[],projectName:"",loading:!0}),A(this,"onPropsChange",(()=>{const e=function(e,t){if(null==e)return{};var r,s,a={},i=Object.keys(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)>=0||(a[r]=e[r]);return a}(this.state,q);this.props.onChange(Object.assign({},e,{refId:"CloudMonitoringVariableQueryEditor-VariableQuery"}))})),this.state=Object.assign(this.defaults,this.props.query)}async componentDidMount(){await this.props.datasource.ensureGCEDefaultProject();const e=this.props.datasource.getDefaultProject(),t=await this.props.datasource.getProjects(),r=await this.props.datasource.getMetricTypes(this.props.query.projectName||this.props.datasource.getDefaultProject()),s=(0,E.qA)(r).map((e=>({value:e.service,label:e.serviceShortName})));let a="";s.some((e=>e.value===(0,B.J)().replace(this.state.selectedService)))?a=this.state.selectedService:s&&s.length>0&&(a=s[0].value);const{metricTypes:i,selectedMetricType:l}=(0,E.FL)(r,this.state.selectedMetricType,(0,B.J)().replace(this.state.selectedMetricType),(0,B.J)().replace(a)),n=await this.props.datasource.getSLOServices(e),c=Object.assign({services:s,selectedService:a,metricTypes:i,selectedMetricType:l,metricDescriptors:r,projects:t},await this.getLabels(l,e),{sloServices:n,loading:!1,projectName:e});this.setState(c,(()=>this.onPropsChange()))}async onQueryTypeChange(e){const t=Object.assign({selectedQueryType:e},await this.getLabels(this.state.selectedMetricType,this.state.projectName,e));this.setState(t)}async onProjectChange(e){const t=await this.props.datasource.getMetricTypes(e),r=await this.getLabels(this.state.selectedMetricType,e),{metricTypes:s,selectedMetricType:a}=(0,E.FL)(t,this.state.selectedMetricType,(0,B.J)().replace(this.state.selectedMetricType),(0,B.J)().replace(this.state.selectedService)),i=await this.props.datasource.getSLOServices(e);this.setState(Object.assign({},r,{metricTypes:s,selectedMetricType:a,metricDescriptors:t,projectName:e,sloServices:i}),(()=>this.onPropsChange()))}async onServiceChange(e){const{metricTypes:t,selectedMetricType:r}=(0,E.FL)(this.state.metricDescriptors,this.state.selectedMetricType,(0,B.J)().replace(this.state.selectedMetricType),(0,B.J)().replace(e)),s=Object.assign({selectedService:e,metricTypes:t,selectedMetricType:r},await this.getLabels(r,this.state.projectName));this.setState(s,(()=>this.onPropsChange()))}async onMetricTypeChange(e){const t=Object.assign({selectedMetricType:e},await this.getLabels(e,this.state.projectName));this.setState(t,(()=>this.onPropsChange()))}onLabelKeyChange(e){this.setState({labelKey:e},(()=>this.onPropsChange()))}componentDidUpdate(e,t){const r=t.selectedQueryType!==this.state.selectedQueryType,s=this.state.selectedSLOService!==t.selectedSLOService;(r||s)&&this.onPropsChange()}async getLabels(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state.selectedQueryType,s={labels:this.state.labels,labelKey:this.state.labelKey};if(e&&r===D.Bp.LabelValues){const r=await(0,E.Qd)(this.props.datasource,e,t),a=r.some((e=>e===(0,B.J)().replace(this.state.labelKey)))?this.state.labelKey:r[0];s={labels:r,labelKey:a}}return s}renderQueryTypeSwitch(e){const t={label:"Template Variables",expanded:!1,options:(0,B.J)().getVariables().map((e=>({value:`$${e.name}`,label:`$${e.name}`})))};switch(e){case D.Bp.MetricTypes:return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(F.Th,{allowCustomValue:!0,value:this.state.projectName,options:[t,...this.state.projects],onChange:e=>this.onProjectChange(e),label:"Project"}),(0,C.jsx)(F.Th,{value:this.state.selectedService,options:[t,...this.state.services],onChange:e=>this.onServiceChange(e),label:"Service"})]});case D.Bp.LabelKeys:case D.Bp.LabelValues:case D.Bp.ResourceTypes:return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(F.Th,{allowCustomValue:!0,value:this.state.projectName,options:[t,...this.state.projects],onChange:e=>this.onProjectChange(e),label:"Project"}),(0,C.jsx)(F.Th,{value:this.state.selectedService,options:[t,...this.state.services],onChange:e=>this.onServiceChange(e),label:"Service"}),(0,C.jsx)(F.Th,{value:this.state.selectedMetricType,options:[t,...this.state.metricTypes.map((e=>{let{value:t,name:r}=e;return{value:t,label:r}}))],onChange:e=>this.onMetricTypeChange(e),label:"Metric Type"}),e===D.Bp.LabelValues&&(0,C.jsx)(F.Th,{value:this.state.labelKey,options:[t,...this.state.labels.map((e=>({value:e,label:e})))],onChange:e=>this.onLabelKeyChange(e),label:"Label Key"})]});case D.Bp.Aligners:case D.Bp.Aggregations:return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(F.Th,{value:this.state.selectedService,options:[t,...this.state.services],onChange:e=>this.onServiceChange(e),label:"Service"}),(0,C.jsx)(F.Th,{value:this.state.selectedMetricType,options:[t,...this.state.metricTypes.map((e=>{let{value:t,name:r}=e;return{value:t,label:r}}))],onChange:e=>this.onMetricTypeChange(e),label:"Metric Type"})]});case D.Bp.SLOServices:return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(F.Th,{allowCustomValue:!0,value:this.state.projectName,options:[t,...this.state.projects],onChange:e=>this.onProjectChange(e),label:"Project"})});case D.Bp.SLO:return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(F.Th,{allowCustomValue:!0,value:this.state.projectName,options:[t,...this.state.projects],onChange:e=>this.onProjectChange(e),label:"Project"}),(0,C.jsx)(F.Th,{value:this.state.selectedSLOService,options:[t,...this.state.sloServices],onChange:e=>{this.setState(Object.assign({},this.state,{selectedSLOService:e}))},label:"SLO Service"})]});default:return""}}render(){return this.state.loading?N||(N=(0,C.jsxs)("div",{className:"gf-form max-width-21",children:[(0,C.jsx)("span",{className:"gf-form-label width-10 query-keyword",children:"Query Type"}),(0,C.jsx)("div",{className:"gf-form-select-wrapper max-width-12",children:(0,C.jsx)("select",{className:"gf-form-input",children:(0,C.jsx)("option",{children:"Loading..."})})})]})):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(F.Th,{value:this.state.selectedQueryType,options:this.queryTypes,onChange:e=>this.onQueryTypeChange(e),label:"Query Type"}),this.renderQueryTypeSwitch(this.state.selectedQueryType)]})}}var I,K=r(82897),k=r(58799),G=r(71808),_=r(94396),$=r(71114),U=r(35778),J=r(13924),z=r(6932),H=r(45753),Z=r(75478),W=r(7166),X=r(94255),Y=r(46196),ee=r(68522),te=r(1652),re=r(80425);const se=e=>{var t;const{datasource:r,query:s,onRunQuery:a,data:i,onChange:l}=e,n=null!=i&&i.series.length?null==i?void 0:i.series[0].meta:{},c=null!==(t=null==n?void 0:n.custom)&&void 0!==t?t:{},o=Object.assign({},(e=>({editorMode:D.je.Visual,projectName:e.getDefaultProject(),projects:[],metricType:"",filters:[],metricKind:D.lH.GAUGE,valueType:"",refId:"annotationQuery",title:"",text:"",labels:{},variableOptionGroup:{},variableOptions:[],query:"",crossSeriesReducer:"REDUCE_NONE",perSeriesAligner:D.CS.ALIGN_NONE,alignmentPeriod:"grafana-auto"}))(r),s.metricQuery),[u,p]=(0,L.useState)(o.title||""),[h,d]=(0,L.useState)(o.text||""),y={label:"Template Variables",options:r.getVariables().map(Y.E)};return(0,X.Z)((()=>{l(Object.assign({},s,{metricQuery:Object.assign({},o,{title:u})}))}),1e3,[u,l]),(0,X.Z)((()=>{l(Object.assign({},s,{metricQuery:Object.assign({},o,{text:h})}))}),1e3,[h,l]),(0,C.jsxs)(ee.EditorRows,{children:[(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(re.a1,{refId:s.refId,variableOptionGroup:y,customMetaData:c,onChange:e=>l(Object.assign({},s,{metricQuery:e})),onRunQuery:a,datasource:r,query:o}),(0,C.jsx)(ee.EditorField,{label:"Title",htmlFor:"annotation-query-title",children:(0,C.jsx)(te.I,{id:"annotation-query-title",value:u,onChange:e=>{p(e.target.value)}})}),(0,C.jsx)(ee.EditorField,{label:"Text",htmlFor:"annotation-query-text",children:(0,C.jsx)(te.I,{id:"annotation-query-text",value:h,onChange:e=>{d(e.target.value)}})})]}),I||(I=(0,C.jsx)(F.zI,{}))]})};var ae=r(22002),ie=r(74184);class le{constructor(e){this.datasource=e}async execute(e){try{switch(e.projectName||(e.projectName=this.datasource.getDefaultProject()),e.selectedQueryType){case D.Bp.Projects:return this.handleProjectsQuery();case D.Bp.Services:return this.handleServiceQuery(e);case D.Bp.MetricTypes:return this.handleMetricTypesQuery(e);case D.Bp.LabelKeys:return this.handleLabelKeysQuery(e);case D.Bp.LabelValues:return this.handleLabelValuesQuery(e);case D.Bp.ResourceTypes:return this.handleResourceTypeQuery(e);case D.Bp.Aligners:return this.handleAlignersQuery(e);case D.Bp.AlignmentPeriods:return this.handleAlignmentPeriodQuery();case D.Bp.Aggregations:return this.handleAggregationQuery(e);case D.Bp.SLOServices:return this.handleSLOServicesQuery(e);case D.Bp.SLO:return this.handleSLOQuery(e);case D.Bp.Selectors:return this.handleSelectorQuery();default:return[]}}catch(t){return console.error(`Could not run CloudMonitoringMetricFindQuery ${e}`,t),[]}}async handleProjectsQuery(){return(await this.datasource.getProjects()).map((e=>({text:e.label,value:e.value,expandable:!0})))}async handleServiceQuery(e){let{projectName:t}=e;const r=await this.datasource.getMetricTypes(t);return(0,E.qA)(r).map((e=>({text:e.serviceShortName,value:e.service,expandable:!0})))}async handleMetricTypesQuery(e){let{selectedService:t,projectName:r}=e;if(!t)return[];const s=await this.datasource.getMetricTypes(r);return(0,E.Qf)(s,this.datasource.templateSrv.replace(t)).map((e=>({text:e.displayName,value:e.type,expandable:!0})))}async handleLabelKeysQuery(e){let{selectedMetricType:t,projectName:r}=e;if(!t)return[];return(await(0,E.Qd)(this.datasource,t,r)).map(this.toFindQueryResult)}async handleLabelValuesQuery(e){let{selectedMetricType:t,labelKey:r,projectName:s}=e;if(!t)return[];const a=await this.datasource.getLabels(t,"handleLabelValuesQuery",s,{groupBys:[r],crossSeriesReducer:"REDUCE_MEAN"}),i=this.datasource.templateSrv.replace(r);return(a.hasOwnProperty(i)?a[i]:[]).map(this.toFindQueryResult)}async handleResourceTypeQuery(e){var t,r;let{selectedMetricType:s,projectName:a}=e;if(!s)return[];return null!==(t=null===(r=(await this.datasource.getLabels(s,"handleResourceTypeQueryQueryType",a))["resource.type"])||void 0===r?void 0:r.map(this.toFindQueryResult))&&void 0!==t?t:[]}async handleAlignersQuery(e){let{selectedMetricType:t,projectName:r}=e;if(!t)return[];const s=(await this.datasource.getMetricTypes(r)).find((e=>e.type===this.datasource.templateSrv.replace(t)));return s?(0,E.oU)(s.valueType,s.metricKind).map(this.toFindQueryResult):[]}async handleAggregationQuery(e){let{selectedMetricType:t,projectName:r}=e;if(!t)return[];const s=(await this.datasource.getMetricTypes(r)).find((e=>e.type===this.datasource.templateSrv.replace(t)));return s?(0,E.A_)(s.valueType,s.metricKind).map(this.toFindQueryResult):[]}async handleSLOServicesQuery(e){let{projectName:t}=e;return(await this.datasource.getSLOServices(t)).map(this.toFindQueryResult)}async handleSLOQuery(e){let{selectedSLOService:t,projectName:r}=e;return(await this.datasource.getServiceLevelObjectives(r,t)).map(this.toFindQueryResult)}async handleSelectorQuery(){return ae.IR.map(this.toFindQueryResult)}handleAlignmentPeriodQuery(){return ae.dD.map(this.toFindQueryResult)}toFindQueryResult(e){return(0,K.isString)(e)?{text:e,expandable:!0}:Object.assign({},e,{expandable:!0})}}function ne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ce extends ie.Mg{constructor(e){super(),ne(this,"metricFindQuery",void 0),ne(this,"editor",V),this.datasource=e,this.metricFindQuery=new le(e),this.query=this.query.bind(this)}query(e){const t=(0,_.D)(this.metricFindQuery.execute(e.targets[0]));return(0,_.D)(this.datasource.ensureGCEDefaultProject()).pipe((0,$.z)((()=>t)),(0,U.U)((e=>({data:e}))))}}const oe=["hide","refId","datasource","key","queryType","maxLines","metric","intervalMs","type"];function ue(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class pe extends J.CK{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,W.J)(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,Z.$t)();var s;super(e),ue(this,"authenticationType",void 0),ue(this,"intervalMs",void 0),this.instanceSettings=e,this.templateSrv=t,this.timeSrv=r,this.authenticationType=e.jsonData.authenticationType||"jwt",this.variables=new ce(this),this.intervalMs=0,this.annotations=(s=this,{prepareAnnotation:e=>{if(!(e=>{var t,r;return void 0!==(null===(t=e.target)||void 0===t?void 0:t.title)||void 0!==(null===(r=e.target)||void 0===r?void 0:r.text)})(e))return e;const{enable:t,name:r,iconColor:a}=e,{target:i}=e;return{datasource:e.datasource,enable:t,name:r,iconColor:a,target:{intervalMs:s.intervalMs,refId:(null==i?void 0:i.refId)||"annotationQuery",type:"annotationQuery",queryType:D.xL.METRICS,metricQuery:{projectName:(null==i?void 0:i.projectName)||s.getDefaultProject(),editorMode:D.je.Visual,metricType:(null==i?void 0:i.metricType)||"",filters:(null==i?void 0:i.filters)||[],metricKind:(null==i?void 0:i.metricKind)||D.lH.GAUGE,query:"",crossSeriesReducer:"REDUCE_NONE",perSeriesAligner:D.CS.ALIGN_NONE,title:(null==i?void 0:i.title)||"",text:(null==i?void 0:i.text)||""}}}},prepareQuery:e=>{if(e.target)return Object.assign({},e.target,{queryType:D.xL.METRICS,type:"annotationQuery",metricQuery:Object.assign({},e.target.metricQuery)})},QueryEditor:se})}getVariables(){return this.templateSrv.getVariables().map((e=>`$${e.name}`))}query(e){return e.targets=e.targets.map((t=>Object.assign({},this.migrateQuery(t),{intervalMs:e.intervalMs}))),super.query(e)}applyTemplateVariables(e,t){const{metricQuery:r,sloQuery:s}=e;return Object.assign({},e,{datasource:this.getRef(),intervalMs:this.intervalMs,metricQuery:Object.assign({},this.interpolateProps(r,t),{projectName:this.templateSrv.replace(r.projectName?r.projectName:this.getDefaultProject(),t),filters:this.interpolateFilters(r.filters||[],t),groupBys:this.interpolateGroupBys(r.groupBys||[],t),view:r.view||"FULL",editorMode:r.editorMode}),sloQuery:s&&this.interpolateProps(s,t)})}async getLabels(e,t,r,s){var a;const i={targets:[{refId:t,datasource:this.getRef(),queryType:D.xL.METRICS,metricQuery:{projectName:this.templateSrv.replace(r),metricType:this.templateSrv.replace(e),groupBys:this.interpolateGroupBys((null==s?void 0:s.groupBys)||[],{}),crossSeriesReducer:null!==(a=null==s?void 0:s.crossSeriesReducer)&&void 0!==a?a:"REDUCE_NONE",view:"HEADERS"}}],range:this.timeSrv.timeRange()},l=i.targets;return l.length?(0,k.n)((0,_.D)(this.ensureGCEDefaultProject()).pipe((0,$.z)((()=>(0,z.i)().fetch({url:"/api/ds/query",method:"POST",data:{from:i.range.from.valueOf().toString(),to:i.range.to.valueOf().toString(),queries:l}}))),(0,U.U)((e=>{let{data:t}=e;const r=(0,H.z1)({data:t}),s=null==r?void 0:r.data.map((e=>{var t,r;return null===(t=e.meta)||void 0===t||null===(r=t.custom)||void 0===r?void 0:r.labels})).filter((e=>!!e)).reduce(((e,t)=>{for(let r in t)e[r]||(e[r]=new Set),t[r]&&e[r].add(t[r]);return e}),{});return Object.fromEntries(Object.entries(s).map((e=>(e[1]=Array.from(e[1]),e))))})))):(0,k.n)((0,G.of)({results:[]}))}async getGCEDefaultProject(){return this.getResource("gceDefaultProject")}getDefaultProject(){const{defaultProject:e,authenticationType:t,gceDefaultProject:r}=this.instanceSettings.jsonData;return"gce"===t?r||"":e||""}async ensureGCEDefaultProject(){const{authenticationType:e,gceDefaultProject:t}=this.instanceSettings.jsonData;"gce"!==e||t||(this.instanceSettings.jsonData.gceDefaultProject=await this.getGCEDefaultProject())}async getMetricTypes(e){return e?this.getResource(`metricDescriptors/v3/projects/${this.templateSrv.replace(e)}/metricDescriptors`):[]}async getSLOServices(e){return this.getResource(`services/v3/projects/${this.templateSrv.replace(e)}/services?pageSize=1000`)}async getServiceLevelObjectives(e,t){if(!t)return Promise.resolve([]);let{projectName:r,serviceId:s}=this.interpolateProps({projectName:e,serviceId:t});return this.getResource(`slo-services/v3/projects/${r}/services/${s}/serviceLevelObjectives`)}getProjects(){return this.getResource("projects")}migrateQuery(e){if(!e.hasOwnProperty("metricQuery")){const t=e,{hide:r,refId:s,intervalMs:a,type:i}=t,l=function(e,t){if(null==e)return{};var r,s,a={},i=Object.keys(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)>=0||(a[r]=e[r]);return a}(t,oe);return{refId:s,intervalMs:a,type:i,hide:r,queryType:D.xL.METRICS,metricQuery:Object.assign({},l,{view:l.view||"FULL"})}}return e}interpolateProps(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.entries(e).reduce(((e,r)=>{let[s,a]=r;return Object.assign({},e,{[s]:a&&(0,K.isString)(a)?this.templateSrv.replace(a,t):a})}),{})}filterQuery(e){if(e.hide)return!1;if(e.queryType&&e.queryType===D.xL.SLO&&e.sloQuery){const{selectorName:t,serviceId:r,sloId:s,projectName:a,lookbackPeriod:i}=e.sloQuery;return!(!t||!r||!s||!a||t===ae.Fh&&!i)}if(e.queryType&&e.queryType===D.xL.METRICS&&e.metricQuery.editorMode===D.je.MQL)return!!e.metricQuery.projectName&&!!e.metricQuery.query;const{metricType:t}=e.metricQuery;return!!t}interpolateVariablesInQueries(e,t){return e.map((e=>this.applyTemplateVariables(this.migrateQuery(e),t)))}interpolateFilters(e,t){const r=(0,K.chunk)(e,4).map((e=>{let[t,r,s,a]=e;return Object.assign({key:t,operator:r,value:s},a&&{condition:a})})).filter((e=>e.value));return(0,K.flatten)(r.map((e=>{let{key:r,operator:s,value:a,condition:i}=e;return[this.templateSrv.replace(r,t||{}),s,this.templateSrv.replace(a,t||{},(e=>(0,K.isArray)(e)&&e.length?`(${e.join("|")})`:e)),...i?[i]:[]]})))||[]}interpolateGroupBys(e,t){let r=[];return(e||[]).forEach((e=>{const s=this.templateSrv.replace(e,t||{},"csv").split(",");Array.isArray(s)?r=r.concat(s):r.push(s)})),r}}const he=new Q.hf(pe).setQueryEditorHelp(M).setQueryEditor(R.W).setConfigEditor(P).setVariableQueryEditor(V)}}]);
//# sourceMappingURL=cloudMonitoringPlugin.d6634f1059eb01d390e7.js.map