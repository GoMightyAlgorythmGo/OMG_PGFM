"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[1324],{75678:(e,n,r)=>{r.d(n,{Kd:()=>i,Zo:()=>u});var a=r(82897),t=r(68404),s=r(19462),l=r(86647),o=r(33899);function u(e){const n=(0,o._)((e=>e.promRules)),r=(0,o._)((e=>e.rulerRules)),a=(0,t.useRef)({}),u=(0,t.useMemo)((()=>{if(e){const n=(0,s.o_)(e);if(!n)throw new Error(`Unknown rules source: ${e}`);return[n]}return(0,s.h_)()}),[e]);return(0,t.useMemo)((()=>u.map((e=>{var t,o;const u=(0,s.jq)(e)?e.name:e,i=null===(t=n[u])||void 0===t?void 0:t.result,m=null===(o=r[u])||void 0===o?void 0:o.result,g=a.current[u];if(g&&g.promRules===i&&g.rulerRules===m)return g.result;const p={};Object.entries(m||{}).forEach((n=>{let[r,a]=n;const t={rulesSource:e,name:r,groups:[]};p[r]=t,function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e.groups=n.map((n=>{const r={name:n.name,interval:n.interval,source_tenants:n.source_tenants,rules:[]};return r.rules=n.rules.map((n=>c(n,e,r))),r}))}(t,a)})),null==i||i.forEach((n=>{let{name:r,groups:a}=n;!function(e,n){const r=new Map;e.groups.forEach((e=>r.set(e.name,e))),n.forEach((n=>{var a;let t=r.get(n.name);t||(t={name:n.name,rules:[]},e.groups.push(t),r.set(n.name,t));const o=new Map;t.rules.forEach((e=>{const n=o.get(e.name);n?n.push(e):o.set(e.name,[e])})),(null!==(a=n.rules)&&void 0!==a?a:[]).forEach((n=>{const r=function(e,n,r){const a=n.get(e.name);if(!a)return;if((0,s.HY)(r))return a[0];const t=a.find((n=>!n.promRule&&d(n,e,!0)));if(t)return t;const l=a.find((n=>!n.promRule&&d(n,e,!1)));if(l)return l;return}(n,o,e.rulesSource);r?r.promRule=n:t.rules.push(function(e,n,r){return{name:e.name,query:e.query,labels:e.labels||{},annotations:(0,l.x_)(e)&&e.annotations||{},promRule:e,namespace:n,group:r}}(n,e,t))}))}))}(p[r]=p[r]||{rulesSource:e,name:r,groups:[]},a)}));const f=Object.values(p);return a.current[u]={promRules:i,rulerRules:m,result:f},f})).flat()),[n,r,u])}function i(e){return e.map((e=>{const n=Object.assign({},e,{groups:[]});var r;return n.groups.push({name:"default",rules:(r=e.groups.flatMap((e=>e.rules)),r.sort(((e,n)=>e.name.localeCompare(n.name))))}),n}))}function c(e,n,r){return(0,l.cG)(e)?{name:e.alert,query:e.expr,labels:e.labels||{},annotations:e.annotations||{},rulerRule:e,namespace:n,group:r}:(0,l.yF)(e)?{name:e.record,query:e.expr,labels:e.labels||{},annotations:{},rulerRule:e,namespace:n,group:r}:{name:e.grafana_alert.title,query:"",labels:e.labels||{},annotations:e.annotations||{},rulerRule:e,namespace:n,group:r}}function d(e,n){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e.name===n.name&&(0,a.isEqual)([r?m(e.query):"",e.labels,e.annotations],[r?m(n.query):"",n.labels||{},(0,l.x_)(n)&&n.annotations||{}])}function m(e){return e.length>1&&"("===e[0]&&")"===e[e.length-1]&&(e=e.slice(1,-1)),(e=e.replace(/\s|\n/g,"")).split("").sort().join("")}},28410:(e,n,r)=>{r.d(n,{j:()=>l});var a=r(68404),t=r(70356),s=r(98712);function l(){const{search:e}=(0,t.TH)();return[(0,a.useMemo)((()=>new URLSearchParams(e)),[e]),(0,a.useCallback)(((e,n)=>{s.E1.partial(e,n)}),[])]}},95766:(e,n,r)=>{r.r(n),r.d(n,{default:()=>I});var a,t,s=r(68404),l=r(66015),o=r(90894),u=r(8674),i=r(47570),c=r(27549),d=r(82897),m=r(94255),g=r(68522),p=r(9617),f=r(74819),h=r(61884),b=r(24085),v=r(11340),j=r(58760),x=r(12396),w=r(65747),S=r(65184),R=r(75678),y=r(72965),C=r(28410),F=r(83809),N=r(82139),O=r(19462),Z=r(39357),k=r(45916);!function(e){e.Ascending="alpha-asc",e.Descending="alpha-desc"}(t||(t={}));const A=[{label:"Alphabetically [A-Z]",value:t.Ascending},{label:"Alphabetically [Z-A]",value:t.Descending}],q=e=>{var n;let{folder:r}=e;const l=(0,p.wW)(P),o=(0,i.I0)(),u=e=>{const n=(0,N.Zh)(_),r=(0,N.tC)(e),a=(0,d.uniqWith)([...n,r],d.isEqual),t=(0,N.oI)(a);M(t)};(0,s.useEffect)((()=>{o((0,F.y6)({rulesSourceName:O.GC})),o((0,F.UR)({rulesSourceName:O.GC}))}),[o]);const c=(0,R.Zo)(O.GC),{nameFilter:q,labelFilter:_,sortOrder:L,setNameFilter:I,setLabelFilter:M,setSortOrder:$}=function(){var e,n;const[r,a]=(0,C.j)(),[l,o]=(0,s.useState)(null!==(e=r.get(E.nameFilter))&&void 0!==e?e:""),[u,i]=(0,s.useState)(null!==(n=r.get(E.labelFilter))&&void 0!==n?n:""),c=r.get(E.sortOrder),[d,g]=(0,s.useState)(c===t.Ascending?t.Ascending:c===t.Descending?t.Descending:void 0);return(0,m.Z)((()=>a({[E.nameFilter]:(0,S.sB)(l),[E.labelFilter]:(0,S.sB)(u),[E.sortOrder]:(0,S.sB)(d)},!0)),400,[l,u,d]),{nameFilter:l,labelFilter:u,sortOrder:d,setNameFilter:o,setLabelFilter:i,setSortOrder:g}}(),D=c.find((e=>e.name===r.title)),H=null!==(n=null==D?void 0:D.groups.flatMap((e=>e.rules)))&&void 0!==n?n:[],B=function(e,n,r,a){const s=(0,N.Zh)(r);let l=e.filter((e=>e.name.toLowerCase().includes(n.toLowerCase())&&(0,N.eD)(e.labels,s)));return(0,d.orderBy)(l,(e=>e.name.toLowerCase()),[a===t.Ascending?"asc":"desc"])}(H,q,_,null!=L?L:t.Ascending),G=0===H.length||0===B.length,{page:T,numberOfPages:U,onPageChange:W,pageItems:J}=(0,y.h)(B,1,w.gN);return(0,k.jsx)("div",{className:l.container,children:(0,k.jsxs)(g.Stack,{direction:"column",gap:3,children:[(0,k.jsx)(f.H,{value:q,onChange:I,placeholder:"Search alert rules by name","data-testid":"name-filter"}),(0,k.jsxs)(g.Stack,{direction:"row",children:[(0,k.jsx)(h.Ph,{value:L,onChange:e=>{let{value:n}=e;return n&&$(n)},options:A,width:25,"aria-label":"Sort",placeholder:"Sort (Default A-Z)",prefix:(0,k.jsx)(b.J,{name:L===t.Ascending?"sort-amount-up":"sort-amount-down"})}),(0,k.jsx)(f.H,{value:_,onChange:M,placeholder:"Search alerts by labels",className:l.filterLabelsInput,"data-testid":"label-filter"})]}),(0,k.jsx)(g.Stack,{gap:1,children:J.map((e=>(0,k.jsxs)(v.Z,{href:(0,Z.V2)("grafana",e,""),className:l.card,"data-testid":"alert-card-row",children:[(0,k.jsx)(v.Z.Heading,{children:e.name}),(0,k.jsx)(v.Z.Tags,{children:(0,k.jsx)(j.P,{onClick:u,tags:Object.entries(e.labels).map((e=>{let[n,r]=e;return`${n}=${r}`}))})}),(0,k.jsx)(v.Z.Meta,{children:(0,k.jsxs)("div",{children:[a||(a=(0,k.jsx)(b.J,{name:"folder"}))," ",r.title]})})]},e.name)))}),G&&(0,k.jsx)("div",{className:l.noResults,children:"No alert rules found"}),(0,k.jsx)("div",{className:l.pagination,children:(0,k.jsx)(x.t,{currentPage:T,numberOfPages:U,onNavigate:W,hideWhenSinglePage:!0})})]})})};var E;!function(e){e.nameFilter="nameFilter",e.labelFilter="labelFilter",e.sortOrder="sort"}(E||(E={}));const P=e=>({container:c.css`
    padding: ${e.spacing(1)};
  `,card:c.css`
    grid-template-columns: auto 1fr 2fr;
    margin: 0;
  `,pagination:c.css`
    align-self: center;
  `,filterLabelsInput:c.css`
    flex: 1;
    width: auto;
    min-width: 240px;
  `,noResults:c.css`
    padding: ${e.spacing(2)};
    background-color: ${e.colors.background.secondary};
    font-style: italic;
  `});var _=r(87413),L=r(49545);const I=e=>{let{match:n}=e;const r=(0,i.I0)(),a=(0,i.v9)((e=>e.navIndex)),t=(0,i.v9)((e=>e.folder)),s=n.params.uid,c=(0,u.h)(a,`folder-alerting-${s}`,(0,L._)(1)),{loading:d}=(0,l.Z)((async()=>r((0,_.Pb)(s))),[_.Pb,s]);return(0,k.jsx)(o.T,{navId:"dashboards/browse",pageNav:c.main,children:(0,k.jsx)(o.T.Contents,{isLoading:d,children:(0,k.jsx)(q,{folder:t})})})}}}]);
//# sourceMappingURL=FolderAlerting.17ebc86642c8b65e2009.js.map