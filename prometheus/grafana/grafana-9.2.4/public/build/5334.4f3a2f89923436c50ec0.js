(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[5334],{17966:(e,t,i)=>{"use strict";i.d(t,{F:()=>a});var s=i(60699),r=i(11277),n=i(53373);function a(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"=";if(!t||!i)throw new Error("Need label to add to query.");const r=o(e);if(!r.length)return e;const n=l(t,i,s);return h(e,r,n)}function o(e){const t=s.E2.parse(e),i=[];return t.iterate({enter:t=>{let{to:r,from:a,type:o}=t;if(o.id===s.m6){const t=(0,n._)(e.substring(a,r));return i.push({query:t.query,from:a,to:r}),!1}}}),i}function l(e,t,i){return{label:e,op:i,value:t===1/0?"+Inf":t.toString()}}function h(e,t,i){const s=new r.K;let n="",a=0;for(let r=0;r<t.length;r++){const o=t[r],l=r===t.length-1,h=e.substring(a,o.from),c=l?e.substring(o.to):"";u(o.query.labels,i)||o.query.labels.push(i);n+=h+s.renderQuery(o.query)+c,a=o.to}return n}function u(e,t){return e.find((e=>e.label===t.label&&e.value===t.value))}},65161:(e,t,i)=>{"use strict";i.d(t,{UQ:()=>v,ZK:()=>m,ZP:()=>b});var s=i(82897),r=i(20707),n=i.n(r),a=i(57706),o=i.n(a),l=i(91115),h=i(12822),u=i(12901),c=i(39405),d=i(82777),p=i(85548);function f(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const g=["job","instance"],m=1e4,y=e=>({label:e}),O=e=>(e.kind="function",e);function v(e,t){if(!t[e])return;const{type:i,help:s}=t[e];return`${i.toUpperCase()}: ${s}`}const x=/(="|!="|=~"|!~"|\{|\[|\(|\+|-|\/|\*|%|\^|\band\b|\bor\b|\bunless\b|==|>=|!=|<=|>|<|=|~|,)/;class b extends h.iL{constructor(e,t){var i;super(),i=this,f(this,"histogramMetrics",void 0),f(this,"timeRange",void 0),f(this,"metrics",void 0),f(this,"metricsMetadata",void 0),f(this,"datasource",void 0),f(this,"labelKeys",[]),f(this,"labelsCache",new(n())({max:10})),f(this,"request",(async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;try{return(await i.datasource.metadataRequest(e,s,r)).data.data}catch(e){console.error(e)}return t})),f(this,"start",(async()=>(this.datasource.lookupsDisabled||(await this.fetchLabels(),this.metrics=await this.fetchLabelValues("__name__")||[],await this.loadMetricsMetadata(),this.histogramMetrics=(0,d.NO)(this.metrics).sort()),[]))),f(this,"provideCompletionItems",(async function(e){let{prefix:t,text:s,value:r,labelKey:n,wrapperClasses:a}=e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const l={suggestions:[]};if(!r)return l;const h=0===r.document.text.length,u=r.document.getTextsAtRange(r.selection),c=1===u.size?u.first().getText():null,d=c?c[r.selection.anchor.offset]:null,p=a.length>3,f=t&&!p,g=!d||")"===d,m=t&&!s.match(/^[\]})\s]+$/)&&g,y=/[+\-*/^%]/,O=s.match(y);return a.includes("context-range")?i.getRangeCompletionItems():a.includes("context-labels")?i.getLabelCompletionItems({prefix:t,text:s,value:r,labelKey:n,wrapperClasses:a}):a.includes("context-aggregation")?i.getAggregationCompletionItems(r):h?i.getEmptyCompletionItems(o):f&&g&&!O?i.getBeginningCompletionItems(o):f&&m?i.getTermCompletionItems():l})),f(this,"getBeginningCompletionItems",(e=>({suggestions:[...this.getEmptyCompletionItems(e).suggestions,...this.getTermCompletionItems().suggestions]}))),f(this,"getEmptyCompletionItems",(e=>{const{history:t}=e,i=[];if(t&&t.length){const e=(0,s.chain)(t).map((e=>e.query.expr)).filter().uniq().take(5).map(y).map((e=>function(e,t){const i=Date.now()-864e5,s=t.filter((t=>t.ts>i&&t.query===e.label)),r=s.length,n=s[0];let a=`Queried ${r} times in the last 24h.`;n&&(a=`${a} Last queried ${(0,l.CQ)(n.ts).fromNow()}.`);return Object.assign({},e,{documentation:a})}(e,t))).value();i.push({searchFunctionType:c.Z.Prefix,skipSort:!0,label:"History",items:e})}return{suggestions:i}})),f(this,"getTermCompletionItems",(()=>{const{metrics:e,metricsMetadata:t}=this,i=[];return i.push({searchFunctionType:c.Z.Prefix,label:"Functions",items:p.r8.map(O)}),e&&e.length&&i.push({label:"Metrics",items:e.map((e=>function(e,t){const i={label:e};return t&&t[e]&&(i.documentation=v(e,t)),i}(e,t))),searchFunctionType:c.Z.Fuzzy}),{suggestions:i}})),f(this,"getAggregationCompletionItems",(async e=>{const t=[];let i;const s=e.document.getBlocks().reduce(((t,s)=>{if(void 0===t)return"";if(!s)return t;const r=null==s?void 0:s.getText();return e.anchorBlock.key===s.key&&(i=e.selection.anchor.offset+t.length),t+r}),""),r=s.lastIndexOf("(",i);let n=s.lastIndexOf("(",r-1),a=s.indexOf(")",n);if(-1===n){const e=s.indexOf(")",i);a=s.indexOf(")",e+1),n=s.lastIndexOf("(",a)}const o={suggestions:t,context:"context-aggregation"};if(-1===n)return o;const l=s.slice(n+1,a).replace(/\[[^\]]+\]$/,""),h=(0,d.rV)(l,l.length-2).selector,u=await this.getSeries(h),p=Object.keys(u);if(p.length>0){const e=(0,d.ZO)(p);t.push({label:`Labels${e}`,items:p.map(y),searchFunctionType:c.Z.Fuzzy})}return o})),f(this,"getLabelCompletionItems",(async e=>{let{text:t,wrapperClasses:i,labelKey:r,value:n}=e;if(!n)return{suggestions:[]};const a=[],o=n.anchorBlock.getText(),l=n.selection.anchor.offset,h=o.substr(l),u=o.substr(0,l),p=t.match(/^(=|=~|!=|!~)/),f=h.match(/^"?[,}]|$/),m=u.match(/(=|=~|!=|!~)$/)&&h.match(/^"/);if(!(p&&f)&&!(f&&!p)||m)return{suggestions:a};let O,v;try{v=(0,d.rV)(o,l),O=v.selector}catch{O="{}"}const x=O.includes("__name__="),b=v?v.labelKeys:[];let k,$={};if(O&&($=await this.getSeries(O,!x)),0===Object.keys($).length)return console.warn(`Server did not return any values for selector = ${O}`),{suggestions:a};if(t&&p||i.includes("attr-value")){if(r&&$[r]){k="context-label-values";const e=(0,d.ZO)($[r]);a.push({label:`Label values for "${r}"${e}`,items:$[r].map(y),searchFunctionType:c.Z.Fuzzy})}}else{const e=$?Object.keys($):x?null:g;if(e){const t=(0,s.difference)(e,b);if(t.length){k="context-labels";const e=t.map((e=>({label:e}))),i={label:`Labels${(0,d.ZO)(e)}`,items:e,searchFunctionType:c.Z.Fuzzy};a.push(i)}}}return{context:k,suggestions:a}})),f(this,"fetchLabelValues",(async e=>{const t=this.datasource.getTimeRangeParams(),i=`/api/v1/label/${this.datasource.interpolateString(e)}/values`;return await this.request(i,[],t)})),f(this,"fetchSeriesLabels",(async(e,t)=>{const i=this.datasource.interpolateString(e),s=this.datasource.getTimeRangeParams(),r=Object.assign({},s,{"match[]":i}),n=`/api/v1/series?${new URLSearchParams({"match[]":i,start:(0,d.s4)(parseInt(s.start,10)).toString(),end:(0,d.s4)(parseInt(s.end,10)).toString(),withName:t?"true":"false"}).toString()}`;let a=this.labelsCache.get(n);if(!a){const e=await this.request("/api/v1/series",[],r),{values:i}=(0,d.DY)(e,t);a=i,this.labelsCache.set(n,a)}return a})),f(this,"fetchSeries",(async e=>{const t=this.datasource.getTimeRangeParams(),i=Object.assign({},t,{"match[]":e});return await this.request("/api/v1/series",{},i)})),f(this,"fetchDefaultSeries",(0,s.once)((async()=>{const e=await Promise.all(g.map((e=>this.fetchLabelValues(e))));return g.reduce(((t,i,s)=>Object.assign({},t,{[i]:e[s]})),{})}))),this.datasource=e,this.histogramMetrics=[],this.timeRange={start:0,end:0},this.metrics=[],Object.assign(this,t)}cleanText(e){return e.split(x).pop().trimLeft().replace(/"$/,"").replace(/^"/,"")}get syntax(){return p.ZP}async loadMetricsMetadata(){this.metricsMetadata=(0,d.I4)(await this.request("/api/v1/metadata",{},{},{showErrorAlert:!1}))}getLabelKeys(){return this.labelKeys}getRangeCompletionItems(){return{context:"context-range",suggestions:[{label:"Range vector",items:[...p.Ty]}]}}importFromAbstractQuery(e){return(0,d.e5)(e)}exportToAbstractQuery(e){const t=e.expr;if(!t||0===t.length)return{refId:e.refId,labelMatchers:[]};const i=o().tokenize(t,p.ZP),s=(0,d.UO)(i),r=function(e,t){let i="";for(let e in t)if("string"==typeof t[e]){i=t[e];break}return i}(0,i);return r&&r.length>0&&s.push({name:"__name__",operator:u.K2.Equal,value:r}),{refId:e.refId,labelMatchers:s}}async getSeries(e,t){if(this.datasource.lookupsDisabled)return{};try{return"{}"===e?await this.fetchDefaultSeries():await this.fetchSeriesLabels(e,t)}catch(e){return console.error(e),{}}}async getLabelValues(e){return await this.fetchLabelValues(e)}async fetchLabels(){const e=this.datasource.getTimeRangeParams();this.labelFetchTs=Date.now().valueOf();const t=await this.request("/api/v1/labels",[],e);return Array.isArray(t)&&(this.labelKeys=t.slice().sort()),[]}}},82777:(e,t,i)=>{"use strict";i.d(t,{DY:()=>c,I4:()=>m,NO:()=>u,PL:()=>P,U9:()=>k,UO:()=>C,ZO:()=>x,e5:()=>S,ll:()=>g,o8:()=>y,rV:()=>f,s4:()=>O,tU:()=>$});var s=i(82897),r=i(57706),n=i(12901),a=i(17966),o=i(65161);const l=["__name__"];function h(e,t){if(null==e)return{};var i,s,r={},n=Object.keys(e);for(s=0;s<n.length;s++)i=n[s],t.indexOf(i)>=0||(r[i]=e[i]);return r}const u=e=>{const t=new Set,i=new RegExp("_bucket($|:)");for(let s=0;s<e.length;s++){const r=e[s];i.test(r)&&t.add(r)}return[...t]};function c(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i={};e.forEach((e=>{const{__name__:s}=e,r=h(e,l);t&&(i.__name__=i.__name__||new Set,i.__name__.has(s)||i.__name__.add(s)),Object.keys(r).forEach((e=>{i[e]||(i[e]=new Set),i[e].has(r[e])||i[e].add(r[e])}))}));const s={};return v(Object.keys(i)).forEach((e=>{s[e]=v(Array.from(i[e]))})),{values:s,keys:Object.keys(s)}}const d=/\{[^}]*?(\}|$)/,p=/\b(\w+)(!?=~?)("[^"\n]*?")/g;function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!e.match(d)){if(e.match(/^[A-Za-z:][\w:]*$/))return{selector:`{__name__="${e}"}`,labelKeys:["__name__"]};throw new Error("Query must contain a selector: "+e)}const i=e.slice(0,t),s=i.lastIndexOf("{"),r=i.lastIndexOf("}");if(-1===s)throw new Error("Not inside selector, missing open brace: "+i);if(r>-1&&r>s)throw new Error("Not inside selector, previous selector already closed: "+i);const n=e.slice(t),a=n.indexOf("}"),o=a+t,l=n.indexOf("{"),h=l+t;if(-1===o)throw new Error("Not inside selector, missing closing brace in suffix: "+n);if(l>-1&&h<o)throw new Error("Not inside selector, next selector opens before this one closed: "+n);const u=e.slice(s,o),c={};u.replace(p,((i,s,r,n)=>{const a=e.indexOf(i),o=a+s.length+r.length+1,l=a+s.length+r.length+n.length-1;return(t<o||t>l)&&(c[s]={value:n,operator:r}),""}));const f=e.slice(0,s),g=f.match(/[A-Za-z:][\w:]*$/);g&&(c.__name__={value:`"${g[0]}"`,operator:"="});const m=Object.keys(c).sort(),y=m.map((e=>`${e}${c[e].operator}${c[e].value}`)).join(","),O=["{",y,"}"].join("");return{labelKeys:m,selector:O}}function g(e,t){const i=Object.keys(t),s=new RegExp(`(\\s|^)(${i.join("|")})(\\s|$|\\(|\\[|\\{)`,"ig"),r=e.replace(s,((e,i,s,r)=>`${i}${t[s]}${r}`)).split(/(\+|\-|\*|\/|\%|\^)/),n=/(\)\{|\}\{|\]\{)/,o=r.map((e=>function(e,t){var i;const s=e.match(t);if(!s)return e;const r=null!==(i=s.index)&&void 0!==i?i:0,n=e.slice(0,r+1),o=e.slice(r+1),l=[];o.replace(p,((e,t,i,s)=>(l.push({key:t,operator:i,value:s}),"")));let h=n;return l.filter(Boolean).forEach((e=>{const t=e.value.slice(1,-1);h=(0,a.F)(h,e.key,t,e.operator)})),h}(e,n)));return o.join("")}function m(e){if(!e)return e;const t={},i={};for(const s in e){const r=e[s][0];t[s]=r,"histogram"===r.type&&(i[`${s}_bucket`]={type:"counter",help:`Cumulative counters for the observation buckets (${r.help})`},i[`${s}_count`]={type:"counter",help:`Count of events that have been observed for the histogram metric (${r.help})`},i[`${s}_sum`]={type:"counter",help:`Total sum of all observed values for the histogram metric (${r.help})`}),"summary"===r.type&&(i[`${s}_count`]={type:"counter",help:`Count of events that have been observed for the base metric (${r.help})`},i[`${s}_sum`]={type:"counter",help:`Total sum of all observed values for the base metric (${r.help})`})}const s={ALERTS:{type:"counter",help:"Time series showing pending and firing alerts. The sample value is set to 1 as long as the alert is in the indicated active (pending or firing) state."}};return Object.assign({},t,i,s)}function y(e){return O(e/1e3)}function O(e){return Math.floor(e/60)}function v(e){return e.slice(0,o.ZK)}function x(e){return e&&e.length>=o.ZK?`, limited to the first ${o.ZK} received items`:""}const b=/[*+?()|\\.\[\]{}^$]/g;function k(e){return e.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function $(e){return k(e.replace(b,"\\$&"))}const w={"=":n.K2.Equal,"!=":n.K2.NotEqual,"=~":n.K2.EqualRegEx,"!~":n.K2.NotEqualRegEx},_=(0,s.invert)(w);function P(e){const t=e.labelMatchers.map((e=>{const t=_[e.operator];return t?`${e.name}${t}"${e.value}"`:""})).filter((e=>""!==e)).join(", ");return t?`{${t}}`:""}function S(e){return{refId:e.refId,expr:P(e),range:!0}}function C(e){const t=[];for(let i in e)if(e[i]instanceof r.Token){let s=e[i];if("context-labels"===s.type){let e="",i="",n="",a=s.content;for(let s in a)if("string"==typeof a[s]){let e;e=a[s],"="!==e&&"!="!==e&&"=~"!==e&&"!~"!==e||(n=e)}else if(a[s]instanceof r.Token)switch(a[s].type){case"label-key":e=a[s].content;break;case"label-value":i=a[s].content,i=i.substring(1,i.length-1);const r=w[n];r&&t.push({name:e,operator:r,value:i})}}}return t}},11277:(e,t,i)=>{"use strict";i.d(t,{K:()=>v,Z:()=>x});var s=i(85548),r=i(8254),n=i(47908),a=i(19093),o=i(12524);function l(e){var t,i,s,r,n,l;return Object.assign({},e,{id:e.id,name:null!==(t=e.name)&&void 0!==t?t:(0,a.t7)(e.id),params:null!==(i=e.params)&&void 0!==i?i:[],defaultParams:null!==(s=e.defaultParams)&&void 0!==s?s:[],category:null!==(r=e.category)&&void 0!==r?r:o.C.Functions,renderer:null!==(n=e.renderer)&&void 0!==n?n:e.params?a.zJ:a.pS,addOperationHandler:null!==(l=e.addOperationHandler)&&void 0!==l?l:a.PP})}function h(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{id:e,name:(0,a.t7)(e),params:[(0,a.kq)(t)],defaultParams:[t?"$__rate_interval":"$__interval"],alternativesKey:"range function",category:o.C.RangeFunctions,renderer:c,addOperationHandler:d,changeTypeHandler:u}}function u(e,t){return("$__rate_interval"===e.params[0]&&"$__rate_interval"!==t.defaultParams[0]||"$__interval"===e.params[0]&&"$__interval"!==t.defaultParams[0])&&(e.params=t.defaultParams),e}function c(e,t,i){var s,r;let n=null!==(s=(null!==(r=e.params)&&void 0!==r?r:[])[0])&&void 0!==s?s:"5m";return`${t.id}(${i}[${n}])`}function d(e,t,i){const s={id:e.id,params:e.defaultParams};if(t.operations.length>0){if(i.getOperationDef(t.operations[0].id).addOperationHandler===d)return Object.assign({},t,{operations:[s,...t.operations.slice(1)]})}return Object.assign({},t,{operations:[s,...t.operations]})}function p(e,t){var i;return Object.assign({},t,{binaryQueries:[...null!==(i=t.binaryQueries)&&void 0!==i?i:[],{operator:"/",query:t}]})}function f(e,t,i){if("string"!=typeof e.params[1])throw"The separator must be a string";const s=`"${e.params[1]}"`;return`${e.id}(${i}, "${e.params[0]}", ${s}, "${e.params.slice(2).join(s)}")`}function g(e,t){const i={id:e.id,params:e.defaultParams};return Object.assign({},t,{operations:[...t.operations,i]})}function m(e){return{id:e,name:(0,a.t7)(e),params:[(0,a.kq)()],defaultParams:["$__interval"],alternativesKey:"overtime function",category:o.C.RangeFunctions,renderer:y,addOperationHandler:d}}function y(e,t,i){var s,r;let n=null!==(s=(null!==(r=e.params)&&void 0!==r?r:[])[0])&&void 0!==s?s:"$__interval";return`${t.id}(${i}[${n}])`}var O=i(37393);class v extends O.x{constructor(){super((()=>{const e=[{id:o.G.HistogramQuantile,name:"Histogram quantile",params:[{name:"Quantile",type:"number",options:[.99,.95,.9,.75,.5,.25]}],defaultParams:[.9],category:o.C.Functions,renderer:a.pS,addOperationHandler:a.PP},{id:o.G.LabelReplace,name:"Label replace",params:[{name:"Destination label",type:"string"},{name:"Replacement",type:"string"},{name:"Source label",type:"string"},{name:"Regex",type:"string"}],category:o.C.Functions,defaultParams:["","$1","","(.*)"],renderer:a.zJ,addOperationHandler:a.PP},{id:o.G.Ln,name:"Ln",params:[],defaultParams:[],category:o.C.Functions,renderer:a.pS,addOperationHandler:a.PP},h(o.G.Changes),h(o.G.Rate,!0),h(o.G.Irate),h(o.G.Increase,!0),h(o.G.Idelta),h(o.G.Delta),l({id:o.G.HoltWinters,params:[(0,a.kq)(),{name:"Smoothing Factor",type:"number"},{name:"Trend Factor",type:"number"}],defaultParams:["$__interval",.5,.5],alternativesKey:"range function",category:o.C.RangeFunctions,renderer:a.e8,addOperationHandler:d,changeTypeHandler:u}),l({id:o.G.PredictLinear,params:[(0,a.kq)(),{name:"Seconds from now",type:"number"}],defaultParams:["$__interval",60],alternativesKey:"range function",category:o.C.RangeFunctions,renderer:a.e8,addOperationHandler:d,changeTypeHandler:u}),l({id:o.G.QuantileOverTime,params:[(0,a.kq)(),{name:"Quantile",type:"number"}],defaultParams:["$__interval",.5],alternativesKey:"overtime function",category:o.C.RangeFunctions,renderer:a.NZ,addOperationHandler:d,changeTypeHandler:u}),...r.EX,{id:o.G.NestedQuery,name:"Binary operation with query",params:[],defaultParams:[],category:o.C.BinaryOps,renderer:(e,t,i)=>i,addOperationHandler:p},l({id:o.G.Absent}),l({id:o.G.Acos,category:o.C.Trigonometric}),l({id:o.G.Acosh,category:o.C.Trigonometric}),l({id:o.G.Asin,category:o.C.Trigonometric}),l({id:o.G.Asinh,category:o.C.Trigonometric}),l({id:o.G.Atan,category:o.C.Trigonometric}),l({id:o.G.Atanh,category:o.C.Trigonometric}),l({id:o.G.Ceil}),l({id:o.G.Clamp,name:"Clamp",params:[{name:"Minimum Scalar",type:"number"},{name:"Maximum Scalar",type:"number"}],defaultParams:[1,1]}),l({id:o.G.ClampMax,params:[{name:"Maximum Scalar",type:"number"}],defaultParams:[1]}),l({id:o.G.ClampMin,params:[{name:"Minimum Scalar",type:"number"}],defaultParams:[1]}),l({id:o.G.Cos,category:o.C.Trigonometric}),l({id:o.G.Cosh,category:o.C.Trigonometric}),l({id:o.G.DayOfMonth,category:o.C.Time}),l({id:o.G.DayOfWeek,category:o.C.Time}),l({id:o.G.DaysInMonth,category:o.C.Time}),l({id:o.G.Deg}),h(o.G.Deriv),l({id:o.G.Exp}),l({id:o.G.Floor}),l({id:o.G.Group}),l({id:o.G.Hour}),l({id:o.G.LabelJoin,params:[{name:"Destination Label",type:"string",editor:n.g},{name:"Separator",type:"string"},{name:"Source Label",type:"string",restParam:!0,optional:!0,editor:n.g}],defaultParams:["",",",""],renderer:f,addOperationHandler:g}),l({id:o.G.Log10}),l({id:o.G.Log2}),l({id:o.G.Minute}),l({id:o.G.Month}),l({id:o.G.Pi,renderer:e=>`${e.id}()`}),l({id:o.G.Quantile,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:a.pS}),l({id:o.G.Rad}),h(o.G.Resets),l({id:o.G.Round,category:o.C.Functions,params:[{name:"To Nearest",type:"number"}],defaultParams:[1]}),l({id:o.G.Scalar}),l({id:o.G.Sgn}),l({id:o.G.Sin,category:o.C.Trigonometric}),l({id:o.G.Sinh,category:o.C.Trigonometric}),l({id:o.G.Sort}),l({id:o.G.SortDesc}),l({id:o.G.Sqrt}),l({id:o.G.Stddev}),l({id:o.G.Tan,category:o.C.Trigonometric}),l({id:o.G.Tanh,category:o.C.Trigonometric}),l({id:o.G.Time,renderer:e=>`${e.id}()`}),l({id:o.G.Timestamp}),l({id:o.G.Vector,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:e=>`${e.id}(${e.params[0]})`}),l({id:o.G.Year}),...(0,a.IT)(o.G.Sum),...(0,a.IT)(o.G.Avg),...(0,a.IT)(o.G.Min),...(0,a.IT)(o.G.Max),...(0,a.IT)(o.G.Count),...(0,a.Z3)(o.G.TopK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,a.Z3)(o.G.BottomK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,a.Z3)(o.G.CountValues,{params:[{name:"Identifier",type:"string"}],defaultParams:["count"]}),m(o.G.SumOverTime),m(o.G.AvgOverTime),m(o.G.MinOverTime),m(o.G.MaxOverTime),m(o.G.CountOverTime),m(o.G.LastOverTime),m(o.G.PresentOverTime),m(o.G.AbsentOverTime),m(o.G.StddevOverTime)];for(const t of e){const e=s.r8.find((e=>e.insertText===t.id));e&&(t.documentation=e.documentation)}return e})),this.setOperationCategories([o.C.Aggregations,o.C.RangeFunctions,o.C.Functions,o.C.BinaryOps,o.C.Trigonometric,o.C.Time])}getQueryPatterns(){return[{name:"Rate then sum",operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]},{name:"Rate then sum by(label) then avg",operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:[""]},{id:"avg",params:[]}]},{name:"Histogram quantile on rate",operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Histogram quantile on increase ",operations:[{id:"increase",params:["$__rate_interval"]},{id:"__max_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]}]}}const x=new v},8254:(e,t,i)=>{"use strict";i.d(t,{EX:()=>o,PX:()=>a,iQ:()=>n});var s=i(19093),r=i(12524);const n=[{id:r.G.Addition,name:"Add scalar",sign:"+"},{id:r.G.Subtraction,name:"Subtract scalar",sign:"-"},{id:r.G.MultiplyBy,name:"Multiply by scalar",sign:"*"},{id:r.G.DivideBy,name:"Divide by scalar",sign:"/"},{id:r.G.Modulo,name:"Modulo by scalar",sign:"%"},{id:r.G.Exponent,name:"Exponent",sign:"^"},{id:r.G.EqualTo,name:"Equal to",sign:"==",comparison:!0},{id:r.G.NotEqualTo,name:"Not equal to",sign:"!=",comparison:!0},{id:r.G.GreaterThan,name:"Greater than",sign:">",comparison:!0},{id:r.G.LessThan,name:"Less than",sign:"<",comparison:!0},{id:r.G.GreaterOrEqual,name:"Greater or equal to",sign:">=",comparison:!0},{id:r.G.LessOrEqual,name:"Less or equal to",sign:"<=",comparison:!0}],a=n.reduce(((e,t)=>(e[t.sign]={id:t.id,comparison:t.comparison},e)),{}),o=n.map((e=>{const t=[{name:"Value",type:"number"}],i=[2];return e.comparison&&(t.push({name:"Bool",type:"boolean",description:"If checked comparison will return 0 or 1 for the value rather than filtering."}),i.push(!1)),{id:e.id,name:e.name,params:t,defaultParams:i,alternativesKey:"binary scalar operations",category:r.C.BinaryOps,renderer:(n=e.sign,function(e,t,i){let s=e.params[0],r="";return 2===e.params.length&&(r=e.params[1]?" bool":""),`${i} ${n}${r} ${s}`}),addOperationHandler:s.PP};var n}))},47908:(e,t,i)=>{"use strict";i.d(t,{g:()=>h});var s=i(68404),r=i(46196),n=i(61884),a=i(11277),o=i(19093),l=i(45916);function h(e){let{onChange:t,index:i,operationIndex:h,value:u,query:c,datasource:d}=e;const[p,f]=(0,s.useState)({});return(0,l.jsx)(n.Ph,{inputId:(0,o.i1)(h,i),autoFocus:""===u||void 0,openMenuOnFocus:!0,onOpenMenu:async()=>{f({isLoading:!0});const e=await async function(e,t){let i=e.labels;"prometheus"===t.type&&(i=[{label:"__name__",op:"=",value:e.metric},...e.labels]);const s=a.Z.renderLabels(i),r=await t.languageProvider.fetchSeriesLabels(s);return Object.keys(r).map((e=>({label:e,value:e})))}(c,d);f({options:e,isLoading:void 0})},isLoading:p.isLoading,allowCustomValue:!0,noOptionsMessage:"No labels found",loadingMessage:"Loading labels",options:p.options,value:(0,r.E)(u),onChange:e=>t(i,e.value)})}},53373:(e,t,i)=>{"use strict";i.d(t,{_:()=>a});var s=i(60699),r=i(8254),n=i(25890);function a(e){const t=(0,n.bU)(e),i=s.E2.parse(t).topNode,r={query:{metric:"",labels:[],operations:[]},errors:[]};try{o(t,i,r)}catch(e){console.error(e),e instanceof Error&&r.errors.push({text:e.message})}return function(e){if(0===e.labels.length&&0===e.operations.length&&!e.metric)return!0;return!1}(r.query)&&(r.errors=[]),r}function o(e,t,i){const a=i.query;switch(t.type.id){case s.tz:a.metric=(0,n.KF)(e,t);break;case s.Zm:{a.labels.push(function(e,t){const i=(0,n.KF)(e,t.getChild(s.m0)),r=(0,n.KF)(e,t.getChild(s.e8)),a=(0,n.KF)(e,t.getChild(s.nv)).replace(/"/g,"");return{label:i,op:r,value:a}}(e,t));const r=t.getChild(n._A);r&&i.errors.push((0,n.wf)(e,r));break}case s.lX:!function(e,t,i){const r=i.query,a=t.getChild(s.hT),o=(0,n.KF)(e,a),u=t.getChild(s.yY).getChild(s.mW),c=[];let d="";if(l.includes(o)||o.endsWith("_over_time")){let i=(0,n.KF)(e,t).match(/\[(.+)\]/);null!=i&&i[1]&&(d=i[1],c.push(i[1]))}const p={id:o,params:c};if(r.operations.unshift(p),u){if((0,n.KF)(e,u)===d+"]")return;h(e,u,i,p)}}(e,t,i);break;case s.aZ:!function(e,t,i){const r=i.query,a=t.getChild(s.Ki);let o=(0,n.KF)(e,a);const l=t.getChild(s.Ip),u=[];if(l){l.getChild("By")&&o&&(o=`__${o}_by`);l.getChild(s.yN)&&(o=`__${o}_without`),u.push(...(0,n.ff)(e,l,s.Tm))}const c=t.getChild(s.yY).getChild(s.mW),d={id:o,params:[]};r.operations.unshift(d),h(e,c,i,d),d.params.push(...u)}(e,t,i);break;case s.vU:!function(e,t,i){const a=i.query,l=t.firstChild,h=(0,n.KF)(e,l.nextSibling),u=function(e,t){if(!t)return;if(t.getChild("Bool"))return{isBool:!0,isMatcher:!1};{var i;const r=t.getChild(s.Wc);if(!r)return;return{isMatcher:!0,isBool:!1,matches:(0,n.KF)(e,null===(i=r.getChild(s.XT))||void 0===i?void 0:i.getChild(s.pQ)),matchType:r.getChild(s.On)?"on":"ignoring"}}}(e,t.getChild(s.v3)),c=t.lastChild,d=r.PX[h],p=l.getChild(s.iy),f=c.getChild(s.iy),g=c.getChild(s.vU);p||o(e,l,i);if(f)a.operations.push((0,n.Es)(d,e,c,!(null==u||!u.isBool)));else if(g){const t=(0,n.ge)(c);(null==t?void 0:t.type.id)===s.iy&&a.operations.push((0,n.Es)(d,e,t,!(null==u||!u.isBool))),o(e,c,i)}else{a.binaryQueries=a.binaryQueries||[];const t={operator:h,query:{metric:"",labels:[],operations:[]}};null!=u&&u.isMatcher&&(t.vectorMatchesType=u.matchType,t.vectorMatches=u.matches),a.binaryQueries.push(t),o(e,c,{query:t.query,errors:i.errors})}}(e,t,i);break;case n._A:if(function(e){var t,i,r;return(null===(t=e.prevSibling)||void 0===t?void 0:t.type.id)===s.wi&&(null===(i=e.prevSibling)||void 0===i||null===(r=i.firstChild)||void 0===r?void 0:r.type.id)===s.m6}(t))break;i.errors.push((0,n.wf)(e,t));break;default:{t.type.id===s.Om&&i.errors.push((0,n.wf)(e,t));let r=t.firstChild;for(;r;)o(e,r,i),r=r.nextSibling}}}const l=["changes","rate","irate","increase","delta"];function h(e,t,i,r){if(t)switch(t.type.id){case s.wi:case s.mW:{let s=t.firstChild;for(;s;)h(e,s,i,r),s=s.nextSibling;break}case s.iy:r.params.push(parseFloat((0,n.KF)(e,t)));break;case s.nv:r.params.push((0,n.KF)(e,t).replace(/"/g,""));break;default:o(e,t,i)}}},71358:(e,t,i)=>{"use strict";i.d(t,{P:()=>d});var s=i(82897),r=i(68404),n=i(68522),a=i(46196),o=i(68694),l=i(61884),h=i(45916);function u(e){var t;let{item:i,defaultOp:u,onChange:d,onDelete:p,onGetLabelNames:f,onGetLabelValues:g}=e;const[m,y]=(0,r.useState)({}),O=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.op;return null===(e=c.find((e=>e.label===t)))||void 0===e?void 0:e.isMultiValue},v=e=>e?e.indexOf("|")>0?e.split("|"):[e]:[];return(0,h.jsx)("div",{"data-testid":"prometheus-dimensions-filter-item",children:(0,h.jsxs)(n.InputGroup,{children:[(0,h.jsx)(l.Ph,{placeholder:"Select label","aria-label":o.wl.components.QueryBuilder.labelSelect,inputId:"prometheus-dimensions-filter-item-key",width:"auto",value:i.label?(0,a.E)(i.label):null,allowCustomValue:!0,onOpenMenu:async()=>{y({isLoadingLabelNames:!0});const e=await f(i);y({labelNames:e,isLoadingLabelNames:void 0})},isLoading:m.isLoadingLabelNames,options:m.labelNames,onChange:e=>{var t;e.label&&d(Object.assign({},i,{op:null!==(t=i.op)&&void 0!==t?t:u,label:e.label}))}}),(0,h.jsx)(l.Ph,{"aria-label":o.wl.components.QueryBuilder.matchOperatorSelect,value:(0,a.E)(null!==(t=i.op)&&void 0!==t?t:u),options:c,width:"auto",onChange:e=>{null!=e.value&&d(Object.assign({},i,{op:e.value,value:O(e.value)?i.value:v(null==i?void 0:i.value)[0]}))}}),(0,h.jsx)(l.Ph,{placeholder:"Select value","aria-label":o.wl.components.QueryBuilder.valueSelect,inputId:"prometheus-dimensions-filter-item-value",width:"auto",value:O()?v(null==i?void 0:i.value).map(a.E):v(null==i?void 0:i.value).map(a.E)[0],allowCustomValue:!0,onOpenMenu:async()=>{y({isLoadingLabelValues:!0});const e=await g(i);y(Object.assign({},m,{labelValues:e,isLoadingLabelValues:void 0}))},isMulti:O(),isLoading:m.isLoadingLabelValues,options:(()=>{const e=m.labelValues?[...m.labelValues]:[],t=v(null==i?void 0:i.value).map(a.E);return(0,s.uniqBy)([...t,...e],"value")})(),onChange:e=>{if(e.value){var t;d(Object.assign({},i,{value:e.value,op:null!==(t=i.op)&&void 0!==t?t:u}))}else{var s;const t=e.map((e=>e.label)).join("|");d(Object.assign({},i,{value:t,op:null!==(s=i.op)&&void 0!==s?s:u}))}}}),(0,h.jsx)(n.AccessoryButton,{"aria-label":"remove",icon:"times",variant:"secondary",onClick:p})]})})}const c=[{label:"=~",value:"=~",isMultiValue:!0},{label:"=",value:"=",isMultiValue:!1},{label:"!=",value:"!=",isMultiValue:!1},{label:"!~",value:"!~",isMultiValue:!0}];function d(e){let{labelsFilters:t,onChange:i,onGetLabelNames:a,onGetLabelValues:o,error:l}=e;const[c,d]=(0,r.useState)([{op:"="}]);(0,r.useEffect)((()=>{t.length>0?d(t):d([{op:"="}])}),[t]);return(0,h.jsx)(n.EditorFieldGroup,{children:(0,h.jsx)(n.EditorField,{label:"Label filters",error:l,invalid:!!l,children:(0,h.jsx)(n.EditorList,{items:c,onChange:e=>{d(e);const r=e.filter((e=>null!=e.label&&null!=e.value));(0,s.isEqual)(r,t)||i(r)},renderItem:(e,t,i)=>(0,h.jsx)(u,{item:e,defaultOp:"=",onChange:t,onDelete:i,onGetLabelNames:a,onGetLabelValues:o})})})})}},37393:(e,t,i)=>{"use strict";i.d(t,{x:()=>a});var s=i(71450),r=i(12524);function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class a{constructor(e){n(this,"operationsRegistry",void 0),n(this,"categories",[]),this.operationsRegistry=new s.B(e)}setOperationCategories(e){this.categories=e}getOperationsForCategory(e){return this.operationsRegistry.list().filter((t=>t.category===e&&!t.hideFromList))}getAlternativeOperations(e){return this.operationsRegistry.list().filter((t=>t.alternativesKey&&t.alternativesKey===e))}getCategories(){return this.categories}getOperationDef(e){return this.operationsRegistry.getIfExists(e)}renderOperations(e,t){for(const i of t){const t=this.operationsRegistry.getIfExists(i.id);if(!t)throw new Error(`Could not find operation ${i.id} in the registry`);e=t.renderer(i,t,e)}return e}renderBinaryQueries(e,t){if(t)for(const i of t)e=`${this.renderBinaryQuery(e,i)}`;return e}renderBinaryQuery(e,t){let i=e+` ${t.operator} `;return t.vectorMatches&&(i+=`${t.vectorMatchesType}(${t.vectorMatches}) `),i+this.renderQuery(t.query,!0)}renderLabels(e){if(0===e.length)return"";let t="{";for(const i of e)"{"!==t&&(t+=", "),t+=`${i.label}${i.op}"${i.value}"`;return t+"}"}renderQuery(e,t){var i,s,r;let n=`${null!==(i=e.metric)&&void 0!==i?i:""}${this.renderLabels(e.labels)}`;return n=this.renderOperations(n,e.operations),!t&&this.hasBinaryOp(e)&&Boolean(null===(s=e.binaryQueries)||void 0===s?void 0:s.length)&&(n=`(${n})`),n=this.renderBinaryQueries(n,e.binaryQueries),t&&(this.hasBinaryOp(e)||Boolean(null===(r=e.binaryQueries)||void 0===r?void 0:r.length))&&(n=`(${n})`),n}hasBinaryOp(e){return void 0!==e.operations.find((e=>{const t=this.getOperationDef(e.id);return(null==t?void 0:t.category)===r.C.BinaryOps}))}}},22142:(e,t,i)=>{"use strict";i.d(t,{B:()=>o});var s=i(27549),r=(i(68404),i(42179)),n=i(9617),a=i(45916);function o(e){let{title:t,stepNumber:i,markdown:s,children:o}=e;const h=(0,n.wW)(l);return(0,a.jsxs)("div",{className:h.box,children:[void 0!==i&&(0,a.jsx)("div",{className:h.stepNumber,children:i}),(0,a.jsxs)("div",{className:h.boxInner,children:[t&&(0,a.jsx)("div",{className:h.header,children:(0,a.jsx)("span",{children:t})}),(0,a.jsxs)("div",{className:h.body,children:[s&&(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,r.a)(s)}}),o]})]})]})}const l=e=>({box:(0,s.css)({background:e.colors.background.secondary,padding:e.spacing(1),borderRadius:e.shape.borderRadius(),position:"relative"}),boxInner:(0,s.css)({marginLeft:e.spacing(4)}),stepNumber:(0,s.css)({fontWeight:e.typography.fontWeightMedium,background:e.colors.secondary.main,width:"20px",height:"20px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"10px",left:"11px",fontSize:e.typography.bodySmall.fontSize}),header:(0,s.css)({paddingBottom:e.spacing(.5),display:"flex",alignItems:"center",fontFamily:e.typography.fontFamilyMonospace}),body:(0,s.css)({color:e.colors.text.secondary,"p:last-child":{margin:0},a:{color:e.colors.text.link,textDecoration:"underline"}})})},92448:(e,t,i)=>{"use strict";i.d(t,{P:()=>W});var s=i(27549),r=i(68404),n=i(99464),a=i(62124),o=i(36345),l=i(68522),h=i(9617),u=i(53150),c=i(40920),d=i(9442),p=i(24085),f=i(61884);function g(){return g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},g.apply(this,arguments)}var m=i(81337);function y(e){var t=r.useRef(e);return t.current=e,r.useCallback((function(){return t.current}),[])}var O=function(){};function v(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),function(){return{width:0,height:0,top:t,right:e,bottom:t,left:e,x:0,y:0,toJSON:function(){return null}}}}var x=["styles","attributes"],b={getBoundingClientRect:v()},k={closeOnOutsideClick:!0,closeOnTriggerHidden:!1,defaultVisible:!1,delayHide:0,delayShow:0,followCursor:!1,interactive:!1,mutationObserverOptions:{attributes:!0,childList:!0,subtree:!0},offset:[0,6],trigger:"hover"};function $(e,t){var i,s,n;void 0===e&&(e={}),void 0===t&&(t={});var a=Object.keys(k).reduce((function(e,t){var i;return g({},e,((i={})[t]=void 0!==e[t]?e[t]:k[t],i))}),e),o=r.useMemo((function(){return[{name:"offset",options:{offset:a.offset}}]}),Array.isArray(a.offset)?a.offset:[]),l=g({},t,{placement:t.placement||a.placement,modifiers:t.modifiers||o}),h=r.useState(null),u=h[0],c=h[1],d=r.useState(null),p=d[0],f=d[1],$=function(e){var t=e.initial,i=e.value,s=e.onChange,n=void 0===s?O:s;if(void 0===t&&void 0===i)throw new TypeError('Either "value" or "initial" variable must be set. Now both are undefined');var a=r.useState(t),o=a[0],l=a[1],h=y(o),u=r.useCallback((function(e){var t=h(),i="function"==typeof e?e(t):e;"function"==typeof i.persist&&i.persist(),l(i),"function"==typeof n&&n(i)}),[h,n]),c=void 0!==i;return[c?i:o,c?n:u]}({initial:a.defaultVisible,value:a.visible,onChange:a.onVisibleChange}),w=$[0],_=$[1],P=r.useRef();r.useEffect((function(){return function(){return clearTimeout(P.current)}}),[]);var S=(0,m.D)(a.followCursor?b:u,p,l),C=S.styles,Q=S.attributes,T=function(e,t){if(null==e)return{};var i,s,r={},n=Object.keys(e);for(s=0;s<n.length;s++)i=n[s],t.indexOf(i)>=0||(r[i]=e[i]);return r}(S,x),E=T.update,A=y({visible:w,triggerRef:u,tooltipRef:p,finalConfig:a}),X=r.useCallback((function(e){return Array.isArray(a.trigger)?a.trigger.includes(e):a.trigger===e}),Array.isArray(a.trigger)?a.trigger:[a.trigger]),L=r.useCallback((function(){clearTimeout(P.current),P.current=window.setTimeout((function(){return _(!1)}),a.delayHide)}),[a.delayHide,_]),z=r.useCallback((function(){clearTimeout(P.current),P.current=window.setTimeout((function(){return _(!0)}),a.delayShow)}),[a.delayShow,_]),R=r.useCallback((function(){A().visible?L():z()}),[A,L,z]);r.useEffect((function(){if(A().finalConfig.closeOnOutsideClick){var e=function(e){var t,i=A(),s=i.tooltipRef,r=i.triggerRef,n=(null==e.composedPath||null==(t=e.composedPath())?void 0:t[0])||e.target;n instanceof Node&&(null==s||null==r||s.contains(n)||r.contains(n)||L())};return document.addEventListener("mousedown",e),function(){return document.removeEventListener("mousedown",e)}}}),[A,L]),r.useEffect((function(){if(null!=u&&X("click"))return u.addEventListener("click",R),function(){return u.removeEventListener("click",R)}}),[u,X,R]),r.useEffect((function(){if(null!=u&&X("double-click"))return u.addEventListener("dblclick",R),function(){return u.removeEventListener("dblclick",R)}}),[u,X,R]),r.useEffect((function(){if(null!=u&&X("right-click")){var e=function(e){e.preventDefault(),R()};return u.addEventListener("contextmenu",e),function(){return u.removeEventListener("contextmenu",e)}}}),[u,X,R]),r.useEffect((function(){if(null!=u&&X("focus"))return u.addEventListener("focus",z),u.addEventListener("blur",L),function(){u.removeEventListener("focus",z),u.removeEventListener("blur",L)}}),[u,X,z,L]),r.useEffect((function(){if(null!=u&&X("hover"))return u.addEventListener("mouseenter",z),u.addEventListener("mouseleave",L),function(){u.removeEventListener("mouseenter",z),u.removeEventListener("mouseleave",L)}}),[u,X,z,L]),r.useEffect((function(){if(null!=p&&X("hover")&&A().finalConfig.interactive)return p.addEventListener("mouseenter",z),p.addEventListener("mouseleave",L),function(){p.removeEventListener("mouseenter",z),p.removeEventListener("mouseleave",L)}}),[p,X,z,L,A]);var j=null==T||null==(i=T.state)||null==(s=i.modifiersData)||null==(n=s.hide)?void 0:n.isReferenceHidden;r.useEffect((function(){a.closeOnTriggerHidden&&j&&L()}),[a.closeOnTriggerHidden,L,j]),r.useEffect((function(){if(a.followCursor&&null!=u)return u.addEventListener("mousemove",e),function(){return u.removeEventListener("mousemove",e)};function e(e){var t=e.clientX,i=e.clientY;b.getBoundingClientRect=v(t,i),null==E||E()}}),[a.followCursor,u,E]),r.useEffect((function(){if(null!=p&&null!=E&&null!=a.mutationObserverOptions){var e=new MutationObserver(E);return e.observe(p,a.mutationObserverOptions),function(){return e.disconnect()}}}),[a.mutationObserverOptions,p,E]);return g({getArrowProps:function(e){return void 0===e&&(e={}),g({},e,Q.arrow,{style:g({},e.style,C.arrow),"data-popper-arrow":!0})},getTooltipProps:function(e){return void 0===e&&(e={}),g({},e,{style:g({},e.style,C.popper)},Q.popper,{"data-popper-interactive":a.interactive})},setTooltipRef:f,setTriggerRef:c,tooltipRef:p,triggerRef:u,visible:w},T)}var w,_=i(42179),P=i(12235),S=i(45916);const C=r.memo((e=>{let{def:t,operation:i}=e;const s=(0,h.wW)(Q),[n,a]=(0,r.useState)(!1),{getTooltipProps:o,setTooltipRef:u,setTriggerRef:d,visible:p}=$({placement:"top",visible:n,offset:[0,16],onVisibleChange:a,interactive:!0,trigger:["click"]});return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(c.zx,{title:"Click to show description",ref:d,icon:"info-circle",size:"sm",variant:"secondary",fill:"text"}),p&&(0,S.jsx)(P.h_,{children:(0,S.jsxs)("div",Object.assign({ref:u},o(),{className:s.docBox,children:[(0,S.jsxs)("div",{className:s.docBoxHeader,children:[(0,S.jsx)("span",{children:t.renderer(i,t,"<expr>")}),w||(w=(0,S.jsx)(l.FlexItem,{grow:1})),(0,S.jsx)(c.zx,{icon:"times",onClick:()=>a(!1),fill:"text",variant:"secondary",title:"Remove operation"})]}),(0,S.jsx)("div",{className:s.docBoxBody,dangerouslySetInnerHTML:{__html:T(t,i)}})]}))})]})}));C.displayName="OperationDocs";const Q=e=>({docBox:(0,s.css)({overflow:"hidden",background:e.colors.background.primary,border:`1px solid ${e.colors.border.strong}`,boxShadow:e.shadows.z3,maxWidth:"600px",padding:e.spacing(1),borderRadius:e.shape.borderRadius(),zIndex:e.zIndex.tooltip}),docBoxHeader:(0,s.css)({fontSize:e.typography.h5.fontSize,fontFamily:e.typography.fontFamilyMonospace,paddingBottom:e.spacing(1),display:"flex",alignItems:"center"}),docBoxBody:(0,s.css)({marginBottom:e.spacing(-1),color:e.colors.text.secondary}),signature:(0,s.css)({fontSize:e.typography.bodySmall.fontSize,fontFamily:e.typography.fontFamilyMonospace}),dropdown:(0,s.css)({opacity:0,color:e.colors.text.secondary})});function T(e,t){var i;return(0,_.a)(e.explainHandler?e.explainHandler(t,e):null!==(i=e.documentation)&&void 0!==i?i:"no docs")}var E;const A=r.memo((e=>{var t;let{operation:i,def:s,index:n,onChange:a,onRemove:o,queryModeller:u,dragHandleProps:d}=e;const p=(0,h.wW)(X),[g,m]=(0,r.useState)({}),y=()=>{if(g.isOpen)m(Object.assign({},g,{isOpen:!1}));else{const e=u.getAlternativeOperations(s.alternativesKey).map((e=>({label:e.name,value:e})));m({isOpen:!0,alternatives:e})}};return(0,S.jsxs)("div",{className:p.header,children:[!g.isOpen&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",Object.assign({},d,{children:null!==(t=s.name)&&void 0!==t?t:s.id})),E||(E=(0,S.jsx)(l.FlexItem,{grow:1})),(0,S.jsxs)("div",{className:`${p.operationHeaderButtons} operation-header-show-on-hover`,children:[(0,S.jsx)(c.zx,{icon:"angle-down",size:"sm",onClick:y,fill:"text",variant:"secondary",title:"Click to view alternative operations"}),(0,S.jsx)(C,{def:s,operation:i}),(0,S.jsx)(c.zx,{icon:"times",size:"sm",onClick:()=>o(n),fill:"text",variant:"secondary",title:"Remove operation"})]})]}),g.isOpen&&(0,S.jsx)("div",{className:p.selectWrapper,children:(0,S.jsx)(f.Ph,{autoFocus:!0,openMenuOnFocus:!0,placeholder:"Replace with",options:g.alternatives,isOpen:!0,onCloseMenu:y,onChange:e=>{if(e.value){const t=u.getOperationDef(e.value.id),r=[...t.defaultParams];for(let e=0;e<Math.min(i.params.length,r.length);e++)t.params[e].type===s.params[e].type&&(r[e]=i.params[e]);const o=Object.assign({},i,{params:r,id:e.value.id});a(n,s.changeTypeHandler?s.changeTypeHandler(o,t):o)}}})})]})}));A.displayName="OperationHeader";const X=e=>({header:(0,s.css)({borderBottom:`1px solid ${e.colors.border.medium}`,padding:e.spacing(.5,.5,.5,1),display:"flex",alignItems:"center","&:hover .operation-header-show-on-hover":(0,s.css)({opacity:1})}),operationHeaderButtons:(0,s.css)({opacity:0,transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short})}),selectWrapper:(0,s.css)({paddingRight:e.spacing(2)})});var L=i(46196),z=i(82038),R=i(95922),j=i(19093);function N(e){return e.editor?e.editor:e.options?M:"boolean"===e.type?D:q}function q(e){var t;return(0,S.jsx)(z.H,{id:(0,j.i1)(e.operationIndex,e.index),defaultValue:null===(t=e.value)||void 0===t?void 0:t.toString(),minWidth:e.paramDef.minWidth,placeholder:e.paramDef.placeholder,title:e.paramDef.description,onCommitChange:t=>{e.onChange(e.index,t.currentTarget.value),e.paramDef.runQueryOnEnter&&"keydown"===t.type&&e.onRunQuery()}})}function D(e){return(0,S.jsx)(R.X,{id:(0,j.i1)(e.operationIndex,e.index),value:e.value,onChange:t=>e.onChange(e.index,t.currentTarget.checked)})}function M(e){var t,i;let{paramDef:s,value:r,index:n,operationIndex:a,onChange:o}=e;const u=(0,h.wW)(I);let d=s.options;null!==(t=d[0])&&void 0!==t&&t.label||(d=s.options.map((e=>({label:e.toString(),value:e}))));let p=null!==(i=d.find((e=>e.value===r)))&&void 0!==i?i:(0,L.E)(r);return!r&&s.optional?(0,S.jsx)("div",{className:u.optionalParam,children:(0,S.jsx)(c.zx,{size:"sm",variant:"secondary",title:`Add ${s.name}`,icon:"plus",onClick:()=>o(n,d[0].value),children:s.name})}):(0,S.jsxs)(l.Stack,{gap:.5,direction:"row",alignItems:"center",wrap:!1,children:[(0,S.jsx)(f.Ph,{id:(0,j.i1)(a,n),value:p,options:d,placeholder:s.placeholder,allowCustomValue:!0,onChange:e=>o(n,e.value)}),s.optional&&(0,S.jsx)(c.zx,{"data-testid":`operations.${n}.remove-param`,size:"sm",fill:"text",icon:"times",variant:"secondary",title:`Remove ${s.name}`,onClick:()=>o(n,"")})]})}const I=e=>({optionalParam:(0,s.css)({marginTop:e.spacing(1)})});function G(e){let{operation:t,index:i,onRemove:a,onChange:o,onRunQuery:u,queryModeller:f,query:g,datasource:m,flash:y,highlight:O}=e;const v=(0,h.wW)(B),x=f.getOperationDef(t.id),b=function(e){const[t,i]=(0,r.useState)(!0);return(0,r.useEffect)((()=>{let t;return e?t=setTimeout((()=>{i(!1)}),1e3):i(!0),()=>clearTimeout(t)}),[e]),t&&e}(y);if(!x)return(0,S.jsxs)("span",{children:["Operation ",t.id," not found"]});const k=(e,s)=>{const r=Object.assign({},t,{params:[...t.params]});r.params[e]=s,F(x,r,i,e,o)},$=()=>{const e=Object.assign({},t,{params:[...t.params,""]});F(x,e,i,t.params.length,o)},w=e=>{const s=Object.assign({},t,{params:[...t.params.slice(0,e),...t.params.slice(e+1)]});F(x,s,i,e,o)},_=[];for(let e=0;e<t.params.length;e++){const s=x.params[Math.min(x.params.length-1,e)],r=N(s);_.push((0,S.jsxs)("div",{className:v.paramRow,children:[!s.hideName&&(0,S.jsxs)("div",{className:v.paramName,children:[(0,S.jsx)("label",{htmlFor:(0,j.i1)(i,e),children:s.name}),s.description&&(0,S.jsx)(d.u,{placement:"top",content:s.description,theme:"info",children:(0,S.jsx)(p.J,{name:"info-circle",size:"sm",className:v.infoIcon})})]}),(0,S.jsx)("div",{className:v.paramValue,children:(0,S.jsxs)(l.Stack,{gap:.5,direction:"row",alignItems:"center",wrap:!1,children:[(0,S.jsx)(r,{index:e,paramDef:s,value:t.params[e],operation:t,operationIndex:i,onChange:k,onRunQuery:u,query:g,datasource:m}),s.restParam&&(t.params.length>x.params.length||s.optional)&&(0,S.jsx)(c.zx,{"data-testid":`operations.${i}.remove-rest-param`,size:"sm",fill:"text",icon:"times",variant:"secondary",title:`Remove ${s.name}`,onClick:()=>w(e)})]})})]},`${e}-1`))}let P;if(x.params.length>0){const e=x.params[x.params.length-1];e.restParam&&(P=function(e,t,i,s,r){return(0,S.jsx)("div",{className:r.restParam,children:(0,S.jsx)(c.zx,{size:"sm",icon:"plus",title:`Add ${e.name}`,variant:"secondary",onClick:t,"data-testid":`operations.${i}.add-rest-param`,children:e.name})},`${s}-2`)}(e,$,i,t.params.length,v))}return(0,S.jsx)(n._l,{draggableId:`operation-${i}`,index:i,children:e=>(0,S.jsxs)("div",Object.assign({className:(0,s.cx)(v.card,(b||O)&&v.cardHighlight),ref:e.innerRef},e.draggableProps,{"data-testid":`operations.${i}.wrapper`,children:[(0,S.jsx)(A,{operation:t,dragHandleProps:e.dragHandleProps,def:x,index:i,onChange:o,onRemove:a,queryModeller:f}),(0,S.jsx)("div",{className:v.body,children:_}),P,i<g.operations.length-1&&(0,S.jsxs)("div",{className:v.arrow,children:[(0,S.jsx)("div",{className:v.arrowLine}),(0,S.jsx)("div",{className:v.arrowArrow})]})]}))})}function F(e,t,i,s,r){e.paramChangedHandler?r(i,e.paramChangedHandler(s,t,e)):r(i,t)}const B=e=>({card:(0,s.css)({background:e.colors.background.primary,border:`1px solid ${e.colors.border.medium}`,display:"flex",flexDirection:"column",cursor:"grab",borderRadius:e.shape.borderRadius(1),marginBottom:e.spacing(1),position:"relative",transition:"all 0.5s ease-in 0s"}),cardHighlight:(0,s.css)({boxShadow:`0px 0px 4px 0px ${e.colors.primary.border}`,border:`1px solid ${e.colors.primary.border}`}),infoIcon:(0,s.css)({marginLeft:e.spacing(.5),color:e.colors.text.secondary,":hover":{color:e.colors.text.primary}}),body:(0,s.css)({margin:e.spacing(1,1,.5,1),display:"table"}),paramRow:(0,s.css)({label:"paramRow",display:"table-row",verticalAlign:"middle"}),paramName:(0,s.css)({display:"table-cell",padding:e.spacing(0,1,0,0),fontSize:e.typography.bodySmall.fontSize,fontWeight:e.typography.fontWeightMedium,verticalAlign:"middle",height:"32px"}),paramValue:(0,s.css)({label:"paramValue",display:"table-cell",verticalAlign:"middle"}),restParam:(0,s.css)({padding:e.spacing(0,1,1,1)}),arrow:(0,s.css)({position:"absolute",top:"0",right:"-18px",display:"flex"}),arrowLine:(0,s.css)({height:"2px",width:"8px",backgroundColor:e.colors.border.strong,position:"relative",top:"14px"}),arrowArrow:(0,s.css)({width:0,height:0,borderTop:"5px solid transparent",borderBottom:"5px solid transparent",borderLeft:`7px solid ${e.colors.border.strong}`,position:"relative",top:"10px"})});function W(e){let{query:t,datasource:i,queryModeller:s,onChange:d,onRunQuery:p,highlightedOp:f}=e;const g=(0,h.wW)(V),{operations:m}=t,y=function(e){const t=(0,a.Z)(),i=(0,o.Z)(e);if(!t())return e.map((()=>!1));if(!i)return e.map((()=>!0));let s=[];if(i.length-1===e.length&&e.every((e=>i.includes(e))))return e.map((()=>!1));if(i.length+1===e.length&&i.every((t=>e.includes(t)))){const t=e.find((e=>!i.includes(e)));s=e.map((e=>e===t))}else s=e.map(((e,t)=>{var s,r,n;return r=e.id,n=null===(s=i[t])||void 0===s?void 0:s.id,!(r===n||`__${r}_by`===n||r===`__${n}_by`)}));return s}(m),[O,v]=(0,r.useState)(!1),x=(e,i)=>{const s=[...m];s.splice(e,1,i),d(Object.assign({},t,{operations:s}))},b=e=>{const i=[...m.slice(0,e),...m.slice(e+1)];d(Object.assign({},t,{operations:i}))},k=s.getCategories().map((e=>({value:e,label:e,items:s.getOperationsForCategory(e).map((e=>({value:e.id,label:e.name,isLeaf:!0})))})));return(0,S.jsx)(l.Stack,{gap:1,direction:"column",children:(0,S.jsxs)(l.Stack,{gap:1,children:[m.length>0&&(0,S.jsx)(n.Z5,{onDragEnd:e=>{if(!e.destination)return;const i=[...m],s=i[e.source.index];i.splice(e.source.index,1),i.splice(e.destination.index,0,s),d(Object.assign({},t,{operations:i}))},children:(0,S.jsx)(n.bK,{droppableId:"sortable-field-mappings",direction:"horizontal",children:e=>(0,S.jsxs)("div",Object.assign({className:g.operationList,ref:e.innerRef},e.droppableProps,{children:[m.map(((e,r)=>(0,S.jsx)(G,{queryModeller:s,index:r,operation:e,query:t,datasource:i,onChange:x,onRemove:b,onRunQuery:p,flash:y[r],highlight:f===e},e.id+JSON.stringify(e.params)+r))),e.placeholder]}))})}),(0,S.jsx)("div",{className:g.addButton,children:O?(0,S.jsx)(u.v,{options:k,onSelect:e=>{const i=s.getOperationDef(e);i&&(d(i.addOperationHandler(i,t,s)),v(!1))},onBlur:()=>{v(!1)},autoFocus:!0,alwaysOpen:!0,hideActiveLevelLabel:!0,placeholder:"Search"}):(0,S.jsx)(c.zx,{icon:"plus",variant:"secondary",onClick:()=>v(!0),title:"Add operation",children:"Operations"})})]})})}const V=e=>({heading:(0,s.css)({label:"heading",fontSize:12,fontWeight:e.typography.fontWeightMedium,marginBottom:0}),operationList:(0,s.css)({label:"operationList",display:"flex",flexWrap:"wrap",gap:e.spacing(2)}),addButton:(0,s.css)({label:"addButton",width:126,paddingBottom:e.spacing(1)})})},74929:(e,t,i)=>{"use strict";i.d(t,{V:()=>a});i(68404);var s=i(22142),r=i(3690),n=i(45916);function a(e){let{query:t,queryModeller:i,stepNumber:a,lang:o,onMouseEnter:l,onMouseLeave:h}=e;return(0,n.jsx)(n.Fragment,{children:t.operations.map(((e,t)=>{var u;const c=i.getOperationDef(e.id);if(!c)return`Operation ${e.id} not found`;const d=c.renderer(e,c,"<expr>"),p=c.explainHandler?c.explainHandler(e,c):null!==(u=c.documentation)&&void 0!==u?u:"no docs";return(0,n.jsx)("div",{onMouseEnter:()=>null==l?void 0:l(e,t),onMouseLeave:()=>null==h?void 0:h(e,t),children:(0,n.jsx)(s.B,{stepNumber:t+a,title:(0,n.jsx)(r.U,{query:d,lang:o}),markdown:p})},t)}))})}},2398:(e,t,i)=>{"use strict";i.d(t,{B:()=>o});var s=i(27549),r=(i(68404),i(68522)),n=i(9617),a=i(45916);function o(e){let{children:t}=e;const i=(0,n.wW)(l);return(0,a.jsx)("div",{className:i.root,children:(0,a.jsx)(r.Stack,{gap:1,children:t})})}const l=e=>({root:(0,s.css)({padding:e.spacing(1,1,0,1),backgroundColor:e.colors.background.secondary,borderRadius:e.shape.borderRadius(1)})})},47352:(e,t,i)=>{"use strict";i.d(t,{L:()=>h});var s=i(27549),r=i(68404),n=i(9617),a=i(9442),o=i(40920),l=i(45916);const h=e=>{let{datasource:t,query:i,onChange:s,data:h,queryModeller:c,buildVisualQueryFromString:d}=e;const[p,f]=(0,r.useState)([]),g=(0,n.wW)(u);return(0,r.useEffect)((()=>{const e={expr:c.renderQuery(i),refId:""},s=t.getQueryHints(e,(null==h?void 0:h.series)||[]).filter((e=>{var t;return null===(t=e.fix)||void 0===t?void 0:t.action}));f(s)}),[t,i,h,c]),(0,l.jsx)(l.Fragment,{children:p.length>0&&(0,l.jsx)("div",{className:g.container,children:p.map((e=>{var r,n,h;return(0,l.jsx)(a.u,{content:`${e.label} ${null===(r=e.fix)||void 0===r?void 0:r.label}`,children:(0,l.jsx)(o.zx,{onClick:()=>{var r;if(null!=e&&null!==(r=e.fix)&&void 0!==r&&r.action){const r={expr:c.renderQuery(i),refId:""},n=t.modifyQuery(r,e.fix.action),a=d(n.expr);return s(a.query)}},fill:"outline",size:"sm",className:g.hint,children:"hint: "+(null===(n=e.fix)||void 0===n||null===(h=n.action)||void 0===h?void 0:h.type.toLowerCase().replace("_"," "))+"()"})},e.type)}))})})};h.displayName="QueryBuilderHints";const u=e=>({container:s.css`
      display: flex;
      align-items: start;
    `,hint:s.css`
      margin-right: ${e.spacing(1)};
    `})},50966:(e,t,i)=>{"use strict";i.d(t,{k:()=>o});i(68404);var s=i(96380),r=i(7524),n=i(45916);const a=[{label:"Builder",value:r.c.Builder},{label:"Code",value:r.c.Code}];function o(e){let{mode:t,onChange:i}=e;return(0,n.jsx)("div",{"data-testid":"QueryEditorModeToggle",children:(0,n.jsx)(s.S,{options:a,size:"sm",value:t,onChange:i})})}},82631:(e,t,i)=>{"use strict";i.d(t,{n:()=>c});var s=i(27549),r=i(82897),n=i(68404),a=i(68522),o=i(9617),l=i(72786),h=i(45916);const u=["label"];function c(e){let{label:t}=e,i=function(e,t){if(null==e)return{};var i,s,r={},n=Object.keys(e);for(s=0;s<n.length;s++)i=n[s],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,u);const s=t.replace(" ","-"),c=(0,n.useRef)((0,r.uniqueId)(`switch-${s}`)),p=(0,o.wW)(d);return(0,h.jsxs)(a.Stack,{gap:1,children:[(0,h.jsx)("label",{htmlFor:c.current,className:p.switchLabel,children:t}),(0,h.jsx)(l.r,Object.assign({},i,{id:c.current}))]})}const d=e=>({switchLabel:(0,s.css)({color:e.colors.text.secondary,cursor:"pointer",fontSize:e.typography.bodySmall.fontSize,"&:hover":{color:e.colors.text.primary}})})},68374:(e,t,i)=>{"use strict";i.d(t,{d:()=>h});var s=i(27549),r=(i(68404),i(88102)),n=i(68522),a=i(9617),o=i(24085),l=i(45916);function h(e){let{title:t,children:i,collapsedInfo:s}=e;const[h,c]=(0,r.Z)(!1),d=(0,a.wW)(u);return(0,l.jsxs)(n.Stack,{gap:0,direction:"column",children:[(0,l.jsxs)("div",{className:d.header,onClick:c,title:"Click to edit options",children:[(0,l.jsx)("div",{className:d.toggle,children:(0,l.jsx)(o.J,{name:h?"angle-down":"angle-right"})}),(0,l.jsx)("h6",{className:d.title,children:t}),!h&&(0,l.jsx)("div",{className:d.description,children:s.map(((e,t)=>(0,l.jsx)("span",{children:e},t)))})]}),h&&(0,l.jsx)("div",{className:d.body,children:i})]})}const u=e=>({switchLabel:(0,s.css)({color:e.colors.text.secondary,cursor:"pointer",fontSize:e.typography.bodySmall.fontSize,"&:hover":{color:e.colors.text.primary}}),header:(0,s.css)({display:"flex",cursor:"pointer",alignItems:"baseline",color:e.colors.text.primary,"&:hover":{background:e.colors.emphasize(e.colors.background.primary,.03)}}),title:(0,s.css)({flexGrow:1,overflow:"hidden",fontSize:e.typography.bodySmall.fontSize,fontWeight:e.typography.fontWeightMedium,margin:0}),description:(0,s.css)({color:e.colors.text.secondary,fontSize:e.typography.bodySmall.fontSize,paddingLeft:e.spacing(2),gap:e.spacing(2),display:"flex"}),body:(0,s.css)({display:"flex",paddingTop:e.spacing(2),gap:e.spacing(2),flexWrap:"wrap"}),toggle:(0,s.css)({color:e.colors.text.secondary,marginRight:`${e.spacing(1)}`})})},3690:(e,t,i)=>{"use strict";i.d(t,{U:()=>l});var s=i(27549),r=i(57706),n=i.n(r),a=(i(68404),i(9617)),o=i(45916);function l(e){let{query:t,lang:i}=e;const r=(0,a.l4)(),l=h(r),u=n().highlight(t,i.grammar,i.name);return(0,o.jsx)("div",{className:(0,s.cx)(l.editorField,"prism-syntax-highlight"),"aria-label":"selector",dangerouslySetInnerHTML:{__html:u}})}const h=e=>({editorField:(0,s.css)({fontFamily:e.typography.fontFamilyMonospace,fontSize:e.typography.bodySmall.fontSize})})},33621:(e,t,i)=>{"use strict";i.d(t,{J$:()=>l,P5:()=>c,ar:()=>n,iS:()=>o,jl:()=>a});var s=i(68404),r=i(17421);const n="PrometheusQueryEditorExplainDefault",a="PrometheusQueryEditorRawQueryDefault",o="LokiQueryEditorExplainDefault",l="LokiQueryEditorRawQueryDefault";function h(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=r.Z.get(e);return void 0===i?t:Boolean(parseInt(i,10))}function u(e,t){r.Z.set(e,t?"1":"0")}function c(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[i,r]=(0,s.useState)(h(e,t)),n=(0,s.useCallback)((t=>{u(e,t),r(t)}),[e]);return{flag:i,setFlag:n}}},19093:(e,t,i)=>{"use strict";i.d(t,{IT:()=>O,NZ:()=>d,PP:()=>f,Sp:()=>k,Z3:()=>v,ZI:()=>_,e8:()=>c,i1:()=>m,j8:()=>w,kq:()=>y,pS:()=>l,t7:()=>g,zJ:()=>h});var s=i(82897),r=i(64681),n=i.n(r),a=i(47908),o=i(12524);function l(e,t,i){const s=p(e,t,i),r=e.id+"(";return i&&s.push(i),r+s.join(", ")+")"}function h(e,t,i){const s=p(e,t,i),r=e.id+"(";return i&&s.unshift(i),r+s.join(", ")+")"}function u(e,t,i,s){var r,n;if(t.params.length<2)throw`Cannot render a function with params of length [${t.params.length}]`;let a=null!==(r=(null!==(n=e.params)&&void 0!==n?n:[])[0])&&void 0!==r?r:"5m";const o=p(Object.assign({},e,{params:e.params.slice(1)}),Object.assign({},t,{params:t.params.slice(1),defaultParams:t.defaultParams.slice(1)}),i),l=e.id+"(";return i&&(s?o.push(`${i}[${a}]`):o.unshift(`${i}[${a}]`)),l+o.join(", ")+")"}function c(e,t,i){return u(e,t,i,!1)}function d(e,t,i){return u(e,t,i,!0)}function p(e,t,i){var s;return(null!==(s=e.params)&&void 0!==s?s:[]).map(((e,i)=>"string"===t.params[i].type?'"'+e+'"':e))}function f(e,t){const i={id:e.id,params:e.defaultParams};return Object.assign({},t,{operations:[...t.operations,i]})}function g(e){return(0,s.capitalize)(e.replace(/_/g," "))}function m(e,t){return`operations.${e}.param.${t}`}function y(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t={name:"Range",type:"string",options:[{label:"$__interval",value:"$__interval"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"1h",value:"1h"},{label:"24h",value:"24h"}]};return e&&t.options.unshift({label:"$__rate_interval",value:"$__rate_interval"}),t}function O(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=[Object.assign({id:e,name:g(e),params:[{name:"By label",type:"string",restParam:!0,optional:!0}],defaultParams:[],alternativesKey:"plain aggregations",category:o.C.Aggregations,renderer:l,paramChangedHandler:_(`__${e}_by`),explainHandler:k(e,""),addOperationHandler:f},t),Object.assign({id:`__${e}_by`,name:`${g(e)} by`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:a.g}],defaultParams:[""],alternativesKey:"aggregations by",category:o.C.Aggregations,renderer:x(e),paramChangedHandler:w(e),explainHandler:k(e,"by"),addOperationHandler:f,hideFromList:!0},t),Object.assign({id:`__${e}_without`,name:`${g(e)} without`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:a.g}],defaultParams:[""],alternativesKey:"aggregations by",category:o.C.Aggregations,renderer:b(e),paramChangedHandler:w(e),explainHandler:k(e,"without"),addOperationHandler:f,hideFromList:!0},t)];return i}function v(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=O(e,i);return s[0].params.unshift(...t.params),s[1].params.unshift(...t.params),s[2].params.unshift(...t.params),s[0].defaultParams=t.defaultParams,s[1].defaultParams=[...t.defaultParams,""],s[2].defaultParams=[...t.defaultParams,""],s[1].renderer=$(e),s[2].renderer=$(e),s}function x(e){return function(t,i,s){return`${e} by(${t.params.join(", ")}) (${s})`}}function b(e){return function(t,i,s){return`${e} without(${t.params.join(", ")}) (${s})`}}function k(e,t){return function(i){const s=i.params.map((e=>`\`${e}\``)).join(" and "),r=n()("label",i.params.length);switch(t){case"by":return`Calculates ${e} over dimensions while preserving ${r} ${s}.`;case"without":return`Calculates ${e} over the dimensions ${s}. All other labels are preserved.`;default:return`Calculates ${e} over the dimensions.`}}}function $(e){return function(t,i,s){const r=i.params.findIndex((e=>e.restParam)),n=t.params.slice(0,r),a=t.params.slice(r);return`${e} by(${a.join(", ")}) (${n.map(((e,t)=>"string"===i.params[t].type?`"${e}"`:e)).join(", ")}, ${s})`}}function w(e){return function(t,i,s){return i.params.length<s.params.length?Object.assign({},i,{id:e}):i}}function _(e){return function(t,i,s){return i.params.length===s.params.length?Object.assign({},i,{id:e}):i}}},25890:(e,t,i)=>{"use strict";i.d(t,{Es:()=>c,KF:()=>u,Tt:()=>h,_A:()=>s,bU:()=>o,ff:()=>d,ge:()=>r,wf:()=>n});const s=0;function r(e){return e.firstChild?r(e.firstChild):e}function n(e,t){var i;return{text:u(e,t),from:t.from,to:t.to,parentType:null===(i=t.parent)||void 0===i?void 0:i.name}}const a=/\$(\w+)|\[\[([\s\S]+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;function o(e){return e.replace(a,((e,t,i,s,r,n,a)=>{const o=s||a;let l=t,h="0";return i&&(l=i,h="1"),r&&(l=r,h="2"),`__V_${h}__`+l+"__V__"+(o?"__F__"+o+"__F__":"")}))}const l=[(e,t)=>`$${e}`,(e,t)=>`[[${e}${t?`:${t}`:""}]]`,(e,t)=>`\${${e}${t?`:${t}`:""}}`];function h(e){return e.replace(/__V_(\d)__(.+?)__V__(?:__F__(\w+)__F__)?/g,((e,t,i,s)=>l[parseInt(t,10)](i,s)))}function u(e,t){return t?h(e.substring(t.from,t.to)):""}function c(e,t,i,s){const r=[parseFloat(u(t,i))];return e.comparison&&r.push(s),{id:e.id,params:r}}function d(e,t,i){if(t.type.id===i||t.name===i)return[u(e,t)];const s=[];let r=0,n=t.childAfter(r);for(;n;)s.push(...d(e,n,i)),r=n.to,n=t.childAfter(r);return s}},7524:(e,t,i)=>{"use strict";let s;i.d(t,{c:()=>s}),function(e){e.Code="code",e.Builder="builder"}(s||(s={}))},12524:(e,t,i)=>{"use strict";let s,r;i.d(t,{C:()=>s,G:()=>r}),function(e){e.Aggregations="Aggregations",e.RangeFunctions="Range functions",e.Functions="Functions",e.BinaryOps="Binary operations",e.Trigonometric="Trigonometric",e.Time="Time Functions"}(s||(s={})),function(e){e.Abs="abs",e.Absent="absent",e.AbsentOverTime="absent_over_time",e.Acos="acos",e.Acosh="acosh",e.Asin="asin",e.Asinh="asinh",e.Atan="atan",e.Atanh="atanh",e.Avg="avg",e.AvgOverTime="avg_over_time",e.BottomK="bottomk",e.Ceil="ceil",e.Changes="changes",e.Clamp="clamp",e.ClampMax="clamp_max",e.ClampMin="clamp_min",e.Cos="cos",e.Cosh="cosh",e.Count="count",e.CountOverTime="count_over_time",e.CountScalar="count_scalar",e.CountValues="count_values",e.DayOfMonth="day_of_month",e.DayOfWeek="day_of_week",e.DaysInMonth="days_in_month",e.Deg="deg",e.Delta="delta",e.Deriv="deriv",e.DropCommonLabels="drop_common_labels",e.Exp="exp",e.Floor="floor",e.Group="group",e.HistogramQuantile="histogram_quantile",e.HoltWinters="holt_winters",e.Hour="hour",e.Idelta="idelta",e.Increase="increase",e.Irate="irate",e.LabelJoin="label_join",e.LabelReplace="label_replace",e.Last="last",e.LastOverTime="last_over_time",e.Ln="ln",e.Log10="log10",e.Log2="log2",e.Max="max",e.MaxOverTime="max_over_time",e.Min="min",e.MinOverTime="min_over_time",e.Minute="minute",e.Month="month",e.Pi="pi",e.PredictLinear="predict_linear",e.Present="present",e.PresentOverTime="present_over_time",e.Quantile="quantile",e.QuantileOverTime="quantile_over_time",e.Rad="rad",e.Rate="rate",e.Resets="resets",e.Round="round",e.Scalar="scalar",e.Sgn="sgn",e.Sin="sin",e.Sinh="sinh",e.Sort="sort",e.SortDesc="sort_desc",e.Sqrt="sqrt",e.Stddev="stddev",e.StddevOverTime="stddev_over_time",e.Sum="sum",e.SumOverTime="sum_over_time",e.Tan="tan",e.Tanh="tanh",e.Time="time",e.Timestamp="timestamp",e.TopK="topk",e.Vector="vector",e.Year="year",e.Addition="__addition",e.Subtraction="__subtraction",e.MultiplyBy="__multiply_by",e.DivideBy="__divide_by",e.Modulo="__modulo",e.Exponent="__exponent",e.NestedQuery="__nested_query",e.EqualTo="__equal_to",e.NotEqualTo="__not_equal_to",e.GreaterThan="__greater_than",e.LessThan="__less_than",e.GreaterOrEqual="__greater_or_equal",e.LessOrEqual="__less_or_equal"}(r||(r={}))},20707:e=>{const t="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,i="function"==typeof AbortController?AbortController:class{constructor(){this.signal=new n}abort(){this.signal.dispatchEvent("abort")}},s="function"==typeof AbortSignal,r="function"==typeof i.AbortSignal,n=s?AbortSignal:r?i.AbortController:class{constructor(){this.aborted=!1,this._listeners=[]}dispatchEvent(e){if("abort"===e){this.aborted=!0;const t={type:e,target:this};this.onabort(t),this._listeners.forEach((e=>e(t)),this)}}onabort(){}addEventListener(e,t){"abort"===e&&this._listeners.push(t)}removeEventListener(e,t){"abort"===e&&(this._listeners=this._listeners.filter((e=>e!==t)))}},a=new Set,o=(e,t)=>{const i=`LRU_CACHE_OPTION_${e}`;u(i)&&c(i,`${e} option`,`options.${t}`,m)},l=(e,t)=>{const i=`LRU_CACHE_METHOD_${e}`;if(u(i)){const{prototype:s}=m,{get:r}=Object.getOwnPropertyDescriptor(s,e);c(i,`${e} method`,`cache.${t}()`,r)}},h=(...e)=>{"object"==typeof process&&process&&"function"==typeof process.emitWarning?process.emitWarning(...e):console.error(...e)},u=e=>!a.has(e),c=(e,t,i,s)=>{a.add(e);h(`The ${t} is deprecated. Please use ${i} instead.`,"DeprecationWarning",e,s)},d=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),p=e=>d(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?f:null:null;class f extends Array{constructor(e){super(e),this.fill(0)}}class g{constructor(e){if(0===e)return[];const t=p(e);this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class m{constructor(e={}){const{max:t=0,ttl:i,ttlResolution:s=1,ttlAutopurge:r,updateAgeOnGet:n,updateAgeOnHas:l,allowStale:c,dispose:f,disposeAfter:y,noDisposeOnSet:O,noUpdateTTL:v,maxSize:x=0,maxEntrySize:b=0,sizeCalculation:k,fetchMethod:$,fetchContext:w,noDeleteOnFetchRejection:_,noDeleteOnStaleGet:P}=e,{length:S,maxAge:C,stale:Q}=e instanceof m?{}:e;if(0!==t&&!d(t))throw new TypeError("max option must be a nonnegative integer");const T=t?p(t):Array;if(!T)throw new Error("invalid max value: "+t);if(this.max=t,this.maxSize=x,this.maxEntrySize=b||this.maxSize,this.sizeCalculation=k||S,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=$||null,this.fetchMethod&&"function"!=typeof this.fetchMethod)throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=w,!this.fetchMethod&&void 0!==w)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(t).fill(null),this.valList=new Array(t).fill(null),this.next=new T(t),this.prev=new T(t),this.head=0,this.tail=0,this.free=new g(t),this.initialFill=1,this.size=0,"function"==typeof f&&(this.dispose=f),"function"==typeof y?(this.disposeAfter=y,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!O,this.noUpdateTTL=!!v,this.noDeleteOnFetchRejection=!!_,0!==this.maxEntrySize){if(0!==this.maxSize&&!d(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!d(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!c||!!Q,this.noDeleteOnStaleGet=!!P,this.updateAgeOnGet=!!n,this.updateAgeOnHas=!!l,this.ttlResolution=d(s)||0===s?s:1,this.ttlAutopurge=!!r,this.ttl=i||C||0,this.ttl){if(!d(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(0===this.max&&0===this.ttl&&0===this.maxSize)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const e="LRU_CACHE_UNBOUNDED";if(u(e)){a.add(e);h("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",e,m)}}Q&&o("stale","allowStale"),C&&o("maxAge","ttl"),S&&o("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new f(this.max),this.starts=new f(this.max),this.setItemTTL=(e,i,s=t.now())=>{if(this.starts[e]=0!==i?s:0,this.ttls[e]=i,0!==i&&this.ttlAutopurge){const t=setTimeout((()=>{this.isStale(e)&&this.delete(this.keyList[e])}),i+1);t.unref&&t.unref()}},this.updateItemAge=e=>{this.starts[e]=0!==this.ttls[e]?t.now():0};let e=0;const i=()=>{const i=t.now();if(this.ttlResolution>0){e=i;const t=setTimeout((()=>e=0),this.ttlResolution);t.unref&&t.unref()}return i};this.getRemainingTTL=t=>{const s=this.keyMap.get(t);return void 0===s?0:0===this.ttls[s]||0===this.starts[s]?1/0:this.starts[s]+this.ttls[s]-(e||i())},this.isStale=t=>0!==this.ttls[t]&&0!==this.starts[t]&&(e||i())-this.starts[t]>this.ttls[t]}updateItemAge(e){}setItemTTL(e,t,i){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new f(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,t,i,s)=>{if(!d(i)){if(!s)throw new TypeError("invalid size value (must be positive integer)");if("function"!=typeof s)throw new TypeError("sizeCalculation must be a function");if(i=s(t,e),!d(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return i},this.addItemSize=(e,t)=>{this.sizes[e]=t;const i=this.maxSize-this.sizes[e];for(;this.calculatedSize>i;)this.evict(!0);this.calculatedSize+=this.sizes[e]}}removeItemSize(e){}addItemSize(e,t){}requireSize(e,t,i,s){if(i||s)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.tail;this.isValidIndex(t)&&(!e&&this.isStale(t)||(yield t),t!==this.head);)t=this.prev[t]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.head;this.isValidIndex(t)&&(!e&&this.isStale(t)||(yield t),t!==this.tail);)t=this.next[t]}isValidIndex(e){return this.keyMap.get(this.keyList[e])===e}*entries(){for(const e of this.indexes())yield[this.keyList[e],this.valList[e]]}*rentries(){for(const e of this.rindexes())yield[this.keyList[e],this.valList[e]]}*keys(){for(const e of this.indexes())yield this.keyList[e]}*rkeys(){for(const e of this.rindexes())yield this.keyList[e]}*values(){for(const e of this.indexes())yield this.valList[e]}*rvalues(){for(const e of this.rindexes())yield this.valList[e]}[Symbol.iterator](){return this.entries()}find(e,t={}){for(const i of this.indexes())if(e(this.valList[i],this.keyList[i],this))return this.get(this.keyList[i],t)}forEach(e,t=this){for(const i of this.indexes())e.call(t,this.valList[i],this.keyList[i],this)}rforEach(e,t=this){for(const i of this.rindexes())e.call(t,this.valList[i],this.keyList[i],this)}get prune(){return l("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(const t of this.rindexes({allowStale:!0}))this.isStale(t)&&(this.delete(this.keyList[t]),e=!0);return e}dump(){const e=[];for(const i of this.indexes({allowStale:!0})){const s=this.keyList[i],r=this.valList[i],n={value:this.isBackgroundFetch(r)?r.__staleWhileFetching:r};if(this.ttls){n.ttl=this.ttls[i];const e=t.now()-this.starts[i];n.start=Math.floor(Date.now()-e)}this.sizes&&(n.size=this.sizes[i]),e.unshift([s,n])}return e}load(e){this.clear();for(const[i,s]of e){if(s.start){const e=Date.now()-s.start;s.start=t.now()-e}this.set(i,s.value,s)}}dispose(e,t,i){}set(e,t,{ttl:i=this.ttl,start:s,noDisposeOnSet:r=this.noDisposeOnSet,size:n=0,sizeCalculation:a=this.sizeCalculation,noUpdateTTL:o=this.noUpdateTTL}={}){if(n=this.requireSize(e,t,n,a),this.maxEntrySize&&n>this.maxEntrySize)return this;let l=0===this.size?void 0:this.keyMap.get(e);if(void 0===l)l=this.newIndex(),this.keyList[l]=e,this.valList[l]=t,this.keyMap.set(e,l),this.next[this.tail]=l,this.prev[l]=this.tail,this.tail=l,this.size++,this.addItemSize(l,n),o=!1;else{const i=this.valList[l];t!==i&&(this.isBackgroundFetch(i)?i.__abortController.abort():r||(this.dispose(i,e,"set"),this.disposeAfter&&this.disposed.push([i,e,"set"])),this.removeItemSize(l),this.valList[l]=t,this.addItemSize(l,n)),this.moveToTail(l)}if(0===i||0!==this.ttl||this.ttls||this.initializeTTLTracking(),o||this.setItemTTL(l,i,s),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return 0===this.size?this.tail:this.size===this.max&&0!==this.max?this.evict(!1):0!==this.free.length?this.free.pop():this.initialFill++}pop(){if(this.size){const e=this.valList[this.head];return this.evict(!0),e}}evict(e){const t=this.head,i=this.keyList[t],s=this.valList[t];return this.isBackgroundFetch(s)?s.__abortController.abort():(this.dispose(s,i,"evict"),this.disposeAfter&&this.disposed.push([s,i,"evict"])),this.removeItemSize(t),e&&(this.keyList[t]=null,this.valList[t]=null,this.free.push(t)),this.head=this.next[t],this.keyMap.delete(i),this.size--,t}has(e,{updateAgeOnHas:t=this.updateAgeOnHas}={}){const i=this.keyMap.get(e);return void 0!==i&&!this.isStale(i)&&(t&&this.updateItemAge(i),!0)}peek(e,{allowStale:t=this.allowStale}={}){const i=this.keyMap.get(e);if(void 0!==i&&(t||!this.isStale(i))){const e=this.valList[i];return this.isBackgroundFetch(e)?e.__staleWhileFetching:e}}backgroundFetch(e,t,s,r){const n=void 0===t?void 0:this.valList[t];if(this.isBackgroundFetch(n))return n;const a=new i,o={signal:a.signal,options:s,context:r},l=new Promise((t=>t(this.fetchMethod(e,n,o)))).then((t=>(a.signal.aborted||this.set(e,t,o.options),t)),(i=>{if(this.valList[t]===l){!s.noDeleteOnFetchRejection||void 0===l.__staleWhileFetching?this.delete(e):this.valList[t]=l.__staleWhileFetching}if(l.__returned===l)throw i}));return l.__abortController=a,l.__staleWhileFetching=n,l.__returned=null,void 0===t?(this.set(e,l,o.options),t=this.keyMap.get(e)):this.valList[t]=l,l}isBackgroundFetch(e){return e&&"object"==typeof e&&"function"==typeof e.then&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||null===e.__returned)}async fetch(e,{allowStale:t=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,ttl:r=this.ttl,noDisposeOnSet:n=this.noDisposeOnSet,size:a=0,sizeCalculation:o=this.sizeCalculation,noUpdateTTL:l=this.noUpdateTTL,noDeleteOnFetchRejection:h=this.noDeleteOnFetchRejection,fetchContext:u=this.fetchContext,forceRefresh:c=!1}={}){if(!this.fetchMethod)return this.get(e,{allowStale:t,updateAgeOnGet:i,noDeleteOnStaleGet:s});const d={allowStale:t,updateAgeOnGet:i,noDeleteOnStaleGet:s,ttl:r,noDisposeOnSet:n,size:a,sizeCalculation:o,noUpdateTTL:l,noDeleteOnFetchRejection:h};let p=this.keyMap.get(e);if(void 0===p){const t=this.backgroundFetch(e,p,d,u);return t.__returned=t}{const s=this.valList[p];if(this.isBackgroundFetch(s))return t&&void 0!==s.__staleWhileFetching?s.__staleWhileFetching:s.__returned=s;if(!c&&!this.isStale(p))return this.moveToTail(p),i&&this.updateItemAge(p),s;const r=this.backgroundFetch(e,p,d,u);return t&&void 0!==r.__staleWhileFetching?r.__staleWhileFetching:r.__returned=r}}get(e,{allowStale:t=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet}={}){const r=this.keyMap.get(e);if(void 0!==r){const n=this.valList[r],a=this.isBackgroundFetch(n);if(this.isStale(r))return a?t?n.__staleWhileFetching:void 0:(s||this.delete(e),t?n:void 0);if(a)return;return this.moveToTail(r),i&&this.updateItemAge(r),n}}connect(e,t){this.prev[t]=e,this.next[e]=t}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return l("del","delete"),this.delete}delete(e){let t=!1;if(0!==this.size){const i=this.keyMap.get(e);if(void 0!==i)if(t=!0,1===this.size)this.clear();else{this.removeItemSize(i);const t=this.valList[i];this.isBackgroundFetch(t)?t.__abortController.abort():(this.dispose(t,e,"delete"),this.disposeAfter&&this.disposed.push([t,e,"delete"])),this.keyMap.delete(e),this.keyList[i]=null,this.valList[i]=null,i===this.tail?this.tail=this.prev[i]:i===this.head?this.head=this.next[i]:(this.next[this.prev[i]]=this.next[i],this.prev[this.next[i]]=this.prev[i]),this.size--,this.free.push(i)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return t}clear(){for(const e of this.rindexes({allowStale:!0})){const t=this.valList[e];if(this.isBackgroundFetch(t))t.__abortController.abort();else{const i=this.keyList[e];this.dispose(t,i,"delete"),this.disposeAfter&&this.disposed.push([t,i,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return l("reset","clear"),this.clear}get length(){return((e,t)=>{const i=`LRU_CACHE_PROPERTY_${e}`;if(u(i)){const{prototype:s}=m,{get:r}=Object.getOwnPropertyDescriptor(s,e);c(i,`${e} property`,`cache.${t}`,r)}})("length","size"),this.size}static get AbortController(){return i}static get AbortSignal(){return n}}e.exports=m},60699:(e,t,i)=>{"use strict";i.d(t,{aZ:()=>j,Ip:()=>q,Ki:()=>N,v3:()=>V,vU:()=>W,f0:()=>ue,M5:()=>he,wi:()=>R,lX:()=>U,mW:()=>B,yY:()=>F,hT:()=>Y,Tm:()=>I,pQ:()=>M,XT:()=>D,xb:()=>K,z5:()=>ae,Zm:()=>oe,m$:()=>ne,m0:()=>G,e8:()=>le,uM:()=>J,tz:()=>re,IJ:()=>Z,JW:()=>ce,iy:()=>ee,On:()=>X,Wc:()=>H,Om:()=>te,vD:()=>z,nv:()=>ie,m6:()=>se,yN:()=>L,E2:()=>A});var s=i(26048),r=i(36179);let n=0;class a{constructor(e,t,i){this.set=e,this.base=t,this.modified=i,this.id=n++}static define(e){if(null==e?void 0:e.base)throw new Error("Can not derive from a modified tag");let t=new a([],null,[]);if(t.set.push(t),e)for(let i of e.set)t.set.push(i);return t}static defineModifier(){let e=new l;return t=>t.modified.indexOf(e)>-1?t:l.get(t.base||t,t.modified.concat(e).sort(((e,t)=>e.id-t.id)))}}let o=0;class l{constructor(){this.instances=[],this.id=o++}static get(e,t){if(!t.length)return e;let i=t[0].instances.find((i=>{return i.base==e&&(s=t,r=i.modified,s.length==r.length&&s.every(((e,t)=>e==r[t])));var s,r}));if(i)return i;let s=[],r=new a(s,e,t);for(let e of t)e.instances.push(r);let n=h(t);for(let t of e.set)for(let e of n)s.push(l.get(t,e));return r}}function h(e){let t=[e];for(let i=0;i<e.length;i++)for(let s of h(e.slice(0,i).concat(e.slice(i+1))))t.push(s);return t}const u=new r.md;class c{constructor(e,t,i,s){this.tags=e,this.mode=t,this.context=i,this.next=s}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}const d=a.define,p=d(),f=d(),g=d(f),m=d(f),y=d(),O=d(y),v=d(y),x=d(),b=d(x),k=d(),$=d(),w=d(),_=d(w),P=d(),S={comment:p,lineComment:d(p),blockComment:d(p),docComment:d(p),name:f,variableName:d(f),typeName:g,tagName:d(g),propertyName:m,attributeName:d(m),className:d(f),labelName:d(f),namespace:d(f),macroName:d(f),literal:y,string:O,docString:d(O),character:d(O),attributeValue:d(O),number:v,integer:d(v),float:d(v),bool:d(y),regexp:d(y),escape:d(y),color:d(y),url:d(y),keyword:k,self:d(k),null:d(k),atom:d(k),unit:d(k),modifier:d(k),operatorKeyword:d(k),controlKeyword:d(k),definitionKeyword:d(k),moduleKeyword:d(k),operator:$,derefOperator:d($),arithmeticOperator:d($),logicOperator:d($),bitwiseOperator:d($),compareOperator:d($),updateOperator:d($),definitionOperator:d($),typeOperator:d($),controlOperator:d($),punctuation:w,separator:d(w),bracket:_,angleBracket:d(_),squareBracket:d(_),paren:d(_),brace:d(_),content:x,heading:b,heading1:d(b),heading2:d(b),heading3:d(b),heading4:d(b),heading5:d(b),heading6:d(b),contentSeparator:d(x),list:d(x),quote:d(x),emphasis:d(x),strong:d(x),link:d(x),monospace:d(x),strikethrough:d(x),inserted:d(),deleted:d(),changed:d(),invalid:d(),meta:P,documentMeta:d(P),annotation:d(P),processingInstruction:d(P),definition:a.defineModifier(),constant:a.defineModifier(),function:a.defineModifier(),standard:a.defineModifier(),local:a.defineModifier(),special:a.defineModifier()},C=(function(e,t){let i=Object.create(null);for(let t of e)if(Array.isArray(t.tag))for(let e of t.tag)i[e.id]=t.class;else i[t.tag.id]=t.class;let{scope:s,all:r=null}=t||{}}([{tag:S.link,class:"tok-link"},{tag:S.heading,class:"tok-heading"},{tag:S.emphasis,class:"tok-emphasis"},{tag:S.strong,class:"tok-strong"},{tag:S.keyword,class:"tok-keyword"},{tag:S.atom,class:"tok-atom"},{tag:S.bool,class:"tok-bool"},{tag:S.url,class:"tok-url"},{tag:S.labelName,class:"tok-labelName"},{tag:S.inserted,class:"tok-inserted"},{tag:S.deleted,class:"tok-deleted"},{tag:S.literal,class:"tok-literal"},{tag:S.string,class:"tok-string"},{tag:S.number,class:"tok-number"},{tag:[S.regexp,S.escape,S.special(S.string)],class:"tok-string2"},{tag:S.variableName,class:"tok-variableName"},{tag:S.local(S.variableName),class:"tok-variableName tok-local"},{tag:S.definition(S.variableName),class:"tok-variableName tok-definition"},{tag:S.special(S.variableName),class:"tok-variableName2"},{tag:S.definition(S.propertyName),class:"tok-propertyName tok-definition"},{tag:S.typeName,class:"tok-typeName"},{tag:S.namespace,class:"tok-namespace"},{tag:S.className,class:"tok-className"},{tag:S.macroName,class:"tok-macroName"},{tag:S.propertyName,class:"tok-propertyName"},{tag:S.operator,class:"tok-operator"},{tag:S.comment,class:"tok-comment"},{tag:S.meta,class:"tok-meta"},{tag:S.invalid,class:"tok-invalid"},{tag:S.punctuation,class:"tok-punctuation"}]),{inf:147,nan:148,bool:1,ignoring:2,on:3,group_left:4,group_right:5,offset:6}),Q={avg:8,atan2:7,bottomk:9,count:10,count_values:11,group:12,max:13,min:14,quantile:15,stddev:16,stdvar:17,sum:18,topk:19,by:20,without:21,and:22,or:23,unless:24,start:25,end:26},T=function(e){let t=Object.create(null);for(let i in e){let s=e[i];Array.isArray(s)||(s=[s]);for(let e of i.split(" "))if(e){let i=[],r=2,n=e;for(let t=0;;){if("..."==n&&t>0&&t+3==e.length){r=1;break}let s=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(n);if(!s)throw new RangeError("Invalid path: "+e);if(i.push("*"==s[0]?"":'"'==s[0][0]?JSON.parse(s[0]):s[0]),t+=s[0].length,t==e.length)break;let a=e[t++];if(t==e.length&&"!"==a){r=0;break}if("/"!=a)throw new RangeError("Invalid path: "+e);n=e.slice(t)}let a=i.length-1,o=i[a];if(!o)throw new RangeError("Invalid path: "+e);let l=new c(s,r,a>0?i.slice(0,a):null);t[o]=l.sort(t[o])}}return u.add(t)}({LineComment:S.comment,LabelName:S.labelName,StringLiteral:S.string,NumberLiteral:S.number,Duration:S.number,"Abs Absent AbsentOverTime Acos Acosh Asin Asinh Atan Atanh AvgOverTime Ceil Changes Clamp ClampMax ClampMin Cos Cosh CountOverTime DaysInMonth DayOfMonth DayOfWeek DayOfYear Deg Delta Deriv Exp Floor HistogramQuantile HoltWinters Hour Idelta Increase Irate LabelReplace LabelJoin LastOverTime Ln Log10 Log2 MaxOverTime MinOverTime Minute Month Pi PredictLinear PresentOverTime QuantileOverTime Rad Rate Resets Round Scalar Sgn Sin Sinh Sort SortDesc Sqrt StddevOverTime StdvarOverTime SumOverTime Tan Tanh Time Timestamp Vector Year":S.function(S.variableName),"Avg Bottomk Count Count_values Group Max Min Quantile Stddev Stdvar Sum Topk":S.operatorKeyword,"By Without Bool On Ignoring GroupLeft GroupRight Offset Start End":S.modifier,"And Unless Or":S.logicOperator,"Sub Add Mul Mod Div Atan2 Eql Neq Lte Lss Gte Gtr EqlRegex EqlSingle NeqRegex Pow At":S.operator,UnaryOp:S.arithmeticOperator,"( )":S.paren,"[ ]":S.squareBracket,"{ }":S.brace,"":S.invalid}),E={__proto__:null,absent_over_time:309,absent:311,abs:313,acos:315,acosh:317,asin:319,asinh:321,atan:323,atanh:325,avg_over_time:327,ceil:329,changes:331,clamp:333,clamp_max:335,clamp_min:337,cos:339,cosh:341,count_over_time:343,days_in_month:345,day_of_month:347,day_of_week:349,day_of_year:351,deg:353,delta:355,deriv:357,exp:359,floor:361,histogram_quantile:363,holt_winters:365,hour:367,idelta:369,increase:371,irate:373,label_replace:375,label_join:377,last_over_time:379,ln:381,log10:383,log2:385,max_over_time:387,min_over_time:389,minute:391,month:393,pi:395,predict_linear:397,present_over_time:399,quantile_over_time:401,rad:403,rate:405,resets:407,round:409,scalar:411,sgn:413,sin:415,sinh:417,sort:419,sort_desc:421,sqrt:423,stddev_over_time:425,stdvar_over_time:427,sum_over_time:429,tan:431,tanh:433,timestamp:435,time:437,vector:439,year:441},A=s.WQ.deserialize({version:14,states:"6bOYQPOOO'OQPOOOOQO'#C{'#C{O'TQPO'#CzQ'`QQOOOOQO'#De'#DeO'ZQPO'#DdOOQO'#FO'#FOO(mQPO'#FUOYQPO'#FQOYQPO'#FTOOQO'#FW'#FWO.lQSO'#FXO.tQQO'#FVOOQO'#FV'#FVOOQO'#Cy'#CyOOQO'#Df'#DfOOQO'#Dh'#DhOOQO'#Di'#DiOOQO'#Dj'#DjOOQO'#Dk'#DkOOQO'#Dl'#DlOOQO'#Dm'#DmOOQO'#Dn'#DnOOQO'#Do'#DoOOQO'#Dp'#DpOOQO'#Dq'#DqOOQO'#Dr'#DrOOQO'#Ds'#DsOOQO'#Dt'#DtOOQO'#Du'#DuOOQO'#Dv'#DvOOQO'#Dw'#DwOOQO'#Dx'#DxOOQO'#Dy'#DyOOQO'#Dz'#DzOOQO'#D{'#D{OOQO'#D|'#D|OOQO'#D}'#D}OOQO'#EO'#EOOOQO'#EP'#EPOOQO'#EQ'#EQOOQO'#ER'#EROOQO'#ES'#ESOOQO'#ET'#ETOOQO'#EU'#EUOOQO'#EV'#EVOOQO'#EW'#EWOOQO'#EX'#EXOOQO'#EY'#EYOOQO'#EZ'#EZOOQO'#E['#E[OOQO'#E]'#E]OOQO'#E^'#E^OOQO'#E_'#E_OOQO'#E`'#E`OOQO'#Ea'#EaOOQO'#Eb'#EbOOQO'#Ec'#EcOOQO'#Ed'#EdOOQO'#Ee'#EeOOQO'#Ef'#EfOOQO'#Eg'#EgOOQO'#Eh'#EhOOQO'#Ei'#EiOOQO'#Ej'#EjOOQO'#Ek'#EkOOQO'#El'#ElOOQO'#Em'#EmOOQO'#En'#EnOOQO'#Eo'#EoOOQO'#Ep'#EpOOQO'#Eq'#EqOOQO'#Er'#ErOOQO'#Es'#EsOOQO'#Et'#EtOOQO'#Eu'#EuOOQO'#Ev'#EvOOQO'#Ew'#EwOOQO'#Ex'#ExOOQO'#Ey'#EyOOQO'#Ez'#EzOOQO'#E{'#E{QOQPOOO0_QPO'#C|O0dQPO'#DRO'ZQPO,59fO0kQQO,59fO2XQPO,59oO2XQPO,59oO2XQPO,59oO2XQPO,59oO2XQPO,59oO8WQQO,5;hO8]QQO,5;kO8eQPO,5;zOOQO,5:O,5:OOOQO,5;j,5;jO8|QQO,5;lO9TQQO,5;oO:kQPO'#FZO:yQPO,5;sOOQO'#FY'#FYOOQO,5;s,5;sOOQO,5;q,5;qO;RQSO'#C}OOQO,59h,59hO;ZQPO,59mO;cQQO'#DSOOQO,59m,59mOOQO1G/Q1G/QO0_QPO'#DWOAcQPO'#DVOAmQPO'#DVOYQPO1G/ZOYQPO1G/ZOYQPO1G/ZOYQPO1G/ZOYQPO1G/ZOAwQSO1G1SOOQO1G1V1G1VOBPQQO1G1VOBUQPO'#FOOOQO'#Fb'#FbOOQO1G1f1G1fOBaQPO1G1fOOQO1G1W1G1WOOQO'#F['#F[OBfQPO,5;uOBkQSO1G1_OOQO1G1_1G1_OOQO'#DP'#DPOBsQPO,59iOOQO'#DO'#DOOOQO,59i,59iOYQPO,59nOOQO1G/X1G/XOOQO,59r,59rOHnQPO,59qOHuQPO,59qOJ^QQO7+$uOJnQQO7+$uOLSQQO7+$uOLjQQO7+$uONRQQO7+$uOOQO7+&n7+&nONlQQO7+&tOOQO7+&q7+&qONtQPO7+'QOOQO1G1a1G1aOOQO1G1`1G1`OOQO7+&y7+&yONyQSO1G/TOOQO1G/T1G/TO! RQQO1G/YOOQO1G/]1G/]O! ]QPO1G/]OOQO<<J`<<J`O!'RQPO<<J`OOQO<<Jl<<JlOOQO1G/U1G/UOOQO7+$o7+$oOOQO7+$w7+$wOOQOAN?zAN?z",stateData:"!'W~O$[OSkOS~OWQOXQOYQOZQO[QO]QO^QO_QO`QOaQObQOcQO!ZZO#u_O$XVO$YVO$]XO$``O$aaO$bbO$ccO$ddO$eeO$ffO$ggO$hhO$iiO$jjO$kkO$llO$mmO$nnO$ooO$ppO$qqO$rrO$ssO$ttO$uuO$vvO$wwO$xxO$yyO$zzO${{O$||O$}}O%O!OO%P!PO%Q!QO%R!RO%S!SO%T!TO%U!UO%V!VO%W!WO%X!XO%Y!YO%Z!ZO%[![O%]!]O%^!^O%_!_O%`!`O%a!aO%b!bO%c!cO%d!dO%e!eO%f!fO%g!gO%h!hO%i!iO%j!jO%k!kO%l!lO%m!mO%n!nO%o!oO%p!pO%q!qO%r!rO%s!sO%t!tO%wWO%xWO%yVO%{[O~O!ZZO~Od!vOe!vO$]!wO~OU#QOV!zOf!}Og#OOh!}Ox!zO{!zO|!zO}!zO!O!{O!P!{O!Q!|O!R!|O!S!|O!T!|O!U!|O!V!|O$T#RO%u#PO~O$X#TO$Y#TO%y#TOW#xXX#xXY#xXZ#xX[#xX]#xX^#xX_#xX`#xXa#xXb#xXc#xX!Z#xX#u#xX$X#xX$Y#xX$]#xX$`#xX$a#xX$b#xX$c#xX$d#xX$e#xX$f#xX$g#xX$h#xX$i#xX$j#xX$k#xX$l#xX$m#xX$n#xX$o#xX$p#xX$q#xX$r#xX$s#xX$t#xX$u#xX$v#xX$w#xX$x#xX$y#xX$z#xX${#xX$|#xX$}#xX%O#xX%P#xX%Q#xX%R#xX%S#xX%T#xX%U#xX%V#xX%W#xX%X#xX%Y#xX%Z#xX%[#xX%]#xX%^#xX%_#xX%`#xX%a#xX%b#xX%c#xX%d#xX%e#xX%f#xX%g#xX%h#xX%i#xX%j#xX%k#xX%l#xX%m#xX%n#xX%o#xX%p#xX%q#xX%r#xX%s#xX%t#xX%w#xX%x#xX%y#xX%{#xX~Ot#WO%|#ZO~O%{[OU#yXV#yXf#yXg#yXh#yXx#yX{#yX|#yX}#yX!O#yX!P#yX!Q#yX!R#yX!S#yX!T#yX!U#yX!V#yX$T#yX$W#yX%u#yX$_#yX$^#yX~O$]#]O~O$_#aO~PYOd!vOe!vOUnaVnafnagnahnaxna{na|na}na!Ona!Pna!Qna!Rna!Sna!Tna!Una!Vna$Tna$Wna%una$_na$^na~OP#eOQ#cOR#cOWyPXyPYyPZyP[yP]yP^yP_yP`yPayPbyPcyP!ZyP#uyP$XyP$YyP$]yP$`yP$ayP$byP$cyP$dyP$eyP$fyP$gyP$hyP$iyP$jyP$kyP$lyP$myP$nyP$oyP$pyP$qyP$ryP$syP$tyP$uyP$vyP$wyP$xyP$yyP$zyP${yP$|yP$}yP%OyP%PyP%QyP%RyP%SyP%TyP%UyP%VyP%WyP%XyP%YyP%ZyP%[yP%]yP%^yP%_yP%`yP%ayP%byP%cyP%dyP%eyP%fyP%gyP%hyP%iyP%jyP%kyP%lyP%myP%nyP%oyP%pyP%qyP%ryP%syP%tyP%wyP%xyP%yyP%{yP~O#q#kO~O!P#mO#q#lO~Oi#oOj#oO$XVO$YVO%w#nO%x#nO%yVO~O$_#rO~P'`Ox!zOU#waV#waf#wag#wah#wa{#wa|#wa}#wa!O#wa!P#wa!Q#wa!R#wa!S#wa!T#wa!U#wa!V#wa$T#wa$W#wa%u#wa$_#wa$^#wa~O!V#sO$P#sO$Q#sO$R#sO~O$^#uO%|#vO~Ot#wO$_#zO~O$^#{O$_#|O~O$^vX$_vX~P'`OWyXXyXYyXZyX[yX]yX^yX_yX`yXayXbyXcyX!ZyX#uyX$XyX$YyX$]yX$`yX$ayX$byX$cyX$dyX$eyX$fyX$gyX$hyX$iyX$jyX$kyX$lyX$myX$nyX$oyX$pyX$qyX$ryX$syX$tyX$uyX$vyX$wyX$xyX$yyX$zyX${yX$|yX$}yX%OyX%PyX%QyX%RyX%SyX%TyX%UyX%VyX%WyX%XyX%YyX%ZyX%[yX%]yX%^yX%_yX%`yX%ayX%byX%cyX%dyX%eyX%fyX%gyX%hyX%iyX%jyX%kyX%lyX%myX%nyX%oyX%pyX%qyX%ryX%syX%tyX%wyX%xyX%yyX%{yX~OS$OOT$OO~P;mOQ#cOR#cO~P;mO%v$VO%z$WO~O#q$XO~O$X#TO$Y#TO%y#TO~O$]$YO~O#u$ZO~Ot#WO%|$]O~O$^$^O$_$_O~OWyaXyaYyaZya[ya]ya^ya_ya`yaayabyacya!Zya#uya$Xya$Yya$`ya$aya$bya$cya$dya$eya$fya$gya$hya$iya$jya$kya$lya$mya$nya$oya$pya$qya$rya$sya$tya$uya$vya$wya$xya$yya$zya${ya$|ya$}ya%Oya%Pya%Qya%Rya%Sya%Tya%Uya%Vya%Wya%Xya%Yya%Zya%[ya%]ya%^ya%_ya%`ya%aya%bya%cya%dya%eya%fya%gya%hya%iya%jya%kya%lya%mya%nya%oya%pya%qya%rya%sya%tya%wya%xya%yya%{ya~O$]#]O~PB{OS$bOT$bO$]ya~PB{Ox!zOUwqfwqgwqhwq!Owq!Pwq!Qwq!Rwq!Swq!Twq!Uwq!Vwq$Twq$Wwq%uwq$_wq$^wq~OVwq{wq|wq}wq~PISOV!zO{!zO|!zO}!zO~PISOV!zOx!zO{!zO|!zO}!zO!O!{O!P!{OUwqfwqgwqhwq$Twq$Wwq%uwq$_wq$^wq~O!Qwq!Rwq!Swq!Twq!Uwq!Vwq~PKOO!Q!|O!R!|O!S!|O!T!|O!U!|O!V!|O~PKOOV!zOf!}Oh!}Ox!zO{!zO|!zO}!zO!O!{O!P!{O!Q!|O!R!|O!S!|O!T!|O!U!|O!V!|O~OUwqgwq$Twq$Wwq%uwq$_wq$^wq~PMQO#q$dO%v$cO~O$_$eO~Ot#wO$_$gO~O$^vi$_vi~P'`O$]#]OWyiXyiYyiZyi[yi]yi^yi_yi`yiayibyicyi!Zyi#uyi$Xyi$Yyi$`yi$ayi$byi$cyi$dyi$eyi$fyi$gyi$hyi$iyi$jyi$kyi$lyi$myi$nyi$oyi$pyi$qyi$ryi$syi$tyi$uyi$vyi$wyi$xyi$yyi$zyi${yi$|yi$}yi%Oyi%Pyi%Qyi%Ryi%Syi%Tyi%Uyi%Vyi%Wyi%Xyi%Yyi%Zyi%[yi%]yi%^yi%_yi%`yi%ayi%byi%cyi%dyi%eyi%fyi%gyi%hyi%iyi%jyi%kyi%lyi%myi%nyi%oyi%pyi%qyi%ryi%syi%tyi%wyi%xyi%yyi%{yi~O%v$iO~O",goto:"(v$VPPPPPPPPPPPPPPPPPPPPPPPPPPPPP$W$v%S%`%f%r%uP%{&U$vP&X&hPPPPPPPPPPP$v&r'OP'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O$vP'[$v$vP$v$v'k$v'w(W(g(j(pPPP$vP(sQSOQ#UXQ#VYQ#`!wQ$Q#fQ$R#gQ$S#hQ$T#iQ$U#jR$`#{e_OXY!w#f#g#h#i#j#{eROXY!w#f#g#h#i#j#{Q!xRR#b!yQ#^!vQ#}#cQ$a$OR$h$bR#x#]Q#y#]R$f$^Q!yRQ#SUR#b!xR#_!wQ#f!zQ#g!{Q#h!|Q#i!}R#j#OY#d!z!{!|!}#OR$P#eeUOXY!w#f#g#h#i#j#{eTOXY!w#f#g#h#i#j#{d_OXY!w#f#g#h#i#j#{R#p#ReYOXY!w#f#g#h#i#j#{d]OXY!w#f#g#h#i#j#{R!uPd^OXY!w#f#g#h#i#j#{R#[]R#X[Q#Y[R$[#uR#t#WR#q#R",nodeNames:" Bool Ignoring On GroupLeft GroupRight Offset Atan2 Avg Bottomk Count CountValues Group Max Min Quantile Stddev Stdvar Sum Topk By Without And Or Unless Start End LineComment PromQL Expr AggregateExpr AggregateOp AggregateModifier GroupingLabels GroupingLabelList GroupingLabel LabelName FunctionCallBody FunctionCallArgs BinaryExpr Pow BinModifiers OnOrIgnoring Mul Div Mod Add Sub Eql Gte Gtr Lte Lss Neq FunctionCall FunctionIdentifier AbsentOverTime Identifier Absent Abs Acos Acosh Asin Asinh Atan Atanh AvgOverTime Ceil Changes Clamp ClampMax ClampMin Cos Cosh CountOverTime DaysInMonth DayOfMonth DayOfWeek DayOfYear Deg Delta Deriv Exp Floor HistogramQuantile HoltWinters Hour Idelta Increase Irate LabelReplace LabelJoin LastOverTime Ln Log10 Log2 MaxOverTime MinOverTime Minute Month Pi PredictLinear PresentOverTime QuantileOverTime Rad Rate Resets Round Scalar Sgn Sin Sinh Sort SortDesc Sqrt StddevOverTime StdvarOverTime SumOverTime Tan Tanh Timestamp Time Vector Year MatrixSelector Duration NumberLiteral OffsetExpr ParenExpr StringLiteral SubqueryExpr UnaryExpr UnaryOp VectorSelector MetricIdentifier LabelMatchers LabelMatchList LabelMatcher MatchOp EqlSingle EqlRegex NeqRegex StepInvariantExpr At AtModifierPreprocessors MetricName",maxTerm:228,propSources:[T],skippedNodes:[0,27],repeatNodeCount:0,tokenData:"1R~RwX^#lpq#lqr$ars$tst%huv%swx%xxy&gyz&lz{&q{|&v|}&}}!O'S!O!P'Z!P!Q(Z!Q!R(`!R![)W![!]-r!^!_.n!_!`.{!`!a/b!b!c/o!c!}/t!}#O0[#P#Q0a#Q#R0f#R#S/t#S#T0k#T#o/t#o#p0w#q#r0|#y#z#l$f$g#l#BY#BZ#l$IS$I_#l$I|$JO#l$JT$JU#l$KV$KW#l&FU&FV#l~#qY$[~X^#lpq#l#y#z#l$f$g#l#BY#BZ#l$IS$I_#l$I|$JO#l$JT$JU#l$KV$KW#l&FU&FV#l~$dQ!_!`$j#r#s$o~$oO!V~~$tO$R~~$yU#u~OY$tZr$trs%]s#O$t#O#P%b#P~$t~%bO#u~~%ePO~$t~%mQk~OY%hZ~%h~%xO}~~%}U#u~OY%xZw%xwx%]x#O%x#O#P&a#P~%x~&dPO~%x~&lO$]~~&qO$_~~&vO{~R&}O%xP!OQ~'SO$^~R'ZO%wP!PQP'^P!Q!['aP'fR%yP!Q!['a!g!h'o#X#Y'oP'rR{|'{}!O'{!Q![(RP(OP!Q![(RP(WP%yP!Q![(R~(`O|~R(eZ%yP!O!P'a!Q![)W!g!h'o#W#X){#X#Y'o#[#]*d#a#b*x#g#h+l#k#l+}#l#m-W#m#n,iR)]Y%yP!O!P'a!Q![)W!g!h'o#W#X){#X#Y'o#[#]*d#a#b*x#g#h+l#k#l+}#m#n,iQ*QP#qQ!Q![*TQ*WS!Q![*T#[#]*d#a#b*x#g#h+lQ*iP#qQ!Q![*lQ*oR!Q![*l#a#b*x#g#h+lQ*}Q#qQ!Q![+T#g#h+gQ+WR!Q![+T#a#b+a#g#h+lQ+dP#g#h+gQ+lO#qQQ+qP#qQ!Q![+tQ+wQ!Q![+t#a#b+aQ,SP#qQ!Q![,VQ,YT!Q![,V#W#X){#[#]*d#a#b*x#g#h+lQ,nP#qQ!Q![,qQ,tU!Q![,q#W#X){#[#]*d#a#b*x#g#h+l#k#l+}P-ZR!Q![-d!c!i-d#T#Z-dP-iR%yP!Q![-d!c!i-d#T#Z-dV-yT%zS!ZR!Q![.Y![!].Y!c!}.Y#R#S.Y#T#o.YR._T!ZR!Q![.Y![!].Y!c!}.Y#R#S.Y#T#o.Y~.sP!U~!_!`.v~.{O!T~~/QQ$PP!_!`/W#r#s/]Q/]O!QQ~/bO$Q~~/gP!S~!_!`/j~/oO!R~~/tO$T~V/{T!ZRtS!Q![/t![!].Y!c!}/t#R#S/t#T#o/t~0aO%u~~0fO%v~~0kOx~~0nRO#S0k#S#T%]#T~0k~0|O%{~~1RO%|~",tokenizers:[0,1,2],topRules:{PromQL:[0,28],MetricName:[1,145]},specialized:[{term:57,get:(e,t)=>((e,t)=>C[e.toLowerCase()]||-1)(e)<<1},{term:57,get:(e,t)=>((e,t)=>Q[e.toLowerCase()]||-1)(e)<<1|1},{term:57,get:e=>E[e]||-1}],tokenPrec:0}),X=3,L=21,z=28,R=29,j=30,N=31,q=32,D=33,M=34,I=35,G=36,F=37,B=38,W=39,V=41,H=42,Z=53,U=54,Y=55,K=57,J=124,ee=126,te=128,ie=129,se=133,re=134,ne=135,ae=136,oe=137,le=138,he=139,ue=140,ce=141},36179:(e,t,i)=>{"use strict";i.d(t,{Jq:()=>l,L3:()=>s,Lj:()=>h,_b:()=>Q,md:()=>a,mp:()=>p,vj:()=>d});const s=1024;let r=0;class n{constructor(e,t){this.from=e,this.to=t}}class a{constructor(e={}){this.id=r++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof e&&(e=l.match(e)),t=>{let i=e(t);return void 0===i?null:[this,i]}}}a.closedBy=new a({deserialize:e=>e.split(" ")}),a.openedBy=new a({deserialize:e=>e.split(" ")}),a.group=new a({deserialize:e=>e.split(" ")}),a.contextHash=new a({perNode:!0}),a.lookAhead=new a({perNode:!0}),a.mounted=new a({perNode:!0});const o=Object.create(null);class l{constructor(e,t,i,s=0){this.name=e,this.props=t,this.id=i,this.flags=s}static define(e){let t=e.props&&e.props.length?Object.create(null):o,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(null==e.name?8:0),s=new l(e.name||"",t,e.id,i);if(e.props)for(let i of e.props)if(Array.isArray(i)||(i=i(s)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[i[0].id]=i[1]}return s}prop(e){return this.props[e.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(e){if("string"==typeof e){if(this.name==e)return!0;let t=this.prop(a.group);return!!t&&t.indexOf(e)>-1}return this.id==e}static match(e){let t=Object.create(null);for(let i in e)for(let s of i.split(" "))t[s]=e[i];return e=>{for(let i=e.prop(a.group),s=-1;s<(i?i.length:0);s++){let r=t[s<0?e.name:i[s]];if(r)return r}}}}l.none=new l("",Object.create(null),0,8);class h{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let i of this.types){let s=null;for(let t of e){let e=t(i);e&&(s||(s=Object.assign({},i.props)),s[e[0].id]=e[1])}t.push(s?new l(i.name,s,i.id,i.flags):i)}return new h(t)}}const u=new WeakMap,c=new WeakMap;var d;!function(e){e[e.ExcludeBuffers=1]="ExcludeBuffers",e[e.IncludeAnonymous=2]="IncludeAnonymous",e[e.IgnoreMounts=4]="IgnoreMounts",e[e.IgnoreOverlays=8]="IgnoreOverlays"}(d||(d={}));class p{constructor(e,t,i,s,r){if(this.type=e,this.children=t,this.positions=i,this.length=s,this.props=null,r&&r.length){this.props=Object.create(null);for(let[e,t]of r)this.props["number"==typeof e?e:e.id]=t}}toString(){let e=this.prop(a.mounted);if(e&&!e.overlay)return e.tree.toString();let t="";for(let e of this.children){let i=e.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new w(this.topNode,e)}cursorAt(e,t=0,i=0){let s=u.get(this)||this.topNode,r=new w(s);return r.moveTo(e,t),u.set(this,r._tree),r}get topNode(){return new v(this,0,0,null)}resolve(e,t=0){let i=O(u.get(this)||this.topNode,e,t,!1);return u.set(this,i),i}resolveInner(e,t=0){let i=O(c.get(this)||this.topNode,e,t,!0);return c.set(this,i),i}iterate(e){let{enter:t,leave:i,from:s=0,to:r=this.length}=e;for(let n=this.cursor((e.mode||0)|d.IncludeAnonymous);;){let e=!1;if(n.from<=r&&n.to>=s&&(n.type.isAnonymous||!1!==t(n))){if(n.firstChild())continue;e=!0}for(;e&&i&&!n.type.isAnonymous&&i(n),!n.nextSibling();){if(!n.parent())return;e=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:C(l.none,this.children,this.positions,0,this.children.length,0,this.length,((e,t,i)=>new p(this.type,e,t,i,this.propValues)),e.makeTree||((e,t,i)=>new p(l.none,e,t,i)))}static build(e){return function(e){var t;let{buffer:i,nodeSet:r,maxBufferLength:n=s,reused:o=[],minRepeatType:l=r.types.length}=e,h=Array.isArray(i)?new f(i,i.length):i,u=r.types,c=0,d=0;function m(e,t,i,s,a){let{id:p,start:f,end:k,size:$}=h,w=d;for(;$<0;){if(h.next(),-1==$){let t=o[p];return i.push(t),void s.push(f-e)}if(-3==$)return void(c=p);if(-4==$)return void(d=p);throw new RangeError(`Unrecognized record size: ${$}`)}let _,P,S=u[p],Q=f-e;if(k-f<=n&&(P=x(h.pos-t,a))){let t=new Uint16Array(P.size-P.skip),i=h.pos-P.size,s=t.length;for(;h.pos>i;)s=b(P.start,t,s);_=new g(t,k-P.start,r),Q=P.start-e}else{let e=h.pos-$;h.next();let t=[],i=[],s=p>=l?p:-1,r=0,a=k;for(;h.pos>e;)s>=0&&h.id==s&&h.size>=0?(h.end<=a-n&&(O(t,i,f,r,h.end,a,s,w),r=t.length,a=h.end),h.next()):m(f,e,t,i,s);if(s>=0&&r>0&&r<t.length&&O(t,i,f,r,f,a,s,w),t.reverse(),i.reverse(),s>-1&&r>0){let e=y(S);_=C(S,t,i,0,t.length,0,k-f,e,e)}else _=v(S,t,i,k-f,w-k)}i.push(_),s.push(Q)}function y(e){return(t,i,s)=>{let r,n,o=0,l=t.length-1;if(l>=0&&(r=t[l])instanceof p){if(!l&&r.type==e&&r.length==s)return r;(n=r.prop(a.lookAhead))&&(o=i[l]+r.length+n)}return v(e,t,i,s,o)}}function O(e,t,i,s,n,a,o,l){let h=[],u=[];for(;e.length>s;)h.push(e.pop()),u.push(t.pop()+i-n);e.push(v(r.types[o],h,u,a-n,l-a)),t.push(n-i)}function v(e,t,i,s,r=0,n){if(c){let e=[a.contextHash,c];n=n?[e].concat(n):[e]}if(r>25){let e=[a.lookAhead,r];n=n?[e].concat(n):[e]}return new p(e,t,i,s,n)}function x(e,t){let i=h.fork(),s=0,r=0,a=0,o=i.end-n,u={size:0,start:0,skip:0};e:for(let n=i.pos-e;i.pos>n;){let e=i.size;if(i.id==t&&e>=0){u.size=s,u.start=r,u.skip=a,a+=4,s+=4,i.next();continue}let h=i.pos-e;if(e<0||h<n||i.start<o)break;let c=i.id>=l?4:0,d=i.start;for(i.next();i.pos>h;){if(i.size<0){if(-3!=i.size)break e;c+=4}else i.id>=l&&(c+=4);i.next()}r=d,s+=e,a+=c}return(t<0||s==e)&&(u.size=s,u.start=r,u.skip=a),u.size>4?u:void 0}function b(e,t,i){let{id:s,start:r,end:n,size:a}=h;if(h.next(),a>=0&&s<l){let o=i;if(a>4){let s=h.pos-(a-4);for(;h.pos>s;)i=b(e,t,i)}t[--i]=o,t[--i]=n-e,t[--i]=r-e,t[--i]=s}else-3==a?c=s:-4==a&&(d=s);return i}let k=[],$=[];for(;h.pos>0;)m(e.start||0,e.bufferStart||0,k,$,-1);let w=null!==(t=e.length)&&void 0!==t?t:k.length?$[0]+k[0].length:0;return new p(u[e.topID],k.reverse(),$.reverse(),w)}(e)}}p.empty=new p(l.none,[],[],0);class f{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new f(this.buffer,this.index)}}class g{constructor(e,t,i){this.buffer=e,this.length=t,this.set=i}get type(){return l.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],i=this.buffer[e+3],s=this.set.types[t],r=s.name;if(/\W/.test(r)&&!s.isError&&(r=JSON.stringify(r)),i==(e+=4))return r;let n=[];for(;e<i;)n.push(this.childString(e)),e=this.buffer[e+3];return r+"("+n.join(",")+")"}findChild(e,t,i,s,r){let{buffer:n}=this,a=-1;for(let o=e;o!=t&&!(m(r,s,n[o+1],n[o+2])&&(a=o,i>0));o=n[o+3]);return a}slice(e,t,i,s){let r=this.buffer,n=new Uint16Array(t-e);for(let s=e,a=0;s<t;)n[a++]=r[s++],n[a++]=r[s++]-i,n[a++]=r[s++]-i,n[a++]=r[s++]-e;return new g(n,s-i,this.set)}}function m(e,t,i,s){switch(e){case-2:return i<t;case-1:return s>=t&&i<t;case 0:return i<t&&s>t;case 1:return i<=t&&s>t;case 2:return s>t;case 4:return!0}}function y(e,t){let i=e.childBefore(t);for(;i;){let t=i.lastChild;if(!t||t.to!=i.to)break;t.type.isError&&t.from==t.to?(e=i,i=t.prevSibling):i=t}return e}function O(e,t,i,s){for(var r;e.from==e.to||(i<1?e.from>=t:e.from>t)||(i>-1?e.to<=t:e.to<t);){let t=!s&&e instanceof v&&e.index<0?null:e.parent;if(!t)return e;e=t}let n=s?0:d.IgnoreOverlays;if(s)for(let s=e,a=s.parent;a;s=a,a=s.parent)s instanceof v&&s.index<0&&(null===(r=a.enter(t,i,n))||void 0===r?void 0:r.from)!=s.from&&(e=a);for(;;){let s=e.enter(t,i,n);if(!s)return e;e=s}}class v{constructor(e,t,i,s){this._tree=e,this.from=t,this.index=i,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,i,s,r=0){for(let n=this;;){for(let{children:o,positions:l}=n._tree,h=t>0?o.length:-1;e!=h;e+=t){let h=o[e],u=l[e]+n.from;if(m(s,i,u,u+h.length))if(h instanceof g){if(r&d.ExcludeBuffers)continue;let a=h.findChild(0,h.buffer.length,t,i-u,s);if(a>-1)return new $(new k(n,h,e,u),null,a)}else if(r&d.IncludeAnonymous||!h.type.isAnonymous||_(h)){let o;if(!(r&d.IgnoreMounts)&&h.props&&(o=h.prop(a.mounted))&&!o.overlay)return new v(o.tree,u,e,n);let l=new v(h,u,e,n);return r&d.IncludeAnonymous||!l.type.isAnonymous?l:l.nextChild(t<0?h.children.length-1:0,t,i,s)}}if(r&d.IncludeAnonymous||!n.type.isAnonymous)return null;if(e=n.index>=0?n.index+t:t<0?-1:n._parent._tree.children.length,n=n._parent,!n)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,i=0){let s;if(!(i&d.IgnoreOverlays)&&(s=this._tree.prop(a.mounted))&&s.overlay){let i=e-this.from;for(let{from:e,to:r}of s.overlay)if((t>0?e<=i:e<i)&&(t<0?r>=i:r>i))return new v(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new w(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,t=0){return O(this,e,t,!1)}resolveInner(e,t=0){return O(this,e,t,!0)}enterUnfinishedNodesBefore(e){return y(this,e)}getChild(e,t=null,i=null){let s=x(this,e,t,i);return s.length?s[0]:null}getChildren(e,t=null,i=null){return x(this,e,t,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return b(this,e)}}function x(e,t,i,s){let r=e.cursor(),n=[];if(!r.firstChild())return n;if(null!=i)for(;!r.type.is(i);)if(!r.nextSibling())return n;for(;;){if(null!=s&&r.type.is(s))return n;if(r.type.is(t)&&n.push(r.node),!r.nextSibling())return null==s?n:[]}}function b(e,t,i=t.length-1){for(let s=e.parent;i>=0;s=s.parent){if(!s)return!1;if(!s.type.isAnonymous){if(t[i]&&t[i]!=s.name)return!1;i--}}return!0}class k{constructor(e,t,i,s){this.parent=e,this.buffer=t,this.index=i,this.start=s}}class ${constructor(e,t,i){this.context=e,this._parent=t,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(e,t,i){let{buffer:s}=this.context,r=s.findChild(this.index+4,s.buffer[this.index+3],e,t-this.context.start,i);return r<0?null:new $(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,i=0){if(i&d.ExcludeBuffers)return null;let{buffer:s}=this.context,r=s.findChild(this.index+4,s.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return r<0?null:new $(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new $(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new $(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}cursor(e=0){return new w(this,e)}get tree(){return null}toTree(){let e=[],t=[],{buffer:i}=this.context,s=this.index+4,r=i.buffer[this.index+3];if(r>s){let n=i.buffer[this.index+1],a=i.buffer[this.index+2];e.push(i.slice(s,r,n,a)),t.push(0)}return new p(this.type,e,t,this.to-this.from)}resolve(e,t=0){return O(this,e,t,!1)}resolveInner(e,t=0){return O(this,e,t,!0)}enterUnfinishedNodesBefore(e){return y(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,t=null,i=null){let s=x(this,e,t,i);return s.length?s[0]:null}getChildren(e,t=null,i=null){return x(this,e,t,i)}get node(){return this}matchContext(e){return b(this,e)}}class w{constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof v)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let t=e._parent;t;t=t._parent)this.stack.unshift(t.index);this.bufferNode=e,this.yieldBuf(e.index)}}get name(){return this.type.name}yieldNode(e){return!!e&&(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0)}yieldBuf(e,t){this.index=e;let{start:i,buffer:s}=this.buffer;return this.type=t||s.set.types[s.buffer[e]],this.from=i+s.buffer[e+1],this.to=i+s.buffer[e+2],!0}yield(e){return!!e&&(e instanceof v?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,i,this.mode));let{buffer:s}=this.buffer,r=s.findChild(this.index+4,s.buffer[this.index+3],e,t-this.buffer.start,i);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,i=this.mode){return this.buffer?!(i&d.ExcludeBuffers)&&this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&d.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&d.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));let{buffer:t}=this.buffer,i=this.stack.length-1;if(e<0){let e=i<0?0:this.stack[i]+4;if(this.index!=e)return this.yieldBuf(t.findChild(e,this.index,-1,0,4))}else{let e=t.buffer[this.index+3];if(e<(i<0?t.buffer.length:t.buffer[this.stack[i]+3]))return this.yieldBuf(e)}return i<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,i,{buffer:s}=this;if(s){if(e>0){if(this.index<s.buffer.buffer.length)return!1}else for(let e=0;e<this.index;e++)if(s.buffer.buffer[e+3]<this.index)return!1;({index:t,parent:i}=s)}else({index:t,_parent:i}=this._tree);for(;i;({index:t,_parent:i}=i))if(t>-1)for(let s=t+e,r=e<0?-1:i._tree.children.length;s!=r;s+=e){let e=i._tree.children[s];if(this.mode&d.IncludeAnonymous||e instanceof g||!e.type.isAnonymous||_(e))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,i=0;if(e&&e.context==this.buffer)e:for(let s=this.index,r=this.stack.length;r>=0;){for(let n=e;n;n=n._parent)if(n.index==s){if(s==this.index)return n;t=n,i=r+1;break e}s=this.stack[--r]}for(let e=i;e<this.stack.length;e++)t=new $(this.buffer,t,this.stack[e]);return this.bufferNode=new $(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let i=0;;){let s=!1;if(this.type.isAnonymous||!1!==e(this)){if(this.firstChild()){i++;continue}this.type.isAnonymous||(s=!0)}for(;s&&t&&t(this),s=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,s=!0}}}matchContext(e){if(!this.buffer)return b(this.node,e);let{buffer:t}=this.buffer,{types:i}=t.set;for(let s=e.length-1,r=this.stack.length-1;s>=0;r--){if(r<0)return b(this.node,e,s);let n=i[t.buffer[this.stack[r]]];if(!n.isAnonymous){if(e[s]&&e[s]!=n.name)return!1;s--}}return!0}}function _(e){return e.children.some((e=>e instanceof g||!e.type.isAnonymous||_(e)))}const P=new WeakMap;function S(e,t){if(!e.isAnonymous||t instanceof g||t.type!=e)return 1;let i=P.get(t);if(null==i){i=1;for(let s of t.children){if(s.type!=e||!(s instanceof p)){i=1;break}i+=S(e,s)}P.set(t,i)}return i}function C(e,t,i,s,r,n,a,o,l){let h=0;for(let i=s;i<r;i++)h+=S(e,t[i]);let u=Math.ceil(1.5*h/8),c=[],d=[];return function t(i,s,r,a,o){for(let h=r;h<a;){let r=h,p=s[h],f=S(e,i[h]);for(h++;h<a;h++){let t=S(e,i[h]);if(f+t>=u)break;f+=t}if(h==r+1){if(f>u){let e=i[r];t(e.children,e.positions,0,e.children.length,s[r]+o);continue}c.push(i[r])}else{let t=s[h-1]+i[h-1].length-p;c.push(C(e,i,s,r,h,p,t,null,l))}d.push(p+o-n)}}(t,i,s,r,0),(o||l)(c,d,a)}class Q{startParse(e,t,i){return"string"==typeof e&&(e=new T(e)),i=i?i.length?i.map((e=>new n(e.from,e.to))):[new n(0,0)]:[new n(0,e.length)],this.createParse(e,t||[],i)}parse(e,t,i){let s=this.startParse(e,t,i);for(;;){let e=s.advance();if(e)return e}}}class T{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new a({perNode:!0})},26048:(e,t,i)=>{"use strict";i.d(t,{WQ:()=>w});var s,r=i(36179);class n{constructor(e,t,i,s,r,n,a,o,l,h=0,u){this.p=e,this.stack=t,this.state=i,this.reducePos=s,this.pos=r,this.score=n,this.buffer=a,this.bufferBase=o,this.curContext=l,this.lookAhead=h,this.parent=u}toString(){return`[${this.stack.filter(((e,t)=>t%3==0)).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,i=0){let s=e.parser.context;return new n(e,[],t,i,i,0,[],0,s?new a(s,s.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){let t=e>>19,i=65535&e,{parser:s}=this.p,r=s.dynamicPrecedence(i);if(r&&(this.score+=r),0==t)return this.pushState(s.getGoto(this.state,i,!0),this.reducePos),i<s.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,4,!0),void this.reduceContext(i,this.reducePos);let n=this.stack.length-3*(t-1)-(262144&e?6:0),a=this.stack[n-2],o=this.stack[n-1],l=this.bufferBase+this.buffer.length-o;if(i<s.minRepeatTerm||131072&e){let e=s.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,a,e,l+4,!0)}if(262144&e)this.state=this.stack[n];else{let e=this.stack[n-3];this.state=s.getGoto(e,i,!0)}for(;this.stack.length>n;)this.stack.pop();this.reduceContext(i,a)}storeNode(e,t,i,s=4,r=!1){if(0==e&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let e=this,s=this.buffer.length;if(0==s&&e.parent&&(s=e.bufferBase-e.parent.bufferBase,e=e.parent),s>0&&0==e.buffer[s-4]&&e.buffer[s-1]>-1){if(t==i)return;if(e.buffer[s-2]>=t)return void(e.buffer[s-2]=i)}}if(r&&this.pos!=i){let r=this.buffer.length;if(r>0&&0!=this.buffer[r-4])for(;r>0&&this.buffer[r-2]>i;)this.buffer[r]=this.buffer[r-4],this.buffer[r+1]=this.buffer[r-3],this.buffer[r+2]=this.buffer[r-2],this.buffer[r+3]=this.buffer[r-1],r-=4,s>4&&(s-=4);this.buffer[r]=e,this.buffer[r+1]=t,this.buffer[r+2]=i,this.buffer[r+3]=s}else this.buffer.push(e,t,i,s)}shift(e,t,i){let s=this.pos;if(131072&e)this.pushState(65535&e,this.pos);else if(0==(262144&e)){let r=e,{parser:n}=this.p;(i>this.pos||t<=n.maxNode)&&(this.pos=i,n.stateFlag(r,1)||(this.reducePos=i)),this.pushState(r,s),this.shiftContext(t,s),t<=n.maxNode&&this.buffer.push(t,s,i,4)}else this.pos=i,this.shiftContext(t,s),t<=this.p.parser.maxNode&&this.buffer.push(t,s,i,4)}apply(e,t,i){65536&e?this.reduce(e):this.shift(e,t,i)}useNode(e,t){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=e)&&(this.p.reused.push(e),i++);let s=this.pos;this.reducePos=this.pos=s+e.length,this.pushState(t,s),this.buffer.push(i,s,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let i=e.buffer.slice(t),s=e.bufferBase+t;for(;e&&s==e.bufferBase;)e=e.parent;return new n(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,s,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let i=e<=this.p.parser.maxNode;i&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,i?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new o(this);;){let i=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(0==(65536&i))return!0;if(0==i)return!1;t.reduce(i)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let i=[];for(let s,r=0;r<t.length;r+=2)(s=t[r+1])!=this.state&&this.p.parser.hasAction(s,e)&&i.push(t[r],s);if(this.stack.length<120)for(let e=0;i.length<8&&e<t.length;e+=2){let s=t[e+1];i.some(((e,t)=>1&t&&e==s))||i.push(t[e],s)}t=i}let i=[];for(let e=0;e<t.length&&i.length<4;e+=2){let s=t[e+1];if(s==this.state)continue;let r=this.split();r.pushState(s,this.pos),r.storeNode(0,r.pos,r.pos,4,!0),r.shiftContext(t[e],this.pos),r.score-=200,i.push(r)}return i}forceReduce(){let e=this.p.parser.stateSlot(this.state,5);if(0==(65536&e))return!1;let{parser:t}=this.p;if(!t.validAction(this.state,e)){let i=e>>19,s=65535&e,r=this.stack.length-3*i;if(r<0||t.getGoto(this.stack[r],s,!1)<0)return!1;this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:e}=this.p;return 65535==e.data[e.stateSlot(this.state,1)]&&!e.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||-3!=this.buffer[e])&&this.buffer.push(this.curContext.hash,this.reducePos,this.reducePos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||-4!=this.buffer[e])&&this.buffer.push(this.lookAhead,this.reducePos,this.reducePos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new a(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class a{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}!function(e){e[e.Insert=200]="Insert",e[e.Delete=190]="Delete",e[e.Reduce=100]="Reduce",e[e.MaxNext=4]="MaxNext",e[e.MaxInsertStackDepth=300]="MaxInsertStackDepth",e[e.DampenInsertStackDepth=120]="DampenInsertStackDepth"}(s||(s={}));class o{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=65535&e,i=e>>19;0==i?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(i-1);let s=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=s}}class l{constructor(e,t,i){this.stack=e,this.pos=t,this.index=i,this.buffer=e.buffer,0==this.index&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new l(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;null!=e&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new l(this.stack,this.pos,this.index)}}class h{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const u=new h;class c{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=u,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let i=this.range,s=this.rangeIndex,r=this.pos+e;for(;r<i.from;){if(!s)return null;let e=this.ranges[--s];r-=i.from-e.to,i=e}for(;t<0?r>i.to:r>=i.to;){if(s==this.ranges.length-1)return null;let e=this.ranges[++s];r+=e.from-i.to,i=e}return r}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t,i,s=this.chunkOff+e;if(s>=0&&s<this.chunk.length)t=this.pos+e,i=this.chunk.charCodeAt(s);else{let s=this.resolveOffset(e,1);if(null==s)return-1;if(t=s,t>=this.chunk2Pos&&t<this.chunk2Pos+this.chunk2.length)i=this.chunk2.charCodeAt(t-this.chunk2Pos);else{let e=this.rangeIndex,s=this.range;for(;s.to<=t;)s=this.ranges[++e];this.chunk2=this.input.chunk(this.chunk2Pos=t),t+this.chunk2.length>s.to&&(this.chunk2=this.chunk2.slice(0,s.to-t)),i=this.chunk2.charCodeAt(0)}}return t>=this.token.lookAhead&&(this.token.lookAhead=t+1),i}acceptToken(e,t=0){let i=t?this.resolveOffset(t,-1):this.pos;if(null==i||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=i}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=u,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let i="";for(let s of this.ranges){if(s.from>=t)break;s.to>e&&(i+=this.input.read(Math.max(s.from,e),Math.min(s.to,t)))}return i}}class d{constructor(e,t){this.data=e,this.id=t}token(e,t){!function(e,t,i,s){let r=0,n=1<<s,{parser:a}=i.p,{dialect:o}=a;e:for(;0!=(n&e[r]);){let i=e[r+1];for(let s=r+3;s<i;s+=2)if((e[s+1]&n)>0){let i=e[s];if(o.allows(i)&&(-1==t.token.value||t.token.value==i||a.overrides(i,t.token.value))){t.acceptToken(i);break}}let s=t.next,l=0,h=e[r+2];if(!(t.next<0&&h>l&&65535==e[i+3*h-3])){for(;l<h;){let n=l+h>>1,a=i+n+(n<<1),o=e[a],u=e[a+1];if(s<o)h=n;else{if(!(s>=u)){r=e[a+2],t.advance();continue e}l=n+1}}break}r=e[i+3*h-1]}}(this.data,e,t,this.id)}}d.prototype.contextual=d.prototype.fallback=d.prototype.extend=!1;function p(e,t=Uint16Array){if("string"!=typeof e)return e;let i=null;for(let s=0,r=0;s<e.length;){let n=0;for(;;){let t=e.charCodeAt(s++),i=!1;if(126==t){n=65535;break}t>=92&&t--,t>=34&&t--;let r=t-32;if(r>=46&&(r-=46,i=!0),n+=r,i)break;n*=46}i?i[r++]=n:i=new t(n)}return i}const f="undefined"!=typeof process&&process.env&&/\bparse\b/.test(process.env.LOG);let g=null;var m,y;function O(e,t,i){let s=e.cursor(r.vj.IncludeAnonymous);for(s.moveTo(t);;)if(!(i<0?s.childBefore(t):s.childAfter(t)))for(;;){if((i<0?s.to<t:s.from>t)&&!s.type.isError)return i<0?Math.max(0,Math.min(s.to-1,t-25)):Math.min(e.length,Math.max(s.from+1,t+25));if(i<0?s.prevSibling():s.nextSibling())break;if(!s.parent())return i<0?0:e.length}}!function(e){e[e.Margin=25]="Margin"}(m||(m={}));class v{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?O(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?O(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let i=this.trees[t],s=this.index[t];if(s==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let n=i.children[s],a=this.start[t]+i.positions[s];if(a>e)return this.nextStart=a,null;if(n instanceof r.mp){if(a==e){if(a<this.safeFrom)return null;let e=a+n.length;if(e<=this.safeTo){let t=n.prop(r.md.lookAhead);if(!t||e+t<this.fragment.to)return n}}this.index[t]++,a+n.length>=Math.max(this.safeFrom,e)&&(this.trees.push(n),this.start.push(a),this.index.push(0))}else this.index[t]++,this.nextStart=a+n.length}}}class x{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map((e=>new h))}getActions(e){let t=0,i=null,{parser:s}=e.p,{tokenizers:r}=s,n=s.stateSlot(e.state,3),a=e.curContext?e.curContext.hash:0,o=0;for(let s=0;s<r.length;s++){if(0==(1<<s&n))continue;let l=r[s],h=this.tokens[s];if((!i||l.fallback)&&((l.contextual||h.start!=e.pos||h.mask!=n||h.context!=a)&&(this.updateCachedToken(h,l,e),h.mask=n,h.context=a),h.lookAhead>h.end+25&&(o=Math.max(h.lookAhead,o)),0!=h.value)){let s=t;if(h.extended>-1&&(t=this.addActions(e,h.extended,h.end,t)),t=this.addActions(e,h.value,h.end,t),!l.extend&&(i=h,t>s))break}}for(;this.actions.length>t;)this.actions.pop();return o&&e.setLookAhead(o),i||e.pos!=this.stream.end||(i=new h,i.value=e.p.parser.eofTerm,i.start=i.end=e.pos,t=this.addActions(e,i.value,i.end,t)),this.mainToken=i,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new h,{pos:i,p:s}=e;return t.start=i,t.end=Math.min(i+1,s.stream.end),t.value=i==s.stream.end?s.parser.eofTerm:0,t}updateCachedToken(e,t,i){let s=this.stream.clipPos(i.pos);if(t.token(this.stream.reset(s,e),i),e.value>-1){let{parser:t}=i.p;for(let s=0;s<t.specialized.length;s++)if(t.specialized[s]==e.value){let r=t.specializers[s](this.stream.read(e.start,e.end),i);if(r>=0&&i.p.parser.dialect.allows(r>>1)){0==(1&r)?e.value=r>>1:e.extended=r>>1;break}}}else e.value=0,e.end=this.stream.clipPos(s+1)}putAction(e,t,i,s){for(let t=0;t<s;t+=3)if(this.actions[t]==e)return s;return this.actions[s++]=e,this.actions[s++]=t,this.actions[s++]=i,s}addActions(e,t,i,s){let{state:r}=e,{parser:n}=e.p,{data:a}=n;for(let e=0;e<2;e++)for(let o=n.stateSlot(r,e?2:1);;o+=3){if(65535==a[o]){if(1!=a[o+1]){0==s&&2==a[o+1]&&(s=this.putAction(_(a,o+2),t,i,s));break}o=_(a,o+2)}a[o]==t&&(s=this.putAction(_(a,o+1),t,i,s))}return s}}!function(e){e[e.Distance=5]="Distance",e[e.MaxRemainingPerStep=3]="MaxRemainingPerStep",e[e.MinBufferLengthPrune=500]="MinBufferLengthPrune",e[e.ForceReduceLimit=10]="ForceReduceLimit",e[e.CutDepth=15e3]="CutDepth",e[e.CutTo=9e3]="CutTo"}(y||(y={}));class b{constructor(e,t,i,s){this.parser=e,this.input=t,this.ranges=s,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.stream=new c(t,s),this.tokens=new x(e,this.stream),this.topTerm=e.top[1];let{from:r}=s[0];this.stacks=[n.start(this,e.top[0],r)],this.fragments=i.length&&this.stream.end-r>4*e.bufferLength?new v(i,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e,t,i=this.stacks,s=this.minStackPos,r=this.stacks=[];for(let n=0;n<i.length;n++){let a=i[n];for(;;){if(this.tokens.mainToken=null,a.pos>s)r.push(a);else{if(this.advanceStack(a,r,i))continue;{e||(e=[],t=[]),e.push(a);let i=this.tokens.getMainToken(a);t.push(i.value,i.end)}}break}}if(!r.length){let t=e&&function(e){let t=null;for(let i of e){let e=i.p.stoppedAt;(i.pos==i.p.stream.end||null!=e&&i.pos>e)&&i.p.parser.stateFlag(i.state,2)&&(!t||t.score<i.score)&&(t=i)}return t}(e);if(t)return this.stackToTree(t);if(this.parser.strict)throw f&&e&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+s);this.recovering||(this.recovering=5)}if(this.recovering&&e){let i=null!=this.stoppedAt&&e[0].pos>this.stoppedAt?e[0]:this.runRecovery(e,t,r);if(i)return this.stackToTree(i.forceAll())}if(this.recovering){let e=1==this.recovering?1:3*this.recovering;if(r.length>e)for(r.sort(((e,t)=>t.score-e.score));r.length>e;)r.pop();r.some((e=>e.reducePos>s))&&this.recovering--}else if(r.length>1)e:for(let e=0;e<r.length-1;e++){let t=r[e];for(let i=e+1;i<r.length;i++){let s=r[i];if(t.sameState(s)||t.buffer.length>500&&s.buffer.length>500){if(!((t.score-s.score||t.buffer.length-s.buffer.length)>0)){r.splice(e--,1);continue e}r.splice(i--,1)}}}this.minStackPos=r[0].pos;for(let e=1;e<r.length;e++)r[e].pos<this.minStackPos&&(this.minStackPos=r[e].pos);return null}stopAt(e){if(null!=this.stoppedAt&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,i){let s=e.pos,{parser:n}=this,a=f?this.stackID(e)+" -> ":"";if(null!=this.stoppedAt&&s>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let t=e.curContext&&e.curContext.tracker.strict,i=t?e.curContext.hash:0;for(let o=this.fragments.nodeAt(s);o;){let s=this.parser.nodeSet.types[o.type.id]==o.type?n.getGoto(e.state,o.type.id):-1;if(s>-1&&o.length&&(!t||(o.prop(r.md.contextHash)||0)==i))return e.useNode(o,s),f&&console.log(a+this.stackID(e)+` (via reuse of ${n.getName(o.type.id)})`),!0;if(!(o instanceof r.mp)||0==o.children.length||o.positions[0]>0)break;let l=o.children[0];if(!(l instanceof r.mp&&0==o.positions[0]))break;o=l}}let o=n.stateSlot(e.state,4);if(o>0)return e.reduce(o),f&&console.log(a+this.stackID(e)+` (via always-reduce ${n.getName(65535&o)})`),!0;if(e.stack.length>=15e3)for(;e.stack.length>9e3&&e.forceReduce(););let l=this.tokens.getActions(e);for(let r=0;r<l.length;){let o=l[r++],h=l[r++],u=l[r++],c=r==l.length||!i,d=c?e:e.split();if(d.apply(o,h,u),f&&console.log(a+this.stackID(d)+` (via ${0==(65536&o)?"shift":`reduce of ${n.getName(65535&o)}`} for ${n.getName(h)} @ ${s}${d==e?"":", split"})`),c)return!0;d.pos>s?t.push(d):i.push(d)}return!1}advanceFully(e,t){let i=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>i)return k(e,t),!0}}runRecovery(e,t,i){let s=null,r=!1;for(let n=0;n<e.length;n++){let a=e[n],o=t[n<<1],l=t[1+(n<<1)],h=f?this.stackID(a)+" -> ":"";if(a.deadEnd){if(r)continue;if(r=!0,a.restart(),f&&console.log(h+this.stackID(a)+" (restarted)"),this.advanceFully(a,i))continue}let u=a.split(),c=h;for(let e=0;u.forceReduce()&&e<10;e++){if(f&&console.log(c+this.stackID(u)+" (via force-reduce)"),this.advanceFully(u,i))break;f&&(c=this.stackID(u)+" -> ")}for(let e of a.recoverByInsert(o))f&&console.log(h+this.stackID(e)+" (via recover-insert)"),this.advanceFully(e,i);this.stream.end>a.pos?(l==a.pos&&(l++,o=0),a.recoverByDelete(o,l),f&&console.log(h+this.stackID(a)+` (via recover-delete ${this.parser.getName(o)})`),k(a,i)):(!s||s.score<a.score)&&(s=a)}return s}stackToTree(e){return e.close(),r.mp.build({buffer:l.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(g||(g=new WeakMap)).get(e);return t||g.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function k(e,t){for(let i=0;i<t.length;i++){let s=t[i];if(s.pos==e.pos&&s.sameState(e))return void(t[i].score<e.score&&(t[i]=e))}t.push(e)}class ${constructor(e,t,i){this.source=e,this.flags=t,this.disabled=i}allows(e){return!this.disabled||0==this.disabled[e]}}class w extends r._b{constructor(e){if(super(),this.wrappers=[],14!=e.version)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let i=0;i<e.repeatNodeCount;i++)t.push("");let i=Object.keys(e.topRules).map((t=>e.topRules[t][1])),s=[];for(let e=0;e<t.length;e++)s.push([]);function n(e,t,i){s[e].push([t,t.deserialize(String(i))])}if(e.nodeProps)for(let t of e.nodeProps){let e=t[0];"string"==typeof e&&(e=r.md[e]);for(let i=1;i<t.length;){let s=t[i++];if(s>=0)n(s,e,t[i++]);else{let r=t[i+-s];for(let a=-s;a>0;a--)n(t[i++],e,r);i++}}}this.nodeSet=new r.Lj(t.map(((t,n)=>r.Jq.define({name:n>=this.minRepeatTerm?void 0:t,id:n,props:s[n],top:i.indexOf(n)>-1,error:0==n,skipped:e.skippedNodes&&e.skippedNodes.indexOf(n)>-1})))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=r.L3;let a=p(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let e=0;e<this.specializerSpecs.length;e++)this.specialized[e]=this.specializerSpecs[e].term;this.specializers=this.specializerSpecs.map(S),this.states=p(e.states,Uint32Array),this.data=p(e.stateData),this.goto=p(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map((e=>"number"==typeof e?new d(a,e):e)),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,i){let s=new b(this,e,t,i);for(let r of this.wrappers)s=r(s,e,t,i);return s}getGoto(e,t,i=!1){let s=this.goto;if(t>=s[0])return-1;for(let r=s[t+1];;){let t=s[r++],n=1&t,a=s[r++];if(n&&i)return a;for(let i=r+(t>>1);r<i;r++)if(s[r]==e)return a;if(n)return-1}}hasAction(e,t){let i=this.data;for(let s=0;s<2;s++)for(let r,n=this.stateSlot(e,s?2:1);;n+=3){if(65535==(r=i[n])){if(1!=i[n+1]){if(2==i[n+1])return _(i,n+2);break}r=i[n=_(i,n+2)]}if(r==t||0==r)return _(i,n+1)}return 0}stateSlot(e,t){return this.states[6*e+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){if(t==this.stateSlot(e,4))return!0;for(let i=this.stateSlot(e,1);;i+=3){if(65535==this.data[i]){if(1!=this.data[i+1])return!1;i=_(this.data,i+2)}if(t==_(this.data,i+1))return!0}}nextStates(e){let t=[];for(let i=this.stateSlot(e,1);;i+=3){if(65535==this.data[i]){if(1!=this.data[i+1])break;i=_(this.data,i+2)}if(0==(1&this.data[i+2])){let e=this.data[i+1];t.some(((t,i)=>1&i&&t==e))||t.push(this.data[i],e)}}return t}overrides(e,t){let i=P(this.data,this.tokenPrecTable,t);return i<0||P(this.data,this.tokenPrecTable,e)<i}configure(e){let t=Object.assign(Object.create(w.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let i=this.topRules[e.top];if(!i)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=i}return e.tokenizers&&(t.tokenizers=this.tokenizers.map((t=>{let i=e.tokenizers.find((e=>e.from==t));return i?i.to:t}))),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map(((i,s)=>{let r=e.specializers.find((e=>e.from==i.external));if(!r)return i;let n=Object.assign(Object.assign({},i),{external:r.to});return t.specializers[s]=S(n),n}))),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),null!=e.strict&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),null!=e.bufferLength&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return null==t?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),i=t.map((()=>!1));if(e)for(let s of e.split(" ")){let e=t.indexOf(s);e>=0&&(i[e]=!0)}let s=null;for(let e=0;e<t.length;e++)if(!i[e])for(let i,r=this.dialects[t[e]];65535!=(i=this.data[r++]);)(s||(s=new Uint8Array(this.maxTerm+1)))[i]=1;return new $(e,i,s)}static deserialize(e){return new w(e)}}function _(e,t){return e[t]|e[t+1]<<16}function P(e,t,i){for(let s,r=t;65535!=(s=e[r]);r++)if(s==i)return r-t;return-1}function S(e){if(e.external){let t=e.extend?1:0;return(i,s)=>e.external(i,s)<<1|t}return e.get}}}]);
//# sourceMappingURL=5334.4f3a2f89923436c50ec0.js.map